"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/analyze";
exports.ids = ["pages/api/analyze"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = import("axios");;

/***/ }),

/***/ "cheerio":
/*!**************************!*\
  !*** external "cheerio" ***!
  \**************************/
/***/ ((module) => {

module.exports = import("cheerio");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fanalyze&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fanalyze.ts&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fanalyze&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fanalyze.ts&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_analyze_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/analyze.ts */ \"(api)/./pages/api/analyze.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_analyze_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_analyze_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_analyze_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_analyze_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/analyze\",\n        pathname: \"/api/analyze\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_analyze_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmFuYWx5emUmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyUyRmFwaSUyRmFuYWx5emUudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDbUQ7QUFDbkQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLGtEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxrREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQscUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9lZG0tYnVpbGRlci8/YzRkNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL2FuYWx5emUudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hbmFseXplXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYW5hbHl6ZVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fanalyze&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fanalyze.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/parser.ts":
/*!***********************!*\
  !*** ./lib/parser.ts ***!
  \***********************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseProduct: () => (/* binding */ parseProduct)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var cheerio__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! cheerio */ \"cheerio\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([axios__WEBPACK_IMPORTED_MODULE_0__, cheerio__WEBPACK_IMPORTED_MODULE_1__]);\n([axios__WEBPACK_IMPORTED_MODULE_0__, cheerio__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n/**\n * Shape of the information we care about from a product page.\n *\n * These fields mirror the placeholders used in templates. Some\n * fields are optional because not every page will expose them.\n */ // ProductData type moved to lib/types.ts\n/**\n * Attempt to parse structured JSON-LD data from the page. Many\n * e‑commerce platforms embed an object with the schema.org\n * Product type. This helper extracts it if present.\n */ function parseLdJson($) {\n    const scripts = $('script[type=\"application/ld+json\"]').toArray();\n    for (const el of scripts){\n        const contents = $(el).contents().text();\n        if (!contents) continue;\n        try {\n            const json = JSON.parse(contents.trim());\n            // Sometimes multiple objects are wrapped in an array.\n            const candidates = Array.isArray(json) ? json : [\n                json\n            ];\n            for (const obj of candidates){\n                if (obj[\"@type\"] === \"Product\") {\n                    return obj;\n                }\n            }\n        } catch (_) {\n        // ignore JSON parse errors and continue.\n        }\n    }\n    return null;\n}\n/**\n * Generic helper to extract a meta tag value. It first tries to\n * match the given property on the `meta[property]` attribute (as used\n * by Open Graph), then falls back to `meta[name]`.\n */ function getMeta($, prop) {\n    return $(`meta[property='${prop}']`).attr(\"content\") || $(`meta[name='${prop}']`).attr(\"content\") || null;\n}\n/**\n * Fetch a product page and extract basic fields using heuristics. This\n * function does not attempt to deeply crawl the DOM; instead it relies\n * on Open Graph tags, JSON‑LD and common microdata attributes. If a\n * field cannot be resolved it will be returned as an empty string.\n *\n * If the request fails for whatever reason the resulting object will\n * contain empty strings for all properties except url and cta.\n *\n * @param url Product page URL\n */ async function parseProduct(url) {\n    const clean = (value)=>(value || \"\").toString().trim();\n    let html = \"\";\n    try {\n        const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(url, {\n            headers: {\n                // Set a user agent so that some sites don’t block our request.\n                \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0 Safari/537.36\"\n            },\n            // Follow redirects automatically.\n            maxRedirects: 3\n        });\n        html = response.data;\n    } catch (error) {\n        console.error(`Failed to fetch ${url}:`, error instanceof Error ? error.message : error);\n        return {\n            url,\n            pretitle: \"\",\n            title: \"\",\n            price: \"\",\n            description: \"\",\n            image: \"\",\n            images: undefined,\n            cta: url,\n            ctaLabel: \"SHOP NOW\"\n        };\n    }\n    const $ = cheerio__WEBPACK_IMPORTED_MODULE_1__.load(html);\n    // Attempt to parse JSON‑LD structured data first because it typically\n    // provides the richest information. We fall back to meta tags if\n    // structured data is not present or incomplete.\n    const ld = parseLdJson($) || {};\n    const product = {\n        url,\n        pretitle: \"\",\n        title: \"\",\n        price: \"\",\n        originalPrice: undefined,\n        description: \"\",\n        image: \"\",\n        images: undefined,\n        cta: url,\n        // Default call-to-action label. Users can override this in the\n        // preview by editing the CTA text. If not provided, templates\n        // will fall back to this value.\n        ctaLabel: \"SHOP NOW\"\n    };\n    // Title\n    product.title = clean(ld.name) || clean(getMeta($, \"og:title\")) || clean(getMeta($, \"twitter:title\")) || clean($(\"title\").first().text());\n    // Description\n    product.description = clean(ld.description) || clean(getMeta($, \"og:description\")) || clean(getMeta($, \"twitter:description\")) || clean(getMeta($, \"description\"));\n    // Extract specific description sources from .product__description\n    try {\n        const descRoot = $(\".product__description\").first();\n        if (descRoot && descRoot.length) {\n            const p = descRoot.find(\"p\").first();\n            if (p && p.length) {\n                product.descriptionP = clean(p.text());\n            }\n            const ul = descRoot.find(\"ul\").first();\n            if (ul && ul.length) {\n                // Preserve UL structure as HTML for email preview/template\n                product.descriptionUl = $.html(ul);\n            }\n        }\n    } catch (e) {\n    // ignore extraction errors\n    }\n    // Image\n    const ldImage = Array.isArray(ld.image) ? ld.image[0] : typeof ld.image === \"string\" ? ld.image : undefined;\n    product.image = clean(ldImage) || clean(getMeta($, \"og:image\")) || clean(getMeta($, \"twitter:image\")) || clean($(\"img\").first().attr(\"src\"));\n    // Price\n    const ldOffers = ld.offers;\n    let ldPrice;\n    if (ldOffers) {\n        if (Array.isArray(ldOffers)) {\n            ldPrice = ldOffers[0]?.price;\n        } else if (typeof ldOffers === \"object\") {\n            ldPrice = ldOffers.price;\n        }\n    }\n    product.price = clean(ldPrice) || clean(getMeta($, \"product:price:amount\")) || clean(getMeta($, \"og:price:amount\")) || // Try to match microdata on sites like Shopify: [itemprop=\"price\"]\n    clean($('[itemprop=\"price\"]').first().text());\n    // Original price: attempt to find a compare‑at or strike‑through price. This\n    // can appear in JSON‑LD as an \"priceSpecification\" with\n    // \"priceCurrency\" and \"value\", or in the DOM as <del> or a span with\n    // class containing \"compare\" or \"strike\". We attempt several heuristics\n    // and take the first numeric value we find. The value returned does\n    // not include the currency symbol.\n    let original;\n    // Check JSON‑LD offers.comparePrice if present\n    if (ldOffers) {\n        // Some schemas nest compareAtPrice or originalPrice\n        const getCompare = (obj)=>{\n            if (!obj) return undefined;\n            return obj.compareAtPrice || obj.originalPrice || obj.priceSpecification?.price;\n        };\n        if (Array.isArray(ldOffers)) {\n            for (const off of ldOffers){\n                const val = getCompare(off);\n                if (val) {\n                    original = clean(val);\n                    break;\n                }\n            }\n        } else if (typeof ldOffers === \"object\") {\n            const val = getCompare(ldOffers);\n            if (val) {\n                original = clean(val);\n            }\n        }\n    }\n    if (!original) {\n        // Look for elements containing a price with a line‑through style or a\n        // class indicating \"compare\" or \"original\". We extract numeric\n        // values (digits and decimal separators).\n        const priceRegex = /([\\d,.]+)\\s*(?:[A-Z]{3})?/;\n        // helper to parse text\n        const parsePriceText = (text)=>{\n            const match = priceRegex.exec(text);\n            return match ? match[1] : undefined;\n        };\n        // Check <del> elements\n        $(\"del, strike\").each((_, el)=>{\n            const text = $(el).text();\n            const val = parsePriceText(text);\n            if (val) {\n                original = clean(val);\n                return false; // break the loop\n            }\n        });\n        // Check elements with class containing compare or original\n        if (!original) {\n            $('[class*=\"compare\"],[class*=\"original\"],[class*=\"strike\"]').each((_, el)=>{\n                const text = $(el).text();\n                const val = parsePriceText(text);\n                if (val) {\n                    original = clean(val);\n                    return false;\n                }\n            });\n        }\n    }\n    // Assign originalPrice if found and different from sale price\n    if (original && original !== product.price) {\n        product.originalPrice = original;\n    }\n    // Pretitle: not widely available. As a heuristic, if the title\n    // contains a hyphen, split the first part as pretitle and the rest\n    // as the actual title.\n    if (product.title && product.title.includes(\" – \")) {\n        const parts = product.title.split(/\\s+–\\s+/);\n        if (parts.length > 1) {\n            product.pretitle = parts[0];\n            product.title = parts.slice(1).join(\" – \");\n        }\n    }\n    // Colour capture removed per refactor; no swatch detection\n    // Images: collect additional image URLs beyond the primary image. We\n    // start with the primary image if it exists. Then search for image\n    // elements that are likely part of the product gallery. Heuristics\n    // include class names containing \"product\", \"gallery\", \"thumb\", or\n    // \"image\". We also accept JSON‑LD image arrays. Only absolute\n    // URLs (http or https) are kept and duplicates removed.\n    const imageSet = new Set();\n    if (product.image) {\n        imageSet.add(product.image);\n    }\n    // Add any additional images from JSON‑LD\n    if (Array.isArray(ld.image)) {\n        for (const img of ld.image){\n            if (typeof img === \"string\" && /^https?:\\/\\//i.test(img)) {\n                imageSet.add(img);\n            }\n        }\n    }\n    // DOM extraction: find images with relevant class hints\n    $(\"img\").each((_, el)=>{\n        const src = clean($(el).attr(\"src\"));\n        if (!src) return;\n        // Only accept absolute URLs\n        if (!/^https?:\\/\\//i.test(src)) return;\n        // Accept images if they contain certain keywords in their class or id\n        const classes = ($(el).attr(\"class\") || \"\") + \" \" + ($(el).parent().attr(\"class\") || \"\");\n        const ids = ($(el).attr(\"id\") || \"\") + \" \" + ($(el).parent().attr(\"id\") || \"\");\n        const hay = classes + \" \" + ids;\n        if (/product|gallery|thumb|image|slider|carousel/i.test(hay)) {\n            imageSet.add(src);\n        }\n    });\n    // Additional extraction: attempt to fetch the Shopify .js endpoint for\n    // richer product data. Many Shopify stores expose a JSON file at\n    // <product-url>.js which contains an array of image URLs and the\n    // featured image. If the request fails or the response is not JSON,\n    // we silently ignore it. We prefix protocol-relative URLs with\n    // https: to ensure absolute paths. Any images found here are added\n    // to imageSet. This logic mirrors the working implementation from\n    // the provided reference package. It avoids slicing the JSON by\n    // braces and instead lets JSON.parse handle the string.\n    try {\n        const jsUrl = url.endsWith(\".js\") ? url : `${url}.js`;\n        const jsResp = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(jsUrl, {\n            headers: {\n                \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0 Safari/537.36\"\n            },\n            maxRedirects: 3\n        });\n        const jsData = jsResp.data;\n        // If response is a string, attempt to parse JSON; if it's already\n        // an object we can process it directly. Some platforms escape\n        // unicode sequences, but JSON.parse will handle them.\n        const parsedData = typeof jsData === \"string\" ? JSON.parse(jsData) : typeof jsData === \"object\" ? jsData : null;\n        if (parsedData && typeof parsedData === \"object\") {\n            // Extract images array\n            const imgs = parsedData.images;\n            if (Array.isArray(imgs)) {\n                for (const p of imgs){\n                    if (typeof p === \"string\" && p) {\n                        const imgUrl = p.startsWith(\"//\") ? `https:${p}` : p;\n                        if (/^https?:\\/\\//i.test(imgUrl)) {\n                            imageSet.add(imgUrl);\n                        }\n                    }\n                }\n            }\n            // Extract featured image\n            const feat = parsedData.featured_image;\n            if (typeof feat === \"string\" && feat) {\n                const full = feat.startsWith(\"//\") ? `https:${feat}` : feat;\n                if (/^https?:\\/\\//i.test(full)) {\n                    imageSet.add(full);\n                }\n            }\n        }\n    } catch (err) {\n    // Silently ignore errors; the JSON endpoint may not exist or may not\n    // return valid JSON. In such cases we simply rely on images\n    // extracted from the HTML and JSON-LD.\n    }\n    // Assign images array if more than one image is found\n    const imagesArr = Array.from(imageSet);\n    if (imagesArr.length > 0) {\n        // Assign the images directly from imageSet. The imageSet itself\n        // already deduplicates exact URLs while preserving insertion order.\n        // We no longer deduplicate by base path (query parameters) because\n        // some stores use the same base for different images. Instead we\n        // preserve all unique URLs. We still move the primary image to\n        // the front of the array if it exists and is not already first.\n        let deduped = imagesArr;\n        if (product.image) {\n            const index = deduped.findIndex((i)=>i === product.image);\n            if (index > 0) {\n                const [img] = deduped.splice(index, 1);\n                deduped.unshift(img);\n            } else if (index === -1) {\n                deduped.unshift(product.image);\n            }\n        }\n        product.images = deduped;\n    }\n    return product;\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxzREFBc0Q7SUFDdEQsTUFBTUMsWUFBWXZGLE1BQU13RixJQUFJLENBQUN2QjtJQUM3QixJQUFJc0IsVUFBVWpELE1BQU0sR0FBRyxHQUFHO1FBQ3hCLGdFQUFnRTtRQUNoRSxvRUFBb0U7UUFDcEUsbUVBQW1FO1FBQ25FLGlFQUFpRTtRQUNqRSwrREFBK0Q7UUFDL0QsZ0VBQWdFO1FBQ2hFLElBQUltRCxVQUFvQkY7UUFDeEIsSUFBSXRELFFBQVFQLEtBQUssRUFBRTtZQUNqQixNQUFNZ0UsUUFBUUQsUUFBUUUsU0FBUyxDQUFDLENBQUNDLElBQU1BLE1BQU0zRCxRQUFRUCxLQUFLO1lBQzFELElBQUlnRSxRQUFRLEdBQUc7Z0JBQ2IsTUFBTSxDQUFDdEIsSUFBSSxHQUFHcUIsUUFBUUksTUFBTSxDQUFDSCxPQUFPO2dCQUNwQ0QsUUFBUUssT0FBTyxDQUFDMUI7WUFDbEIsT0FBTyxJQUFJc0IsVUFBVSxDQUFDLEdBQUc7Z0JBQ3ZCRCxRQUFRSyxPQUFPLENBQUM3RCxRQUFRUCxLQUFLO1lBQy9CO1FBQ0Y7UUFDQU8sUUFBUU4sTUFBTSxHQUFHOEQ7SUFDbkI7SUFFQSxPQUFPeEQ7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL2VkbS1idWlsZGVyLy4vbGliL3BhcnNlci50cz80YTYxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XG5pbXBvcnQgKiBhcyBjaGVlcmlvIGZyb20gJ2NoZWVyaW8nO1xuaW1wb3J0IHsgUHJvZHVjdERhdGEgfSBmcm9tICcuL3R5cGVzJztcblxuLyoqXG4gKiBTaGFwZSBvZiB0aGUgaW5mb3JtYXRpb24gd2UgY2FyZSBhYm91dCBmcm9tIGEgcHJvZHVjdCBwYWdlLlxuICpcbiAqIFRoZXNlIGZpZWxkcyBtaXJyb3IgdGhlIHBsYWNlaG9sZGVycyB1c2VkIGluIHRlbXBsYXRlcy4gU29tZVxuICogZmllbGRzIGFyZSBvcHRpb25hbCBiZWNhdXNlIG5vdCBldmVyeSBwYWdlIHdpbGwgZXhwb3NlIHRoZW0uXG4gKi9cbi8vIFByb2R1Y3REYXRhIHR5cGUgbW92ZWQgdG8gbGliL3R5cGVzLnRzXG5cbi8qKlxuICogQXR0ZW1wdCB0byBwYXJzZSBzdHJ1Y3R1cmVkIEpTT04tTEQgZGF0YSBmcm9tIHRoZSBwYWdlLiBNYW55XG4gKiBl4oCRY29tbWVyY2UgcGxhdGZvcm1zIGVtYmVkIGFuIG9iamVjdCB3aXRoIHRoZSBzY2hlbWEub3JnXG4gKiBQcm9kdWN0IHR5cGUuIFRoaXMgaGVscGVyIGV4dHJhY3RzIGl0IGlmIHByZXNlbnQuXG4gKi9cbmZ1bmN0aW9uIHBhcnNlTGRKc29uKCQ6IGNoZWVyaW8uQ2hlZXJpb0FQSSk6IFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsIHtcbiAgY29uc3Qgc2NyaXB0cyA9ICQoJ3NjcmlwdFt0eXBlPVwiYXBwbGljYXRpb24vbGQranNvblwiXScpLnRvQXJyYXkoKTtcbiAgZm9yIChjb25zdCBlbCBvZiBzY3JpcHRzKSB7XG4gICAgY29uc3QgY29udGVudHMgPSAkKGVsKS5jb250ZW50cygpLnRleHQoKTtcbiAgICBpZiAoIWNvbnRlbnRzKSBjb250aW51ZTtcbiAgICB0cnkge1xuICAgICAgY29uc3QganNvbiA9IEpTT04ucGFyc2UoY29udGVudHMudHJpbSgpKTtcbiAgICAgIC8vIFNvbWV0aW1lcyBtdWx0aXBsZSBvYmplY3RzIGFyZSB3cmFwcGVkIGluIGFuIGFycmF5LlxuICAgICAgY29uc3QgY2FuZGlkYXRlcyA9IEFycmF5LmlzQXJyYXkoanNvbikgPyBqc29uIDogW2pzb25dO1xuICAgICAgZm9yIChjb25zdCBvYmogb2YgY2FuZGlkYXRlcykge1xuICAgICAgICBpZiAob2JqWydAdHlwZSddID09PSAnUHJvZHVjdCcpIHtcbiAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoXykge1xuICAgICAgLy8gaWdub3JlIEpTT04gcGFyc2UgZXJyb3JzIGFuZCBjb250aW51ZS5cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogR2VuZXJpYyBoZWxwZXIgdG8gZXh0cmFjdCBhIG1ldGEgdGFnIHZhbHVlLiBJdCBmaXJzdCB0cmllcyB0b1xuICogbWF0Y2ggdGhlIGdpdmVuIHByb3BlcnR5IG9uIHRoZSBgbWV0YVtwcm9wZXJ0eV1gIGF0dHJpYnV0ZSAoYXMgdXNlZFxuICogYnkgT3BlbiBHcmFwaCksIHRoZW4gZmFsbHMgYmFjayB0byBgbWV0YVtuYW1lXWAuXG4gKi9cbmZ1bmN0aW9uIGdldE1ldGEoJDogY2hlZXJpby5DaGVlcmlvQVBJLCBwcm9wOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgcmV0dXJuIChcbiAgICAkKGBtZXRhW3Byb3BlcnR5PScke3Byb3B9J11gKS5hdHRyKCdjb250ZW50JykgfHxcbiAgICAkKGBtZXRhW25hbWU9JyR7cHJvcH0nXWApLmF0dHIoJ2NvbnRlbnQnKSB8fFxuICAgIG51bGxcbiAgKTtcbn1cblxuLyoqXG4gKiBGZXRjaCBhIHByb2R1Y3QgcGFnZSBhbmQgZXh0cmFjdCBiYXNpYyBmaWVsZHMgdXNpbmcgaGV1cmlzdGljcy4gVGhpc1xuICogZnVuY3Rpb24gZG9lcyBub3QgYXR0ZW1wdCB0byBkZWVwbHkgY3Jhd2wgdGhlIERPTTsgaW5zdGVhZCBpdCByZWxpZXNcbiAqIG9uIE9wZW4gR3JhcGggdGFncywgSlNPTuKAkUxEIGFuZCBjb21tb24gbWljcm9kYXRhIGF0dHJpYnV0ZXMuIElmIGFcbiAqIGZpZWxkIGNhbm5vdCBiZSByZXNvbHZlZCBpdCB3aWxsIGJlIHJldHVybmVkIGFzIGFuIGVtcHR5IHN0cmluZy5cbiAqXG4gKiBJZiB0aGUgcmVxdWVzdCBmYWlscyBmb3Igd2hhdGV2ZXIgcmVhc29uIHRoZSByZXN1bHRpbmcgb2JqZWN0IHdpbGxcbiAqIGNvbnRhaW4gZW1wdHkgc3RyaW5ncyBmb3IgYWxsIHByb3BlcnRpZXMgZXhjZXB0IHVybCBhbmQgY3RhLlxuICpcbiAqIEBwYXJhbSB1cmwgUHJvZHVjdCBwYWdlIFVSTFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcGFyc2VQcm9kdWN0KHVybDogc3RyaW5nKTogUHJvbWlzZTxQcm9kdWN0RGF0YT4ge1xuICBjb25zdCBjbGVhbiA9ICh2YWx1ZTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCk6IHN0cmluZyA9PlxuICAgICh2YWx1ZSB8fCAnJykudG9TdHJpbmcoKS50cmltKCk7XG5cbiAgbGV0IGh0bWwgPSAnJztcbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldCh1cmwsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgLy8gU2V0IGEgdXNlciBhZ2VudCBzbyB0aGF0IHNvbWUgc2l0ZXMgZG9u4oCZdCBibG9jayBvdXIgcmVxdWVzdC5cbiAgICAgICAgJ1VzZXItQWdlbnQnOlxuICAgICAgICAgICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTE2LjAgU2FmYXJpLzUzNy4zNidcbiAgICAgIH0sXG4gICAgICAvLyBGb2xsb3cgcmVkaXJlY3RzIGF1dG9tYXRpY2FsbHkuXG4gICAgICBtYXhSZWRpcmVjdHM6IDNcbiAgICB9KTtcbiAgICBodG1sID0gcmVzcG9uc2UuZGF0YTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggJHt1cmx9OmAsIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogZXJyb3IpO1xuICAgIHJldHVybiB7XG4gICAgICB1cmwsXG4gICAgICBwcmV0aXRsZTogJycsXG4gICAgICB0aXRsZTogJycsXG4gICAgICBwcmljZTogJycsXG4gICAgICBkZXNjcmlwdGlvbjogJycsXG4gICAgICBpbWFnZTogJycsXG4gICAgICBpbWFnZXM6IHVuZGVmaW5lZCxcbiAgICAgIGN0YTogdXJsLFxuICAgICAgY3RhTGFiZWw6ICdTSE9QIE5PVydcbiAgICB9IGFzIFByb2R1Y3REYXRhO1xuICB9XG5cbiAgY29uc3QgJCA9IGNoZWVyaW8ubG9hZChodG1sKTtcblxuICAvLyBBdHRlbXB0IHRvIHBhcnNlIEpTT07igJFMRCBzdHJ1Y3R1cmVkIGRhdGEgZmlyc3QgYmVjYXVzZSBpdCB0eXBpY2FsbHlcbiAgLy8gcHJvdmlkZXMgdGhlIHJpY2hlc3QgaW5mb3JtYXRpb24uIFdlIGZhbGwgYmFjayB0byBtZXRhIHRhZ3MgaWZcbiAgLy8gc3RydWN0dXJlZCBkYXRhIGlzIG5vdCBwcmVzZW50IG9yIGluY29tcGxldGUuXG4gIGNvbnN0IGxkID0gcGFyc2VMZEpzb24oJCkgfHwge307XG4gIGNvbnN0IHByb2R1Y3Q6IFByb2R1Y3REYXRhID0ge1xuICAgIHVybCxcbiAgICBwcmV0aXRsZTogJycsXG4gICAgdGl0bGU6ICcnLFxuICAgIHByaWNlOiAnJyxcbiAgICBvcmlnaW5hbFByaWNlOiB1bmRlZmluZWQsXG4gICAgZGVzY3JpcHRpb246ICcnLFxuICAgIGltYWdlOiAnJyxcbiAgICBpbWFnZXM6IHVuZGVmaW5lZCxcbiAgICBjdGE6IHVybFxuICAgICxcbiAgICAvLyBEZWZhdWx0IGNhbGwtdG8tYWN0aW9uIGxhYmVsLiBVc2VycyBjYW4gb3ZlcnJpZGUgdGhpcyBpbiB0aGVcbiAgICAvLyBwcmV2aWV3IGJ5IGVkaXRpbmcgdGhlIENUQSB0ZXh0LiBJZiBub3QgcHJvdmlkZWQsIHRlbXBsYXRlc1xuICAgIC8vIHdpbGwgZmFsbCBiYWNrIHRvIHRoaXMgdmFsdWUuXG4gICAgY3RhTGFiZWw6ICdTSE9QIE5PVydcbiAgfTtcblxuICAvLyBUaXRsZVxuICBwcm9kdWN0LnRpdGxlID1cbiAgICBjbGVhbihsZC5uYW1lKSB8fFxuICAgIGNsZWFuKGdldE1ldGEoJCwgJ29nOnRpdGxlJykpIHx8XG4gICAgY2xlYW4oZ2V0TWV0YSgkLCAndHdpdHRlcjp0aXRsZScpKSB8fFxuICAgIGNsZWFuKCQoJ3RpdGxlJykuZmlyc3QoKS50ZXh0KCkpO1xuXG4gIC8vIERlc2NyaXB0aW9uXG4gIHByb2R1Y3QuZGVzY3JpcHRpb24gPVxuICAgIGNsZWFuKGxkLmRlc2NyaXB0aW9uKSB8fFxuICAgIGNsZWFuKGdldE1ldGEoJCwgJ29nOmRlc2NyaXB0aW9uJykpIHx8XG4gICAgY2xlYW4oZ2V0TWV0YSgkLCAndHdpdHRlcjpkZXNjcmlwdGlvbicpKSB8fFxuICAgIGNsZWFuKGdldE1ldGEoJCwgJ2Rlc2NyaXB0aW9uJykpO1xuXG4gIC8vIEV4dHJhY3Qgc3BlY2lmaWMgZGVzY3JpcHRpb24gc291cmNlcyBmcm9tIC5wcm9kdWN0X19kZXNjcmlwdGlvblxuICB0cnkge1xuICAgIGNvbnN0IGRlc2NSb290ID0gJCgnLnByb2R1Y3RfX2Rlc2NyaXB0aW9uJykuZmlyc3QoKTtcbiAgICBpZiAoZGVzY1Jvb3QgJiYgZGVzY1Jvb3QubGVuZ3RoKSB7XG4gICAgICBjb25zdCBwID0gZGVzY1Jvb3QuZmluZCgncCcpLmZpcnN0KCk7XG4gICAgICBpZiAocCAmJiBwLmxlbmd0aCkge1xuICAgICAgICBwcm9kdWN0LmRlc2NyaXB0aW9uUCA9IGNsZWFuKHAudGV4dCgpKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVsID0gZGVzY1Jvb3QuZmluZCgndWwnKS5maXJzdCgpO1xuICAgICAgaWYgKHVsICYmIHVsLmxlbmd0aCkge1xuICAgICAgICAvLyBQcmVzZXJ2ZSBVTCBzdHJ1Y3R1cmUgYXMgSFRNTCBmb3IgZW1haWwgcHJldmlldy90ZW1wbGF0ZVxuICAgICAgICBwcm9kdWN0LmRlc2NyaXB0aW9uVWwgPSAkLmh0bWwodWwpO1xuICAgICAgfVxuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIC8vIGlnbm9yZSBleHRyYWN0aW9uIGVycm9yc1xuICB9XG5cbiAgLy8gSW1hZ2VcbiAgY29uc3QgbGRJbWFnZTogc3RyaW5nIHwgdW5kZWZpbmVkID0gQXJyYXkuaXNBcnJheShsZC5pbWFnZSlcbiAgICA/IGxkLmltYWdlWzBdXG4gICAgOiB0eXBlb2YgbGQuaW1hZ2UgPT09ICdzdHJpbmcnXG4gICAgPyBsZC5pbWFnZVxuICAgIDogdW5kZWZpbmVkO1xuICBwcm9kdWN0LmltYWdlID1cbiAgICBjbGVhbihsZEltYWdlKSB8fFxuICAgIGNsZWFuKGdldE1ldGEoJCwgJ29nOmltYWdlJykpIHx8XG4gICAgY2xlYW4oZ2V0TWV0YSgkLCAndHdpdHRlcjppbWFnZScpKSB8fFxuICAgIGNsZWFuKCQoJ2ltZycpLmZpcnN0KCkuYXR0cignc3JjJykpO1xuXG4gIC8vIFByaWNlXG4gIGNvbnN0IGxkT2ZmZXJzID0gbGQub2ZmZXJzO1xuICBsZXQgbGRQcmljZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICBpZiAobGRPZmZlcnMpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShsZE9mZmVycykpIHtcbiAgICAgIGxkUHJpY2UgPSBsZE9mZmVyc1swXT8ucHJpY2U7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgbGRPZmZlcnMgPT09ICdvYmplY3QnKSB7XG4gICAgICBsZFByaWNlID0gbGRPZmZlcnMucHJpY2U7XG4gICAgfVxuICB9XG4gIHByb2R1Y3QucHJpY2UgPVxuICAgIGNsZWFuKGxkUHJpY2UpIHx8XG4gICAgY2xlYW4oZ2V0TWV0YSgkLCAncHJvZHVjdDpwcmljZTphbW91bnQnKSkgfHxcbiAgICBjbGVhbihnZXRNZXRhKCQsICdvZzpwcmljZTphbW91bnQnKSkgfHxcbiAgICAvLyBUcnkgdG8gbWF0Y2ggbWljcm9kYXRhIG9uIHNpdGVzIGxpa2UgU2hvcGlmeTogW2l0ZW1wcm9wPVwicHJpY2VcIl1cbiAgICBjbGVhbigkKCdbaXRlbXByb3A9XCJwcmljZVwiXScpLmZpcnN0KCkudGV4dCgpKTtcblxuICAvLyBPcmlnaW5hbCBwcmljZTogYXR0ZW1wdCB0byBmaW5kIGEgY29tcGFyZeKAkWF0IG9yIHN0cmlrZeKAkXRocm91Z2ggcHJpY2UuIFRoaXNcbiAgLy8gY2FuIGFwcGVhciBpbiBKU09O4oCRTEQgYXMgYW4gXCJwcmljZVNwZWNpZmljYXRpb25cIiB3aXRoXG4gIC8vIFwicHJpY2VDdXJyZW5jeVwiIGFuZCBcInZhbHVlXCIsIG9yIGluIHRoZSBET00gYXMgPGRlbD4gb3IgYSBzcGFuIHdpdGhcbiAgLy8gY2xhc3MgY29udGFpbmluZyBcImNvbXBhcmVcIiBvciBcInN0cmlrZVwiLiBXZSBhdHRlbXB0IHNldmVyYWwgaGV1cmlzdGljc1xuICAvLyBhbmQgdGFrZSB0aGUgZmlyc3QgbnVtZXJpYyB2YWx1ZSB3ZSBmaW5kLiBUaGUgdmFsdWUgcmV0dXJuZWQgZG9lc1xuICAvLyBub3QgaW5jbHVkZSB0aGUgY3VycmVuY3kgc3ltYm9sLlxuICBsZXQgb3JpZ2luYWw6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgLy8gQ2hlY2sgSlNPTuKAkUxEIG9mZmVycy5jb21wYXJlUHJpY2UgaWYgcHJlc2VudFxuICBpZiAobGRPZmZlcnMpIHtcbiAgICAvLyBTb21lIHNjaGVtYXMgbmVzdCBjb21wYXJlQXRQcmljZSBvciBvcmlnaW5hbFByaWNlXG4gICAgY29uc3QgZ2V0Q29tcGFyZSA9IChvYmo6IGFueSk6IHN0cmluZyB8IHVuZGVmaW5lZCA9PiB7XG4gICAgICBpZiAoIW9iaikgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIHJldHVybiBvYmouY29tcGFyZUF0UHJpY2UgfHwgb2JqLm9yaWdpbmFsUHJpY2UgfHwgb2JqLnByaWNlU3BlY2lmaWNhdGlvbj8ucHJpY2U7XG4gICAgfTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShsZE9mZmVycykpIHtcbiAgICAgIGZvciAoY29uc3Qgb2ZmIG9mIGxkT2ZmZXJzKSB7XG4gICAgICAgIGNvbnN0IHZhbCA9IGdldENvbXBhcmUob2ZmKTtcbiAgICAgICAgaWYgKHZhbCkge1xuICAgICAgICAgIG9yaWdpbmFsID0gY2xlYW4odmFsKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIGxkT2ZmZXJzID09PSAnb2JqZWN0Jykge1xuICAgICAgY29uc3QgdmFsID0gZ2V0Q29tcGFyZShsZE9mZmVycyk7XG4gICAgICBpZiAodmFsKSB7XG4gICAgICAgIG9yaWdpbmFsID0gY2xlYW4odmFsKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYgKCFvcmlnaW5hbCkge1xuICAgIC8vIExvb2sgZm9yIGVsZW1lbnRzIGNvbnRhaW5pbmcgYSBwcmljZSB3aXRoIGEgbGluZeKAkXRocm91Z2ggc3R5bGUgb3IgYVxuICAgIC8vIGNsYXNzIGluZGljYXRpbmcgXCJjb21wYXJlXCIgb3IgXCJvcmlnaW5hbFwiLiBXZSBleHRyYWN0IG51bWVyaWNcbiAgICAvLyB2YWx1ZXMgKGRpZ2l0cyBhbmQgZGVjaW1hbCBzZXBhcmF0b3JzKS5cbiAgICBjb25zdCBwcmljZVJlZ2V4ID0gLyhbXFxkLC5dKylcXHMqKD86W0EtWl17M30pPy87XG4gICAgLy8gaGVscGVyIHRvIHBhcnNlIHRleHRcbiAgICBjb25zdCBwYXJzZVByaWNlVGV4dCA9ICh0ZXh0OiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IG1hdGNoID0gcHJpY2VSZWdleC5leGVjKHRleHQpO1xuICAgICAgcmV0dXJuIG1hdGNoID8gbWF0Y2hbMV0gOiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICAvLyBDaGVjayA8ZGVsPiBlbGVtZW50c1xuICAgICQoJ2RlbCwgc3RyaWtlJykuZWFjaCgoXywgZWwpID0+IHtcbiAgICAgIGNvbnN0IHRleHQgPSAkKGVsKS50ZXh0KCk7XG4gICAgICBjb25zdCB2YWwgPSBwYXJzZVByaWNlVGV4dCh0ZXh0KTtcbiAgICAgIGlmICh2YWwpIHtcbiAgICAgICAgb3JpZ2luYWwgPSBjbGVhbih2YWwpO1xuICAgICAgICByZXR1cm4gZmFsc2U7IC8vIGJyZWFrIHRoZSBsb29wXG4gICAgICB9XG4gICAgfSk7XG4gICAgLy8gQ2hlY2sgZWxlbWVudHMgd2l0aCBjbGFzcyBjb250YWluaW5nIGNvbXBhcmUgb3Igb3JpZ2luYWxcbiAgICBpZiAoIW9yaWdpbmFsKSB7XG4gICAgICAkKCdbY2xhc3MqPVwiY29tcGFyZVwiXSxbY2xhc3MqPVwib3JpZ2luYWxcIl0sW2NsYXNzKj1cInN0cmlrZVwiXScpLmVhY2goKF8sIGVsKSA9PiB7XG4gICAgICAgIGNvbnN0IHRleHQgPSAkKGVsKS50ZXh0KCk7XG4gICAgICAgIGNvbnN0IHZhbCA9IHBhcnNlUHJpY2VUZXh0KHRleHQpO1xuICAgICAgICBpZiAodmFsKSB7XG4gICAgICAgICAgb3JpZ2luYWwgPSBjbGVhbih2YWwpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIC8vIEFzc2lnbiBvcmlnaW5hbFByaWNlIGlmIGZvdW5kIGFuZCBkaWZmZXJlbnQgZnJvbSBzYWxlIHByaWNlXG4gIGlmIChvcmlnaW5hbCAmJiBvcmlnaW5hbCAhPT0gcHJvZHVjdC5wcmljZSkge1xuICAgIHByb2R1Y3Qub3JpZ2luYWxQcmljZSA9IG9yaWdpbmFsO1xuICB9XG5cbiAgLy8gUHJldGl0bGU6IG5vdCB3aWRlbHkgYXZhaWxhYmxlLiBBcyBhIGhldXJpc3RpYywgaWYgdGhlIHRpdGxlXG4gIC8vIGNvbnRhaW5zIGEgaHlwaGVuLCBzcGxpdCB0aGUgZmlyc3QgcGFydCBhcyBwcmV0aXRsZSBhbmQgdGhlIHJlc3RcbiAgLy8gYXMgdGhlIGFjdHVhbCB0aXRsZS5cbiAgaWYgKHByb2R1Y3QudGl0bGUgJiYgcHJvZHVjdC50aXRsZS5pbmNsdWRlcygnIOKAkyAnKSkge1xuICAgIGNvbnN0IHBhcnRzID0gcHJvZHVjdC50aXRsZS5zcGxpdCgvXFxzK+KAk1xccysvKTtcbiAgICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xuICAgICAgcHJvZHVjdC5wcmV0aXRsZSA9IHBhcnRzWzBdO1xuICAgICAgcHJvZHVjdC50aXRsZSA9IHBhcnRzLnNsaWNlKDEpLmpvaW4oJyDigJMgJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gQ29sb3VyIGNhcHR1cmUgcmVtb3ZlZCBwZXIgcmVmYWN0b3I7IG5vIHN3YXRjaCBkZXRlY3Rpb25cblxuICAvLyBJbWFnZXM6IGNvbGxlY3QgYWRkaXRpb25hbCBpbWFnZSBVUkxzIGJleW9uZCB0aGUgcHJpbWFyeSBpbWFnZS4gV2VcbiAgLy8gc3RhcnQgd2l0aCB0aGUgcHJpbWFyeSBpbWFnZSBpZiBpdCBleGlzdHMuIFRoZW4gc2VhcmNoIGZvciBpbWFnZVxuICAvLyBlbGVtZW50cyB0aGF0IGFyZSBsaWtlbHkgcGFydCBvZiB0aGUgcHJvZHVjdCBnYWxsZXJ5LiBIZXVyaXN0aWNzXG4gIC8vIGluY2x1ZGUgY2xhc3MgbmFtZXMgY29udGFpbmluZyBcInByb2R1Y3RcIiwgXCJnYWxsZXJ5XCIsIFwidGh1bWJcIiwgb3JcbiAgLy8gXCJpbWFnZVwiLiBXZSBhbHNvIGFjY2VwdCBKU09O4oCRTEQgaW1hZ2UgYXJyYXlzLiBPbmx5IGFic29sdXRlXG4gIC8vIFVSTHMgKGh0dHAgb3IgaHR0cHMpIGFyZSBrZXB0IGFuZCBkdXBsaWNhdGVzIHJlbW92ZWQuXG4gIGNvbnN0IGltYWdlU2V0ID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gIGlmIChwcm9kdWN0LmltYWdlKSB7XG4gICAgaW1hZ2VTZXQuYWRkKHByb2R1Y3QuaW1hZ2UpO1xuICB9XG4gIC8vIEFkZCBhbnkgYWRkaXRpb25hbCBpbWFnZXMgZnJvbSBKU09O4oCRTERcbiAgaWYgKEFycmF5LmlzQXJyYXkobGQuaW1hZ2UpKSB7XG4gICAgZm9yIChjb25zdCBpbWcgb2YgbGQuaW1hZ2UpIHtcbiAgICAgIGlmICh0eXBlb2YgaW1nID09PSAnc3RyaW5nJyAmJiAvXmh0dHBzPzpcXC9cXC8vaS50ZXN0KGltZykpIHtcbiAgICAgICAgaW1hZ2VTZXQuYWRkKGltZyk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIC8vIERPTSBleHRyYWN0aW9uOiBmaW5kIGltYWdlcyB3aXRoIHJlbGV2YW50IGNsYXNzIGhpbnRzXG4gICQoJ2ltZycpLmVhY2goKF8sIGVsKSA9PiB7XG4gICAgY29uc3Qgc3JjID0gY2xlYW4oJChlbCkuYXR0cignc3JjJykpO1xuICAgIGlmICghc3JjKSByZXR1cm47XG4gICAgLy8gT25seSBhY2NlcHQgYWJzb2x1dGUgVVJMc1xuICAgIGlmICghL15odHRwcz86XFwvXFwvL2kudGVzdChzcmMpKSByZXR1cm47XG4gICAgLy8gQWNjZXB0IGltYWdlcyBpZiB0aGV5IGNvbnRhaW4gY2VydGFpbiBrZXl3b3JkcyBpbiB0aGVpciBjbGFzcyBvciBpZFxuICAgIGNvbnN0IGNsYXNzZXMgPSAoJChlbCkuYXR0cignY2xhc3MnKSB8fCAnJykgKyAnICcgKyAoJChlbCkucGFyZW50KCkuYXR0cignY2xhc3MnKSB8fCAnJyk7XG4gICAgY29uc3QgaWRzID0gKCQoZWwpLmF0dHIoJ2lkJykgfHwgJycpICsgJyAnICsgKCQoZWwpLnBhcmVudCgpLmF0dHIoJ2lkJykgfHwgJycpO1xuICAgIGNvbnN0IGhheSA9IGNsYXNzZXMgKyAnICcgKyBpZHM7XG4gICAgaWYgKC9wcm9kdWN0fGdhbGxlcnl8dGh1bWJ8aW1hZ2V8c2xpZGVyfGNhcm91c2VsL2kudGVzdChoYXkpKSB7XG4gICAgICBpbWFnZVNldC5hZGQoc3JjKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8vIEFkZGl0aW9uYWwgZXh0cmFjdGlvbjogYXR0ZW1wdCB0byBmZXRjaCB0aGUgU2hvcGlmeSAuanMgZW5kcG9pbnQgZm9yXG4gIC8vIHJpY2hlciBwcm9kdWN0IGRhdGEuIE1hbnkgU2hvcGlmeSBzdG9yZXMgZXhwb3NlIGEgSlNPTiBmaWxlIGF0XG4gIC8vIDxwcm9kdWN0LXVybD4uanMgd2hpY2ggY29udGFpbnMgYW4gYXJyYXkgb2YgaW1hZ2UgVVJMcyBhbmQgdGhlXG4gIC8vIGZlYXR1cmVkIGltYWdlLiBJZiB0aGUgcmVxdWVzdCBmYWlscyBvciB0aGUgcmVzcG9uc2UgaXMgbm90IEpTT04sXG4gIC8vIHdlIHNpbGVudGx5IGlnbm9yZSBpdC4gV2UgcHJlZml4IHByb3RvY29sLXJlbGF0aXZlIFVSTHMgd2l0aFxuICAvLyBodHRwczogdG8gZW5zdXJlIGFic29sdXRlIHBhdGhzLiBBbnkgaW1hZ2VzIGZvdW5kIGhlcmUgYXJlIGFkZGVkXG4gIC8vIHRvIGltYWdlU2V0LiBUaGlzIGxvZ2ljIG1pcnJvcnMgdGhlIHdvcmtpbmcgaW1wbGVtZW50YXRpb24gZnJvbVxuICAvLyB0aGUgcHJvdmlkZWQgcmVmZXJlbmNlIHBhY2thZ2UuIEl0IGF2b2lkcyBzbGljaW5nIHRoZSBKU09OIGJ5XG4gIC8vIGJyYWNlcyBhbmQgaW5zdGVhZCBsZXRzIEpTT04ucGFyc2UgaGFuZGxlIHRoZSBzdHJpbmcuXG4gIHRyeSB7XG4gICAgY29uc3QganNVcmwgPSB1cmwuZW5kc1dpdGgoJy5qcycpID8gdXJsIDogYCR7dXJsfS5qc2A7XG4gICAgY29uc3QganNSZXNwID0gYXdhaXQgYXhpb3MuZ2V0KGpzVXJsLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdVc2VyLUFnZW50JzpcbiAgICAgICAgICAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzExNi4wIFNhZmFyaS81MzcuMzYnXG4gICAgICB9LFxuICAgICAgbWF4UmVkaXJlY3RzOiAzXG4gICAgfSk7XG4gICAgY29uc3QganNEYXRhID0ganNSZXNwLmRhdGE7XG4gICAgLy8gSWYgcmVzcG9uc2UgaXMgYSBzdHJpbmcsIGF0dGVtcHQgdG8gcGFyc2UgSlNPTjsgaWYgaXQncyBhbHJlYWR5XG4gICAgLy8gYW4gb2JqZWN0IHdlIGNhbiBwcm9jZXNzIGl0IGRpcmVjdGx5LiBTb21lIHBsYXRmb3JtcyBlc2NhcGVcbiAgICAvLyB1bmljb2RlIHNlcXVlbmNlcywgYnV0IEpTT04ucGFyc2Ugd2lsbCBoYW5kbGUgdGhlbS5cbiAgICBjb25zdCBwYXJzZWREYXRhID1cbiAgICAgIHR5cGVvZiBqc0RhdGEgPT09ICdzdHJpbmcnXG4gICAgICAgID8gSlNPTi5wYXJzZShqc0RhdGEpXG4gICAgICAgIDogdHlwZW9mIGpzRGF0YSA9PT0gJ29iamVjdCdcbiAgICAgICAgPyBqc0RhdGFcbiAgICAgICAgOiBudWxsO1xuICAgIGlmIChwYXJzZWREYXRhICYmIHR5cGVvZiBwYXJzZWREYXRhID09PSAnb2JqZWN0Jykge1xuICAgICAgLy8gRXh0cmFjdCBpbWFnZXMgYXJyYXlcbiAgICAgIGNvbnN0IGltZ3M6IHVua25vd24gPSAocGFyc2VkRGF0YSBhcyBhbnkpLmltYWdlcztcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGltZ3MpKSB7XG4gICAgICAgIGZvciAoY29uc3QgcCBvZiBpbWdzKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBwID09PSAnc3RyaW5nJyAmJiBwKSB7XG4gICAgICAgICAgICBjb25zdCBpbWdVcmwgPSBwLnN0YXJ0c1dpdGgoJy8vJykgPyBgaHR0cHM6JHtwfWAgOiBwO1xuICAgICAgICAgICAgaWYgKC9eaHR0cHM/OlxcL1xcLy9pLnRlc3QoaW1nVXJsKSkge1xuICAgICAgICAgICAgICBpbWFnZVNldC5hZGQoaW1nVXJsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIEV4dHJhY3QgZmVhdHVyZWQgaW1hZ2VcbiAgICAgIGNvbnN0IGZlYXQ6IHVua25vd24gPSAocGFyc2VkRGF0YSBhcyBhbnkpLmZlYXR1cmVkX2ltYWdlO1xuICAgICAgaWYgKHR5cGVvZiBmZWF0ID09PSAnc3RyaW5nJyAmJiBmZWF0KSB7XG4gICAgICAgIGNvbnN0IGZ1bGwgPSBmZWF0LnN0YXJ0c1dpdGgoJy8vJykgPyBgaHR0cHM6JHtmZWF0fWAgOiBmZWF0O1xuICAgICAgICBpZiAoL15odHRwcz86XFwvXFwvL2kudGVzdChmdWxsKSkge1xuICAgICAgICAgIGltYWdlU2V0LmFkZChmdWxsKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgLy8gU2lsZW50bHkgaWdub3JlIGVycm9yczsgdGhlIEpTT04gZW5kcG9pbnQgbWF5IG5vdCBleGlzdCBvciBtYXkgbm90XG4gICAgLy8gcmV0dXJuIHZhbGlkIEpTT04uIEluIHN1Y2ggY2FzZXMgd2Ugc2ltcGx5IHJlbHkgb24gaW1hZ2VzXG4gICAgLy8gZXh0cmFjdGVkIGZyb20gdGhlIEhUTUwgYW5kIEpTT04tTEQuXG4gIH1cbiAgLy8gQXNzaWduIGltYWdlcyBhcnJheSBpZiBtb3JlIHRoYW4gb25lIGltYWdlIGlzIGZvdW5kXG4gIGNvbnN0IGltYWdlc0FyciA9IEFycmF5LmZyb20oaW1hZ2VTZXQpO1xuICBpZiAoaW1hZ2VzQXJyLmxlbmd0aCA+IDApIHtcbiAgICAvLyBBc3NpZ24gdGhlIGltYWdlcyBkaXJlY3RseSBmcm9tIGltYWdlU2V0LiBUaGUgaW1hZ2VTZXQgaXRzZWxmXG4gICAgLy8gYWxyZWFkeSBkZWR1cGxpY2F0ZXMgZXhhY3QgVVJMcyB3aGlsZSBwcmVzZXJ2aW5nIGluc2VydGlvbiBvcmRlci5cbiAgICAvLyBXZSBubyBsb25nZXIgZGVkdXBsaWNhdGUgYnkgYmFzZSBwYXRoIChxdWVyeSBwYXJhbWV0ZXJzKSBiZWNhdXNlXG4gICAgLy8gc29tZSBzdG9yZXMgdXNlIHRoZSBzYW1lIGJhc2UgZm9yIGRpZmZlcmVudCBpbWFnZXMuIEluc3RlYWQgd2VcbiAgICAvLyBwcmVzZXJ2ZSBhbGwgdW5pcXVlIFVSTHMuIFdlIHN0aWxsIG1vdmUgdGhlIHByaW1hcnkgaW1hZ2UgdG9cbiAgICAvLyB0aGUgZnJvbnQgb2YgdGhlIGFycmF5IGlmIGl0IGV4aXN0cyBhbmQgaXMgbm90IGFscmVhZHkgZmlyc3QuXG4gICAgbGV0IGRlZHVwZWQ6IHN0cmluZ1tdID0gaW1hZ2VzQXJyO1xuICAgIGlmIChwcm9kdWN0LmltYWdlKSB7XG4gICAgICBjb25zdCBpbmRleCA9IGRlZHVwZWQuZmluZEluZGV4KChpKSA9PiBpID09PSBwcm9kdWN0LmltYWdlKTtcbiAgICAgIGlmIChpbmRleCA+IDApIHtcbiAgICAgICAgY29uc3QgW2ltZ10gPSBkZWR1cGVkLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIGRlZHVwZWQudW5zaGlmdChpbWcpO1xuICAgICAgfSBlbHNlIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgZGVkdXBlZC51bnNoaWZ0KHByb2R1Y3QuaW1hZ2UpO1xuICAgICAgfVxuICAgIH1cbiAgICBwcm9kdWN0LmltYWdlcyA9IGRlZHVwZWQ7XG4gIH1cblxuICByZXR1cm4gcHJvZHVjdDtcbn1cbiJdLCJuYW1lcyI6WyJheGlvcyIsImNoZWVyaW8iLCJwYXJzZUxkSnNvbiIsIiQiLCJzY3JpcHRzIiwidG9BcnJheSIsImVsIiwiY29udGVudHMiLCJ0ZXh0IiwianNvbiIsIkpTT04iLCJwYXJzZSIsInRyaW0iLCJjYW5kaWRhdGVzIiwiQXJyYXkiLCJpc0FycmF5Iiwib2JqIiwiXyIsImdldE1ldGEiLCJwcm9wIiwiYXR0ciIsInBhcnNlUHJvZHVjdCIsInVybCIsImNsZWFuIiwidmFsdWUiLCJ0b1N0cmluZyIsImh0bWwiLCJyZXNwb25zZSIsImdldCIsImhlYWRlcnMiLCJtYXhSZWRpcmVjdHMiLCJkYXRhIiwiZXJyb3IiLCJjb25zb2xlIiwiRXJyb3IiLCJtZXNzYWdlIiwicHJldGl0bGUiLCJ0aXRsZSIsInByaWNlIiwiZGVzY3JpcHRpb24iLCJpbWFnZSIsImltYWdlcyIsInVuZGVmaW5lZCIsImN0YSIsImN0YUxhYmVsIiwibG9hZCIsImxkIiwicHJvZHVjdCIsIm9yaWdpbmFsUHJpY2UiLCJuYW1lIiwiZmlyc3QiLCJkZXNjUm9vdCIsImxlbmd0aCIsInAiLCJmaW5kIiwiZGVzY3JpcHRpb25QIiwidWwiLCJkZXNjcmlwdGlvblVsIiwiZSIsImxkSW1hZ2UiLCJsZE9mZmVycyIsIm9mZmVycyIsImxkUHJpY2UiLCJvcmlnaW5hbCIsImdldENvbXBhcmUiLCJjb21wYXJlQXRQcmljZSIsInByaWNlU3BlY2lmaWNhdGlvbiIsIm9mZiIsInZhbCIsInByaWNlUmVnZXgiLCJwYXJzZVByaWNlVGV4dCIsIm1hdGNoIiwiZXhlYyIsImVhY2giLCJpbmNsdWRlcyIsInBhcnRzIiwic3BsaXQiLCJzbGljZSIsImpvaW4iLCJpbWFnZVNldCIsIlNldCIsImFkZCIsImltZyIsInRlc3QiLCJzcmMiLCJjbGFzc2VzIiwicGFyZW50IiwiaWRzIiwiaGF5IiwianNVcmwiLCJlbmRzV2l0aCIsImpzUmVzcCIsImpzRGF0YSIsInBhcnNlZERhdGEiLCJpbWdzIiwiaW1nVXJsIiwic3RhcnRzV2l0aCIsImZlYXQiLCJmZWF0dXJlZF9pbWFnZSIsImZ1bGwiLCJlcnIiLCJpbWFnZXNBcnIiLCJmcm9tIiwiZGVkdXBlZCIsImluZGV4IiwiZmluZEluZGV4IiwiaSIsInNwbGljZSIsInVuc2hpZnQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/parser.ts\n");

/***/ }),

/***/ "(api)/./pages/api/analyze.ts":
/*!******************************!*\
  !*** ./pages/api/analyze.ts ***!
  \******************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var cheerio__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! cheerio */ \"cheerio\");\n/* harmony import */ var _lib_parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../lib/parser */ \"(api)/./lib/parser.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([axios__WEBPACK_IMPORTED_MODULE_0__, cheerio__WEBPACK_IMPORTED_MODULE_1__, _lib_parser__WEBPACK_IMPORTED_MODULE_2__]);\n([axios__WEBPACK_IMPORTED_MODULE_0__, cheerio__WEBPACK_IMPORTED_MODULE_1__, _lib_parser__WEBPACK_IMPORTED_MODULE_2__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\nfunction absoluteUrl(base, url) {\n    if (!url) return \"\";\n    if (url.startsWith(\"http://\") || url.startsWith(\"https://\")) return url;\n    if (url.startsWith(\"//\")) return \"https:\" + url;\n    if (url.startsWith(\"/\")) return new URL(base).origin + url;\n    try {\n        return new URL(url, base).toString();\n    } catch  {\n        return url;\n    }\n}\nfunction rgbToHex(input) {\n    // supports rgb(a) like rgb(255,0,0) or rgba(255,0,0,1)\n    const m = input.match(/rgba?\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})/i);\n    if (!m) return null;\n    const r = Math.max(0, Math.min(255, parseInt(m[1], 10)));\n    const g = Math.max(0, Math.min(255, parseInt(m[2], 10)));\n    const b = Math.max(0, Math.min(255, parseInt(m[3], 10)));\n    const toHex = (n)=>n.toString(16).padStart(2, \"0\").toUpperCase();\n    return `#${toHex(r)}${toHex(g)}${toHex(b)}`;\n}\nfunction normalizeColor(val) {\n    if (!val) return null;\n    const cleaned = val.trim().replace(/!important/i, \"\").trim();\n    if (/^var\\(/i.test(cleaned)) return null;\n    if (/^transparent$/i.test(cleaned)) return null;\n    if (/^currentColor$/i.test(cleaned)) return null;\n    // hex\n    const hex = cleaned.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i)?.[0];\n    if (hex) return hex.toUpperCase();\n    // rgb/rgba\n    const asHex = rgbToHex(cleaned);\n    if (asHex) return asHex;\n    return null;\n}\n// Extract color candidates from CSS and inline styles for announcement bars and CTAs\nfunction extractColorCandidates($, baseCssTexts) {\n    const candidates = [];\n    const push = (source, color)=>{\n        const c = color && normalizeColor(color);\n        if (!c) return;\n        candidates.push({\n            source,\n            color: c\n        });\n    };\n    // From inline styles of announcement elements\n    $('[class*=\"announcement\" i], [class*=\"anouncement\" i]').each((_, el)=>{\n        const style = ($(el).attr(\"style\") || \"\").toString();\n        const mBg = style.match(/background(?:-color)?\\s*:\\s*([^;]+)/i);\n        if (mBg) push(\"announcement-bg\", mBg[1]);\n        const mBorder = style.match(/border(?:-color)?\\s*:\\s*([^;]+)/i);\n        if (mBorder) push(\"announcement-border\", mBorder[1]);\n    });\n    // Utility bar backgrounds\n    $('.utility-bar, [class*=\"utility-bar\" i]').each((_, el)=>{\n        const style = ($(el).attr(\"style\") || \"\").toString();\n        const mBg = style.match(/background(?:-color)?\\s*:\\s*([^;]+)/i);\n        if (mBg) push(\"utility-bar-bg\", mBg[1]);\n    });\n    // From inline styles of CTA-like elements\n    $('[class*=\"cta\" i], [class*=\"button\" i], [class*=\"btn\" i], [class*=\"add-to-cart\" i]').each((_, el)=>{\n        const style = ($(el).attr(\"style\") || \"\").toString();\n        const mBg = style.match(/background(?:-color)?\\s*:\\s*([^;]+)/i);\n        if (mBg) push(\"cta-bg\", mBg[1]);\n        const mBorder = style.match(/border(?:-color)?\\s*:\\s*([^;]+)/i);\n        if (mBorder) push(\"cta-border\", mBorder[1]);\n    });\n    // Explicit <button> elements\n    $(\"button\").each((_, el)=>{\n        const style = ($(el).attr(\"style\") || \"\").toString();\n        const mBg = style.match(/background(?:-color)?\\s*:\\s*([^;]+)/i);\n        if (mBg) push(\"button-bg\", mBg[1]);\n        const mBorder = style.match(/border(?:-color)?\\s*:\\s*([^;]+)/i);\n        if (mBorder) push(\"button-border\", mBorder[1]);\n    });\n    // Scan style tags for rules targeting announcement/cta classes\n    for (const css of baseCssTexts){\n        // announcement backgrounds\n        const reAnn = /\\.(?:[^\\.{\\s]*?(announcement|anouncement)[^\\s{]*)[^}]*\\{[^}]*?(background(?:-color)?):\\s*([^;}{]+);/ig;\n        let m;\n        while(m = reAnn.exec(css)){\n            push(\"announcement-bg\", m[2]);\n        }\n        // cta backgrounds\n        const reCtaBg = /\\.(?:[^\\.{\\s]*?(cta|button|btn)[^\\s{]*)[^}]*\\{[^}]*?(background(?:-color)?):\\s*([^;}{]+);/ig;\n        while(m = reCtaBg.exec(css)){\n            push(\"cta-bg\", m[2]);\n        }\n        // cta borders\n        const reCtaBorder = /\\.(?:[^\\.{\\s]*?(cta|button|btn)[^\\s{]*)[^}]*\\{[^}]*?(border(?:-color)?):\\s*([^;}{]+);/ig;\n        while(m = reCtaBorder.exec(css)){\n            push(\"cta-border\", m[2]);\n        }\n        // utility bar background\n        const reUtil = /\\.(?:[^\\.\\{\\s]*?(utility-bar)[^\\s{]*)[^}]*\\{[^}]*?(background(?:-color)?):\\s*([^;}{]+);/ig;\n        while(m = reUtil.exec(css)){\n            push(\"utility-bar-bg\", m[2]);\n        }\n        // button tag styles\n        const reButtonTag = /button\\s*\\{[^}]*?(background(?:-color)?):\\s*([^;}{]+);/ig;\n        while(m = reButtonTag.exec(css)){\n            push(\"button-bg\", m[1] || m[2]);\n        }\n    }\n    // Dedupe by color while preserving first occurrence\n    const seen = new Set();\n    return candidates.filter(({ color })=>seen.has(color) ? false : (seen.add(color), true));\n}\n// Extract --atlas-primary-color; fall back to meta theme-color\nfunction extractPrimaryAndText($) {\n    const styles = [];\n    $(\"style\").each((_, el)=>{\n        styles.push($(el).contents().text());\n    });\n    let primary = null;\n    for (const text of styles){\n        const m = text.match(/--atlas-primary-color\\s*:\\s*([^;\\n\\r]+)/i);\n        if (m && m[1]) {\n            primary = normalizeColor(m[1]);\n            if (primary) break;\n        }\n    }\n    const candidates = extractColorCandidates($, styles);\n    // theme-color as a low-priority candidate\n    const theme = $('meta[name=\"theme-color\"]').attr(\"content\");\n    const themeHex = theme ? normalizeColor(theme) : null;\n    if (themeHex) candidates.push({\n        source: \"theme-color\",\n        color: themeHex\n    });\n    // prefer atlas var, else announcement bg, cta bg, cta border, then theme\n    const preferred = primary || candidates[0]?.color || null;\n    // pick text color suggestion\n    let text = \"black\";\n    const hex = preferred || candidates[0]?.color || themeHex;\n    if (hex) {\n        // YIQ formula\n        const r = parseInt(hex.substring(1, 3), 16);\n        const g = parseInt(hex.substring(3, 5), 16);\n        const b = parseInt(hex.substring(5, 7), 16);\n        const yiq = (r * 299 + g * 587 + b * 114) / 1000;\n        text = yiq >= 128 ? \"black\" : \"white\";\n    }\n    return {\n        candidates,\n        primary: preferred || undefined,\n        text\n    };\n}\nfunction extractFonts($) {\n    const set = new Set();\n    $('link[rel=\"stylesheet\"][href*=\"fonts.googleapis.com\"]').each((_, el)=>{\n        const href = $(el).attr(\"href\") || \"\";\n        const url = new URL(href, \"https://example.com\");\n        const fam = url.searchParams.get(\"family\");\n        if (fam) {\n            fam.split(\"|\").forEach((chunk)=>set.add(chunk.split(\":\")[0].replace(/\\+/g, \" \")));\n        }\n    });\n    $(\"style\").each((_, el)=>{\n        const text = $(el).contents().text();\n        const matches = text.match(/font-family\\s*:\\s*([^;\\}]+)/gi) || [];\n        matches.forEach((m)=>{\n            const fam = m.split(\":\")[1]?.trim().replace(/[\"']/g, \"\").split(\",\")[0]?.trim();\n            if (fam) set.add(fam);\n        });\n    });\n    const blocked = new Set([\n        \"sans-serif\",\n        \"serif\",\n        \"monospace\",\n        \"cursive\",\n        \"fantasy\",\n        \"emoji\",\n        \"math\",\n        \"fangsong\",\n        \"system-ui\",\n        \"inherit\",\n        \"initial\",\n        \"unset\"\n    ]);\n    const cleaned = Array.from(set).filter((f)=>f && !/^var\\(/i.test(f) && !/^--/.test(f) && !blocked.has(f.toLowerCase())).slice(0, 5);\n    return cleaned;\n}\nfunction collectImages($, base, type) {\n    const results = [];\n    const regex = type === \"hero\" ? /(main|slideshow|hero|header)/i : /(banner)/i;\n    $(\"img\").each((_, el)=>{\n        const $el = $(el);\n        const cls = ($el.attr(\"class\") || \"\") + \" \" + ($el.parent().attr(\"class\") || \"\");\n        const id = ($el.attr(\"id\") || \"\") + \" \" + ($el.parent().attr(\"id\") || \"\");\n        if (!regex.test(cls + \" \" + id)) return;\n        let src = $el.attr(\"src\") || $el.attr(\"data-src\") || \"\";\n        src = absoluteUrl(base, src);\n        if (!src) return;\n        // width heuristic: attribute width or src hints like _600x\n        const wAttr = parseInt($el.attr(\"width\") || \"0\", 10);\n        const okByAttr = !isNaN(wAttr) && wAttr >= 599;\n        const okBySrc = /[_-](6\\d\\d|[7-9]\\d\\d|\\d{4,})x/i.test(src) || /w(=|%3D)(6\\d\\d|[7-9]\\d\\d|\\d{4,})/i.test(src);\n        if (okByAttr || okBySrc) {\n            results.push(src);\n        }\n    });\n    // Dedupe preserving order\n    return Array.from(new Set(results));\n}\nfunction collectMobileBannerImages($, base) {\n    const results = [];\n    // direct class on img\n    $('img.mobile-banner, img[class*=\"mobile-banner\"]').each((_, el)=>{\n        let src = $(el).attr(\"src\") || $(el).attr(\"data-src\") || \"\";\n        src = absoluteUrl(base, src);\n        if (src) results.push(src);\n    });\n    // nested within elements with class mobile-banner\n    $('.mobile-banner img, [class*=\"mobile-banner\"] img').each((_, el)=>{\n        let src = $(el).attr(\"src\") || $(el).attr(\"data-src\") || \"\";\n        src = absoluteUrl(base, src);\n        if (src) results.push(src);\n    });\n    return Array.from(new Set(results));\n}\nfunction extractStoreName($, baseUrl) {\n    const og = $('meta[property=\"og:site_name\"]').attr(\"content\");\n    if (og) return og;\n    const title = $(\"title\").first().text().trim();\n    if (title) return title;\n    try {\n        const host = new URL(baseUrl).hostname.replace(/^www\\./, \"\");\n        return host.split(\".\")[0];\n    } catch  {\n        return \"\";\n    }\n}\nfunction extractLogo($, base) {\n    // search any element whose class includes 'logo'\n    const logoContainers = $('[class*=\"logo\" i]').toArray();\n    for (const el of logoContainers){\n        const $el = $(el);\n        // inline svg inside\n        const svg = $el.find(\"svg\").first();\n        if (svg && svg.length) {\n            // grab outer HTML\n            const html = $.html(svg);\n            if (html) return {\n                svg: html\n            };\n        }\n        // image tag inside\n        const img = $el.find(\"img\").first();\n        if (img && img.length) {\n            let src = img.attr(\"src\") || img.attr(\"data-src\") || \"\";\n            src = absoluteUrl(base, src);\n            if (src) return {\n                url: src\n            };\n        }\n    }\n    // fallback: simple img with alt/class containing logo\n    const cand = $('img[alt*=\"logo\" i], img[class*=\"logo\" i]').first();\n    const fallback = cand.attr(\"src\") || cand.attr(\"data-src\") || \"\";\n    if (fallback) return {\n        url: absoluteUrl(base, fallback)\n    };\n    return {};\n}\nasync function handler(req, res) {\n    const { url } = req.query;\n    if (!url || typeof url !== \"string\") {\n        res.status(400).json({\n            error: \"Missing url parameter\"\n        });\n        return;\n    }\n    try {\n        const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(url, {\n            maxRedirects: 5,\n            headers: {\n                \"User-Agent\": \"Mozilla/5.0\"\n            }\n        });\n        const html = response.data;\n        const $ = cheerio__WEBPACK_IMPORTED_MODULE_1__.load(html);\n        const base = new URL(url).toString();\n        const product = await (0,_lib_parser__WEBPACK_IMPORTED_MODULE_2__.parseProduct)(url);\n        const storeName = extractStoreName($, url);\n        const logoObj = extractLogo($, url);\n        const heroImages = collectImages($, base, \"hero\");\n        // Prefer mobile-banner images on current page; then also try homepage and merge/dedupe\n        let bannerImages = collectMobileBannerImages($, base);\n        try {\n            const origin = new URL(base).origin;\n            const homeRes = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(origin, {\n                headers: {\n                    \"User-Agent\": \"Mozilla/5.0\"\n                },\n                maxRedirects: 5\n            });\n            const $home = cheerio__WEBPACK_IMPORTED_MODULE_1__.load(homeRes.data);\n            const homeBanners = collectMobileBannerImages($home, origin + \"/\");\n            bannerImages = Array.from(new Set([\n                ...bannerImages,\n                ...homeBanners\n            ]));\n        } catch (_) {\n        // ignore homepage fetch errors\n        }\n        if (bannerImages.length === 0) {\n            bannerImages = collectImages($, base, \"banner\");\n        }\n        const { candidates: colorCandidates, primary: primaryColor, text: textColor } = extractPrimaryAndText($);\n        // Extract announcement copy text if present\n        let announcementCopy = \"\";\n        const ann = $('[class*=\"announcement\" i], [class*=\"anouncement\" i]').first();\n        if (ann && ann.length) {\n            announcementCopy = (ann.text() || \"\").replace(/\\s+/g, \" \").trim();\n        }\n        const fontFamilies = extractFonts($);\n        const payload = {\n            storeName,\n            logo: logoObj.url,\n            logoSvg: logoObj.svg,\n            heroImages,\n            bannerImages,\n            colorScheme: primaryColor ? [\n                primaryColor\n            ] : [],\n            primaryColor,\n            textColor,\n            colorCandidates: colorCandidates,\n            fontFamilies,\n            announcementCopy,\n            product\n        };\n        res.status(200).json(payload);\n    } catch (err) {\n        console.error(\"Analyze error\", err.message || err);\n        res.status(500).json({\n            error: \"Failed to analyze page\"\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvYW5hbHl6ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQzBCO0FBQ1M7QUFDYTtBQWtCaEQsU0FBU0csWUFBWUMsSUFBWSxFQUFFQyxHQUFXO0lBQzVDLElBQUksQ0FBQ0EsS0FBSyxPQUFPO0lBQ2pCLElBQUlBLElBQUlDLFVBQVUsQ0FBQyxjQUFjRCxJQUFJQyxVQUFVLENBQUMsYUFBYSxPQUFPRDtJQUNwRSxJQUFJQSxJQUFJQyxVQUFVLENBQUMsT0FBTyxPQUFPLFdBQVdEO0lBQzVDLElBQUlBLElBQUlDLFVBQVUsQ0FBQyxNQUFNLE9BQU8sSUFBSUMsSUFBSUgsTUFBTUksTUFBTSxHQUFHSDtJQUN2RCxJQUFJO1FBQ0YsT0FBTyxJQUFJRSxJQUFJRixLQUFLRCxNQUFNSyxRQUFRO0lBQ3BDLEVBQUUsT0FBTTtRQUNOLE9BQU9KO0lBQ1Q7QUFDRjtBQUVBLFNBQVNLLFNBQVNDLEtBQWE7SUFDN0IsdURBQXVEO0lBQ3ZELE1BQU1DLElBQUlELE1BQU1FLEtBQUssQ0FBQztJQUN0QixJQUFJLENBQUNELEdBQUcsT0FBTztJQUNmLE1BQU1FLElBQUlDLEtBQUtDLEdBQUcsQ0FBQyxHQUFHRCxLQUFLRSxHQUFHLENBQUMsS0FBS0MsU0FBU04sQ0FBQyxDQUFDLEVBQUUsRUFBRTtJQUNuRCxNQUFNTyxJQUFJSixLQUFLQyxHQUFHLENBQUMsR0FBR0QsS0FBS0UsR0FBRyxDQUFDLEtBQUtDLFNBQVNOLENBQUMsQ0FBQyxFQUFFLEVBQUU7SUFDbkQsTUFBTVEsSUFBSUwsS0FBS0MsR0FBRyxDQUFDLEdBQUdELEtBQUtFLEdBQUcsQ0FBQyxLQUFLQyxTQUFTTixDQUFDLENBQUMsRUFBRSxFQUFFO0lBQ25ELE1BQU1TLFFBQVEsQ0FBQ0MsSUFBY0EsRUFBRWIsUUFBUSxDQUFDLElBQUljLFFBQVEsQ0FBQyxHQUFHLEtBQUtDLFdBQVc7SUFDeEUsT0FBTyxDQUFDLENBQUMsRUFBRUgsTUFBTVAsR0FBRyxFQUFFTyxNQUFNRixHQUFHLEVBQUVFLE1BQU1ELEdBQUcsQ0FBQztBQUM3QztBQUVBLFNBQVNLLGVBQWVDLEdBQVc7SUFDakMsSUFBSSxDQUFDQSxLQUFLLE9BQU87SUFDakIsTUFBTUMsVUFBVUQsSUFBSUUsSUFBSSxHQUFHQyxPQUFPLENBQUMsZUFBZSxJQUFJRCxJQUFJO0lBQzFELElBQUksVUFBVUUsSUFBSSxDQUFDSCxVQUFVLE9BQU87SUFDcEMsSUFBSSxpQkFBaUJHLElBQUksQ0FBQ0gsVUFBVSxPQUFPO0lBQzNDLElBQUksa0JBQWtCRyxJQUFJLENBQUNILFVBQVUsT0FBTztJQUM1QyxNQUFNO0lBQ04sTUFBTUksTUFBTUosUUFBUWQsS0FBSyxDQUFDLGtDQUFrQyxDQUFDLEVBQUU7SUFDL0QsSUFBSWtCLEtBQUssT0FBT0EsSUFBSVAsV0FBVztJQUMvQixXQUFXO0lBQ1gsTUFBTVEsUUFBUXRCLFNBQVNpQjtJQUN2QixJQUFJSyxPQUFPLE9BQU9BO0lBQ2xCLE9BQU87QUFDVDtBQUVBLHFGQUFxRjtBQUNyRixTQUFTQyx1QkFBdUJDLENBQXFCLEVBQUVDLFlBQXNCO0lBQzNFLE1BQU1DLGFBQWtELEVBQUU7SUFDMUQsTUFBTUMsT0FBTyxDQUFDQyxRQUFnQkM7UUFDNUIsTUFBTUMsSUFBSUQsU0FBU2QsZUFBZWM7UUFDbEMsSUFBSSxDQUFDQyxHQUFHO1FBQ1JKLFdBQVdDLElBQUksQ0FBQztZQUFFQztZQUFRQyxPQUFPQztRQUFFO0lBQ3JDO0lBQ0EsOENBQThDO0lBQzlDTixFQUFFLHVEQUF1RE8sSUFBSSxDQUFDLENBQUNDLEdBQUdDO1FBQ2hFLE1BQU1DLFFBQVEsQ0FBQ1YsRUFBRVMsSUFBSUUsSUFBSSxDQUFDLFlBQVksRUFBQyxFQUFHcEMsUUFBUTtRQUNsRCxNQUFNcUMsTUFBTUYsTUFBTS9CLEtBQUssQ0FBQztRQUN4QixJQUFJaUMsS0FBS1QsS0FBSyxtQkFBbUJTLEdBQUcsQ0FBQyxFQUFFO1FBQ3ZDLE1BQU1DLFVBQVVILE1BQU0vQixLQUFLLENBQUM7UUFDNUIsSUFBSWtDLFNBQVNWLEtBQUssdUJBQXVCVSxPQUFPLENBQUMsRUFBRTtJQUNyRDtJQUNBLDBCQUEwQjtJQUMxQmIsRUFBRSwwQ0FBMENPLElBQUksQ0FBQyxDQUFDQyxHQUFHQztRQUNuRCxNQUFNQyxRQUFRLENBQUNWLEVBQUVTLElBQUlFLElBQUksQ0FBQyxZQUFZLEVBQUMsRUFBR3BDLFFBQVE7UUFDbEQsTUFBTXFDLE1BQU1GLE1BQU0vQixLQUFLLENBQUM7UUFDeEIsSUFBSWlDLEtBQUtULEtBQUssa0JBQWtCUyxHQUFHLENBQUMsRUFBRTtJQUN4QztJQUNBLDBDQUEwQztJQUMxQ1osRUFBRSxxRkFBcUZPLElBQUksQ0FBQyxDQUFDQyxHQUFHQztRQUM5RixNQUFNQyxRQUFRLENBQUNWLEVBQUVTLElBQUlFLElBQUksQ0FBQyxZQUFZLEVBQUMsRUFBR3BDLFFBQVE7UUFDbEQsTUFBTXFDLE1BQU1GLE1BQU0vQixLQUFLLENBQUM7UUFDeEIsSUFBSWlDLEtBQUtULEtBQUssVUFBVVMsR0FBRyxDQUFDLEVBQUU7UUFDOUIsTUFBTUMsVUFBVUgsTUFBTS9CLEtBQUssQ0FBQztRQUM1QixJQUFJa0MsU0FBU1YsS0FBSyxjQUFjVSxPQUFPLENBQUMsRUFBRTtJQUM1QztJQUNBLDZCQUE2QjtJQUM3QmIsRUFBRSxVQUFVTyxJQUFJLENBQUMsQ0FBQ0MsR0FBR0M7UUFDbkIsTUFBTUMsUUFBUSxDQUFDVixFQUFFUyxJQUFJRSxJQUFJLENBQUMsWUFBWSxFQUFDLEVBQUdwQyxRQUFRO1FBQ2xELE1BQU1xQyxNQUFNRixNQUFNL0IsS0FBSyxDQUFDO1FBQ3hCLElBQUlpQyxLQUFLVCxLQUFLLGFBQWFTLEdBQUcsQ0FBQyxFQUFFO1FBQ2pDLE1BQU1DLFVBQVVILE1BQU0vQixLQUFLLENBQUM7UUFDNUIsSUFBSWtDLFNBQVNWLEtBQUssaUJBQWlCVSxPQUFPLENBQUMsRUFBRTtJQUMvQztJQUNBLCtEQUErRDtJQUMvRCxLQUFLLE1BQU1DLE9BQU9iLGFBQWM7UUFDOUIsMkJBQTJCO1FBQzNCLE1BQU1jLFFBQVE7UUFDZCxJQUFJckM7UUFDSixNQUFRQSxJQUFJcUMsTUFBTUMsSUFBSSxDQUFDRixLQUFPO1lBQzVCWCxLQUFLLG1CQUFtQnpCLENBQUMsQ0FBQyxFQUFFO1FBQzlCO1FBQ0Esa0JBQWtCO1FBQ2xCLE1BQU11QyxVQUFVO1FBQ2hCLE1BQVF2QyxJQUFJdUMsUUFBUUQsSUFBSSxDQUFDRixLQUFPO1lBQzlCWCxLQUFLLFVBQVV6QixDQUFDLENBQUMsRUFBRTtRQUNyQjtRQUNBLGNBQWM7UUFDZCxNQUFNd0MsY0FBYztRQUNwQixNQUFReEMsSUFBSXdDLFlBQVlGLElBQUksQ0FBQ0YsS0FBTztZQUNsQ1gsS0FBSyxjQUFjekIsQ0FBQyxDQUFDLEVBQUU7UUFDekI7UUFDQSx5QkFBeUI7UUFDekIsTUFBTXlDLFNBQVM7UUFDZixNQUFRekMsSUFBSXlDLE9BQU9ILElBQUksQ0FBQ0YsS0FBTztZQUM3QlgsS0FBSyxrQkFBa0J6QixDQUFDLENBQUMsRUFBRTtRQUM3QjtRQUNBLG9CQUFvQjtRQUNwQixNQUFNMEMsY0FBYztRQUNwQixNQUFRMUMsSUFBSTBDLFlBQVlKLElBQUksQ0FBQ0YsS0FBTztZQUNsQ1gsS0FBSyxhQUFhekIsQ0FBQyxDQUFDLEVBQUUsSUFBSUEsQ0FBQyxDQUFDLEVBQUU7UUFDaEM7SUFDRjtJQUNBLG9EQUFvRDtJQUNwRCxNQUFNMkMsT0FBTyxJQUFJQztJQUNqQixPQUFPcEIsV0FBV3FCLE1BQU0sQ0FBQyxDQUFDLEVBQUVsQixLQUFLLEVBQUUsR0FBTWdCLEtBQUtHLEdBQUcsQ0FBQ25CLFNBQVMsUUFBU2dCLENBQUFBLEtBQUtJLEdBQUcsQ0FBQ3BCLFFBQVEsSUFBRztBQUMxRjtBQUVBLCtEQUErRDtBQUMvRCxTQUFTcUIsc0JBQXNCMUIsQ0FBcUI7SUFDbEQsTUFBTTJCLFNBQW1CLEVBQUU7SUFDM0IzQixFQUFFLFNBQVNPLElBQUksQ0FBQyxDQUFDQyxHQUFHQztRQUNsQmtCLE9BQU94QixJQUFJLENBQUNILEVBQUVTLElBQUltQixRQUFRLEdBQUdDLElBQUk7SUFDbkM7SUFDQSxJQUFJQyxVQUF5QjtJQUM3QixLQUFLLE1BQU1ELFFBQVFGLE9BQVE7UUFDekIsTUFBTWpELElBQUltRCxLQUFLbEQsS0FBSyxDQUFDO1FBQ3JCLElBQUlELEtBQUtBLENBQUMsQ0FBQyxFQUFFLEVBQUU7WUFDYm9ELFVBQVV2QyxlQUFlYixDQUFDLENBQUMsRUFBRTtZQUM3QixJQUFJb0QsU0FBUztRQUNmO0lBQ0Y7SUFDQSxNQUFNNUIsYUFBYUgsdUJBQXVCQyxHQUFHMkI7SUFDN0MsMENBQTBDO0lBQzFDLE1BQU1JLFFBQVEvQixFQUFFLDRCQUE0QlcsSUFBSSxDQUFDO0lBQ2pELE1BQU1xQixXQUFXRCxRQUFReEMsZUFBZXdDLFNBQVM7SUFDakQsSUFBSUMsVUFBVTlCLFdBQVdDLElBQUksQ0FBQztRQUFFQyxRQUFRO1FBQWVDLE9BQU8yQjtJQUFTO0lBQ3ZFLHlFQUF5RTtJQUN6RSxNQUFNQyxZQUFZSCxXQUFZNUIsVUFBVSxDQUFDLEVBQUUsRUFBRUcsU0FBUztJQUN0RCw2QkFBNkI7SUFDN0IsSUFBSXdCLE9BQTBCO0lBQzlCLE1BQU1oQyxNQUFNb0MsYUFBYS9CLFVBQVUsQ0FBQyxFQUFFLEVBQUVHLFNBQVMyQjtJQUNqRCxJQUFJbkMsS0FBSztRQUNQLGNBQWM7UUFDZCxNQUFNakIsSUFBSUksU0FBU2EsSUFBSXFDLFNBQVMsQ0FBQyxHQUFHLElBQUk7UUFDeEMsTUFBTWpELElBQUlELFNBQVNhLElBQUlxQyxTQUFTLENBQUMsR0FBRyxJQUFJO1FBQ3hDLE1BQU1oRCxJQUFJRixTQUFTYSxJQUFJcUMsU0FBUyxDQUFDLEdBQUcsSUFBSTtRQUN4QyxNQUFNQyxNQUFNLENBQUN2RCxJQUFJLE1BQU1LLElBQUksTUFBTUMsSUFBSSxHQUFFLElBQUs7UUFDNUMyQyxPQUFPTSxPQUFPLE1BQU0sVUFBVTtJQUNoQztJQUNBLE9BQU87UUFBRWpDO1FBQVk0QixTQUFTRyxhQUFhRztRQUFXUDtJQUFLO0FBQzdEO0FBRUEsU0FBU1EsYUFBYXJDLENBQXFCO0lBQ3pDLE1BQU1zQyxNQUFNLElBQUloQjtJQUNoQnRCLEVBQUUsd0RBQXdETyxJQUFJLENBQUMsQ0FBQ0MsR0FBR0M7UUFDakUsTUFBTThCLE9BQU92QyxFQUFFUyxJQUFJRSxJQUFJLENBQUMsV0FBVztRQUNuQyxNQUFNeEMsTUFBTSxJQUFJRSxJQUFJa0UsTUFBTTtRQUMxQixNQUFNQyxNQUFNckUsSUFBSXNFLFlBQVksQ0FBQ0MsR0FBRyxDQUFDO1FBQ2pDLElBQUlGLEtBQUs7WUFDUEEsSUFBSUcsS0FBSyxDQUFDLEtBQUtDLE9BQU8sQ0FBQyxDQUFDQyxRQUFVUCxJQUFJYixHQUFHLENBQUNvQixNQUFNRixLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQ2hELE9BQU8sQ0FBQyxPQUFPO1FBQy9FO0lBQ0Y7SUFDQUssRUFBRSxTQUFTTyxJQUFJLENBQUMsQ0FBQ0MsR0FBR0M7UUFDbEIsTUFBTW9CLE9BQU83QixFQUFFUyxJQUFJbUIsUUFBUSxHQUFHQyxJQUFJO1FBQ2xDLE1BQU1pQixVQUFVakIsS0FBS2xELEtBQUssQ0FBQyxvQ0FBb0MsRUFBRTtRQUNqRW1FLFFBQVFGLE9BQU8sQ0FBQyxDQUFDbEU7WUFDZixNQUFNOEQsTUFBTTlELEVBQUVpRSxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRWpELE9BQU9DLFFBQVEsU0FBUyxJQUFJZ0QsTUFBTSxJQUFJLENBQUMsRUFBRSxFQUFFakQ7WUFDeEUsSUFBSThDLEtBQUtGLElBQUliLEdBQUcsQ0FBQ2U7UUFDbkI7SUFDRjtJQUNBLE1BQU1PLFVBQVUsSUFBSXpCLElBQUk7UUFBQztRQUFhO1FBQVE7UUFBWTtRQUFVO1FBQVU7UUFBUTtRQUFPO1FBQVc7UUFBWTtRQUFVO1FBQVU7S0FBUTtJQUNoSixNQUFNN0IsVUFBVXVELE1BQU1DLElBQUksQ0FBQ1gsS0FDeEJmLE1BQU0sQ0FBQzJCLENBQUFBLElBQUtBLEtBQUssQ0FBQyxVQUFVdEQsSUFBSSxDQUFDc0QsTUFBTSxDQUFDLE1BQU10RCxJQUFJLENBQUNzRCxNQUFNLENBQUNILFFBQVF2QixHQUFHLENBQUMwQixFQUFFQyxXQUFXLEtBQ25GQyxLQUFLLENBQUMsR0FBRztJQUNaLE9BQU8zRDtBQUNUO0FBRUEsU0FBUzRELGNBQWNyRCxDQUFxQixFQUFFOUIsSUFBWSxFQUFFb0YsSUFBdUI7SUFDakYsTUFBTUMsVUFBb0IsRUFBRTtJQUM1QixNQUFNQyxRQUFRRixTQUFTLFNBQVMsa0NBQWtDO0lBQ2xFdEQsRUFBRSxPQUFPTyxJQUFJLENBQUMsQ0FBQ0MsR0FBR0M7UUFDaEIsTUFBTWdELE1BQU16RCxFQUFFUztRQUNkLE1BQU1pRCxNQUFNLENBQUNELElBQUk5QyxJQUFJLENBQUMsWUFBWSxFQUFDLElBQUssTUFBTzhDLENBQUFBLElBQUlFLE1BQU0sR0FBR2hELElBQUksQ0FBQyxZQUFZLEVBQUM7UUFDOUUsTUFBTWlELEtBQUssQ0FBQ0gsSUFBSTlDLElBQUksQ0FBQyxTQUFTLEVBQUMsSUFBSyxNQUFPOEMsQ0FBQUEsSUFBSUUsTUFBTSxHQUFHaEQsSUFBSSxDQUFDLFNBQVMsRUFBQztRQUN2RSxJQUFJLENBQUM2QyxNQUFNNUQsSUFBSSxDQUFDOEQsTUFBTSxNQUFNRSxLQUFLO1FBQ2pDLElBQUlDLE1BQU1KLElBQUk5QyxJQUFJLENBQUMsVUFBVThDLElBQUk5QyxJQUFJLENBQUMsZUFBZTtRQUNyRGtELE1BQU01RixZQUFZQyxNQUFNMkY7UUFDeEIsSUFBSSxDQUFDQSxLQUFLO1FBQ1YsMkRBQTJEO1FBQzNELE1BQU1DLFFBQVE5RSxTQUFTeUUsSUFBSTlDLElBQUksQ0FBQyxZQUFZLEtBQUs7UUFDakQsTUFBTW9ELFdBQVcsQ0FBQ0MsTUFBTUYsVUFBVUEsU0FBUztRQUMzQyxNQUFNRyxVQUFVLGlDQUFpQ3JFLElBQUksQ0FBQ2lFLFFBQVEsb0NBQW9DakUsSUFBSSxDQUFDaUU7UUFDdkcsSUFBSUUsWUFBWUUsU0FBUztZQUN2QlYsUUFBUXBELElBQUksQ0FBQzBEO1FBQ2Y7SUFDRjtJQUNBLDBCQUEwQjtJQUMxQixPQUFPYixNQUFNQyxJQUFJLENBQUMsSUFBSTNCLElBQUlpQztBQUM1QjtBQUVBLFNBQVNXLDBCQUEwQmxFLENBQXFCLEVBQUU5QixJQUFZO0lBQ3BFLE1BQU1xRixVQUFvQixFQUFFO0lBQzVCLHNCQUFzQjtJQUN0QnZELEVBQUUsa0RBQWtETyxJQUFJLENBQUMsQ0FBQ0MsR0FBR0M7UUFDM0QsSUFBSW9ELE1BQU03RCxFQUFFUyxJQUFJRSxJQUFJLENBQUMsVUFBVVgsRUFBRVMsSUFBSUUsSUFBSSxDQUFDLGVBQWU7UUFDekRrRCxNQUFNNUYsWUFBWUMsTUFBTTJGO1FBQ3hCLElBQUlBLEtBQUtOLFFBQVFwRCxJQUFJLENBQUMwRDtJQUN4QjtJQUNBLGtEQUFrRDtJQUNsRDdELEVBQUUsb0RBQW9ETyxJQUFJLENBQUMsQ0FBQ0MsR0FBR0M7UUFDN0QsSUFBSW9ELE1BQU03RCxFQUFFUyxJQUFJRSxJQUFJLENBQUMsVUFBVVgsRUFBRVMsSUFBSUUsSUFBSSxDQUFDLGVBQWU7UUFDekRrRCxNQUFNNUYsWUFBWUMsTUFBTTJGO1FBQ3hCLElBQUlBLEtBQUtOLFFBQVFwRCxJQUFJLENBQUMwRDtJQUN4QjtJQUNBLE9BQU9iLE1BQU1DLElBQUksQ0FBQyxJQUFJM0IsSUFBSWlDO0FBQzVCO0FBRUEsU0FBU1ksaUJBQWlCbkUsQ0FBcUIsRUFBRW9FLE9BQWU7SUFDOUQsTUFBTUMsS0FBS3JFLEVBQUUsaUNBQWlDVyxJQUFJLENBQUM7SUFDbkQsSUFBSTBELElBQUksT0FBT0E7SUFDZixNQUFNQyxRQUFRdEUsRUFBRSxTQUFTdUUsS0FBSyxHQUFHMUMsSUFBSSxHQUFHbkMsSUFBSTtJQUM1QyxJQUFJNEUsT0FBTyxPQUFPQTtJQUNsQixJQUFJO1FBQ0YsTUFBTUUsT0FBTyxJQUFJbkcsSUFBSStGLFNBQVNLLFFBQVEsQ0FBQzlFLE9BQU8sQ0FBQyxVQUFVO1FBQ3pELE9BQU82RSxLQUFLN0IsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFO0lBQzNCLEVBQUUsT0FBTTtRQUNOLE9BQU87SUFDVDtBQUNGO0FBRUEsU0FBUytCLFlBQVkxRSxDQUFxQixFQUFFOUIsSUFBWTtJQUN0RCxpREFBaUQ7SUFDakQsTUFBTXlHLGlCQUFpQjNFLEVBQUUscUJBQXFCNEUsT0FBTztJQUNyRCxLQUFLLE1BQU1uRSxNQUFNa0UsZUFBZ0I7UUFDL0IsTUFBTWxCLE1BQU16RCxFQUFFUztRQUNkLG9CQUFvQjtRQUNwQixNQUFNb0UsTUFBTXBCLElBQUlxQixJQUFJLENBQUMsT0FBT1AsS0FBSztRQUNqQyxJQUFJTSxPQUFPQSxJQUFJRSxNQUFNLEVBQUU7WUFDckIsa0JBQWtCO1lBQ2xCLE1BQU1DLE9BQU9oRixFQUFFZ0YsSUFBSSxDQUFDSDtZQUNwQixJQUFJRyxNQUFNLE9BQU87Z0JBQUVILEtBQUtHO1lBQUs7UUFDL0I7UUFDQSxtQkFBbUI7UUFDbkIsTUFBTUMsTUFBTXhCLElBQUlxQixJQUFJLENBQUMsT0FBT1AsS0FBSztRQUNqQyxJQUFJVSxPQUFPQSxJQUFJRixNQUFNLEVBQUU7WUFDckIsSUFBSWxCLE1BQU1vQixJQUFJdEUsSUFBSSxDQUFDLFVBQVVzRSxJQUFJdEUsSUFBSSxDQUFDLGVBQWU7WUFDckRrRCxNQUFNNUYsWUFBWUMsTUFBTTJGO1lBQ3hCLElBQUlBLEtBQUssT0FBTztnQkFBRTFGLEtBQUswRjtZQUFJO1FBQzdCO0lBQ0Y7SUFDQSxzREFBc0Q7SUFDdEQsTUFBTXFCLE9BQU9sRixFQUFFLDRDQUE0Q3VFLEtBQUs7SUFDaEUsTUFBTVksV0FBV0QsS0FBS3ZFLElBQUksQ0FBQyxVQUFVdUUsS0FBS3ZFLElBQUksQ0FBQyxlQUFlO0lBQzlELElBQUl3RSxVQUFVLE9BQU87UUFBRWhILEtBQUtGLFlBQVlDLE1BQU1pSDtJQUFVO0lBQ3hELE9BQU8sQ0FBQztBQUNWO0FBRWUsZUFBZUMsUUFBUUMsR0FBbUIsRUFBRUMsR0FBb0I7SUFDN0UsTUFBTSxFQUFFbkgsR0FBRyxFQUFFLEdBQUdrSCxJQUFJRSxLQUFLO0lBQ3pCLElBQUksQ0FBQ3BILE9BQU8sT0FBT0EsUUFBUSxVQUFVO1FBQ25DbUgsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQXdCO1FBQ3REO0lBQ0Y7SUFDQSxJQUFJO1FBQ0YsTUFBTUMsV0FBVyxNQUFNN0gsaURBQVMsQ0FBQ0ssS0FBSztZQUFFeUgsY0FBYztZQUFHQyxTQUFTO2dCQUFFLGNBQWM7WUFBYztRQUFFO1FBQ2xHLE1BQU1iLE9BQU9XLFNBQVNHLElBQUk7UUFDMUIsTUFBTTlGLElBQUlqQyx5Q0FBWSxDQUFDaUg7UUFDdkIsTUFBTTlHLE9BQU8sSUFBSUcsSUFBSUYsS0FBS0ksUUFBUTtRQUVsQyxNQUFNeUgsVUFBVSxNQUFNaEkseURBQVlBLENBQUNHO1FBQ25DLE1BQU04SCxZQUFZOUIsaUJBQWlCbkUsR0FBRzdCO1FBQ3RDLE1BQU0rSCxVQUFVeEIsWUFBWTFFLEdBQUc3QjtRQUMvQixNQUFNZ0ksYUFBYTlDLGNBQWNyRCxHQUFHOUIsTUFBTTtRQUMxQyx1RkFBdUY7UUFDdkYsSUFBSWtJLGVBQWVsQywwQkFBMEJsRSxHQUFHOUI7UUFDaEQsSUFBSTtZQUNGLE1BQU1JLFNBQVMsSUFBSUQsSUFBSUgsTUFBTUksTUFBTTtZQUNuQyxNQUFNK0gsVUFBVSxNQUFNdkksaURBQVMsQ0FBQ1EsUUFBUTtnQkFBRXVILFNBQVM7b0JBQUUsY0FBYztnQkFBYztnQkFBR0QsY0FBYztZQUFFO1lBQ3BHLE1BQU1VLFFBQVF2SSx5Q0FBWSxDQUFDc0ksUUFBUVAsSUFBSTtZQUN2QyxNQUFNUyxjQUFjckMsMEJBQTBCb0MsT0FBT2hJLFNBQVM7WUFDOUQ4SCxlQUFlcEQsTUFBTUMsSUFBSSxDQUFDLElBQUkzQixJQUFJO21CQUFJOEU7bUJBQWlCRzthQUFZO1FBQ3JFLEVBQUUsT0FBTy9GLEdBQUc7UUFDViwrQkFBK0I7UUFDakM7UUFDQSxJQUFJNEYsYUFBYXJCLE1BQU0sS0FBSyxHQUFHO1lBQzdCcUIsZUFBZS9DLGNBQWNyRCxHQUFHOUIsTUFBTTtRQUN4QztRQUNBLE1BQU0sRUFBRWdDLFlBQVlzRyxlQUFlLEVBQUUxRSxTQUFTMkUsWUFBWSxFQUFFNUUsTUFBTTZFLFNBQVMsRUFBRSxHQUFHaEYsc0JBQXNCMUI7UUFDdEcsNENBQTRDO1FBQzVDLElBQUkyRyxtQkFBbUI7UUFDdkIsTUFBTUMsTUFBTTVHLEVBQUUsdURBQXVEdUUsS0FBSztRQUMxRSxJQUFJcUMsT0FBT0EsSUFBSTdCLE1BQU0sRUFBRTtZQUNyQjRCLG1CQUFtQixDQUFDQyxJQUFJL0UsSUFBSSxNQUFNLEVBQUMsRUFBR2xDLE9BQU8sQ0FBQyxRQUFPLEtBQUtELElBQUk7UUFDaEU7UUFDQSxNQUFNbUgsZUFBZXhFLGFBQWFyQztRQUVsQyxNQUFNOEcsVUFBMkI7WUFDL0JiO1lBQ0FjLE1BQU1iLFFBQVEvSCxHQUFHO1lBQ2pCNkksU0FBU2QsUUFBUXJCLEdBQUc7WUFDcEJzQjtZQUNBQztZQUNBYSxhQUFhUixlQUFlO2dCQUFDQTthQUFhLEdBQUcsRUFBRTtZQUMvQ0E7WUFDQUM7WUFDQUYsaUJBQWlCQTtZQUNqQks7WUFDQUY7WUFDQVg7UUFDRjtRQUNBVixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDcUI7SUFDdkIsRUFBRSxPQUFPSSxLQUFVO1FBQ2pCQyxRQUFRekIsS0FBSyxDQUFDLGlCQUFpQndCLElBQUlFLE9BQU8sSUFBSUY7UUFDOUM1QixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBeUI7SUFDekQ7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2VkbS1idWlsZGVyLy4vcGFnZXMvYXBpL2FuYWx5emUudHM/OGIwMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XG5pbXBvcnQgKiBhcyBjaGVlcmlvIGZyb20gJ2NoZWVyaW8nO1xuaW1wb3J0IHsgcGFyc2VQcm9kdWN0IH0gZnJvbSAnLi4vLi4vbGliL3BhcnNlcic7XG5cbnR5cGUgQW5hbHl6ZVJlc3BvbnNlID0ge1xuICBzdG9yZU5hbWU6IHN0cmluZztcbiAgbG9nbz86IHN0cmluZzsgLy8gaW1hZ2UgVVJMIGlmIGF2YWlsYWJsZVxuICBsb2dvU3ZnPzogc3RyaW5nOyAvLyBpbmxpbmUgU1ZHIG1hcmt1cCBpZiBhdmFpbGFibGVcbiAgaGVyb0ltYWdlczogc3RyaW5nW107XG4gIGJhbm5lckltYWdlczogc3RyaW5nW107XG4gIC8vIERlcHJlY2F0ZWQ6IHVzZSBwcmltYXJ5Q29sb3IvdGV4dENvbG9yOyBrZWVwIGZvciBiYWNrd2FyZCBjb21wYXRcbiAgY29sb3JTY2hlbWU/OiBzdHJpbmdbXTsgLy8gW3ByaW1hcnldXG4gIHByaW1hcnlDb2xvcj86IHN0cmluZztcbiAgdGV4dENvbG9yPzogJ2JsYWNrJyB8ICd3aGl0ZSc7XG4gIGNvbG9yQ2FuZGlkYXRlcz86IHsgc291cmNlOiBzdHJpbmc7IGNvbG9yOiBzdHJpbmcgfVtdO1xuICBmb250RmFtaWxpZXM6IHN0cmluZ1tdO1xuICBhbm5vdW5jZW1lbnRDb3B5Pzogc3RyaW5nO1xuICBwcm9kdWN0OiBhbnk7IC8vIHJldXNlIFByb2R1Y3REYXRhIHNoYXBlIGZyb20gbGliL3R5cGVzIG9uIGNsaWVudFxufTtcblxuZnVuY3Rpb24gYWJzb2x1dGVVcmwoYmFzZTogc3RyaW5nLCB1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gIGlmICghdXJsKSByZXR1cm4gJyc7XG4gIGlmICh1cmwuc3RhcnRzV2l0aCgnaHR0cDovLycpIHx8IHVybC5zdGFydHNXaXRoKCdodHRwczovLycpKSByZXR1cm4gdXJsO1xuICBpZiAodXJsLnN0YXJ0c1dpdGgoJy8vJykpIHJldHVybiAnaHR0cHM6JyArIHVybDtcbiAgaWYgKHVybC5zdGFydHNXaXRoKCcvJykpIHJldHVybiBuZXcgVVJMKGJhc2UpLm9yaWdpbiArIHVybDtcbiAgdHJ5IHtcbiAgICByZXR1cm4gbmV3IFVSTCh1cmwsIGJhc2UpLnRvU3RyaW5nKCk7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiB1cmw7XG4gIH1cbn1cblxuZnVuY3Rpb24gcmdiVG9IZXgoaW5wdXQ6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xuICAvLyBzdXBwb3J0cyByZ2IoYSkgbGlrZSByZ2IoMjU1LDAsMCkgb3IgcmdiYSgyNTUsMCwwLDEpXG4gIGNvbnN0IG0gPSBpbnB1dC5tYXRjaCgvcmdiYT9cXChcXHMqKFxcZHsxLDN9KVxccyosXFxzKihcXGR7MSwzfSlcXHMqLFxccyooXFxkezEsM30pL2kpO1xuICBpZiAoIW0pIHJldHVybiBudWxsO1xuICBjb25zdCByID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMjU1LCBwYXJzZUludChtWzFdLCAxMCkpKTtcbiAgY29uc3QgZyA9IE1hdGgubWF4KDAsIE1hdGgubWluKDI1NSwgcGFyc2VJbnQobVsyXSwgMTApKSk7XG4gIGNvbnN0IGIgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigyNTUsIHBhcnNlSW50KG1bM10sIDEwKSkpO1xuICBjb25zdCB0b0hleCA9IChuOiBudW1iZXIpID0+IG4udG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICcwJykudG9VcHBlckNhc2UoKTtcbiAgcmV0dXJuIGAjJHt0b0hleChyKX0ke3RvSGV4KGcpfSR7dG9IZXgoYil9YDtcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplQ29sb3IodmFsOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgaWYgKCF2YWwpIHJldHVybiBudWxsO1xuICBjb25zdCBjbGVhbmVkID0gdmFsLnRyaW0oKS5yZXBsYWNlKC8haW1wb3J0YW50L2ksICcnKS50cmltKCk7XG4gIGlmICgvXnZhclxcKC9pLnRlc3QoY2xlYW5lZCkpIHJldHVybiBudWxsO1xuICBpZiAoL150cmFuc3BhcmVudCQvaS50ZXN0KGNsZWFuZWQpKSByZXR1cm4gbnVsbDtcbiAgaWYgKC9eY3VycmVudENvbG9yJC9pLnRlc3QoY2xlYW5lZCkpIHJldHVybiBudWxsO1xuICAvLyBoZXhcbiAgY29uc3QgaGV4ID0gY2xlYW5lZC5tYXRjaCgvXiMoWzAtOWEtZl17M318WzAtOWEtZl17Nn0pJC9pKT8uWzBdO1xuICBpZiAoaGV4KSByZXR1cm4gaGV4LnRvVXBwZXJDYXNlKCk7XG4gIC8vIHJnYi9yZ2JhXG4gIGNvbnN0IGFzSGV4ID0gcmdiVG9IZXgoY2xlYW5lZCk7XG4gIGlmIChhc0hleCkgcmV0dXJuIGFzSGV4O1xuICByZXR1cm4gbnVsbDtcbn1cblxuLy8gRXh0cmFjdCBjb2xvciBjYW5kaWRhdGVzIGZyb20gQ1NTIGFuZCBpbmxpbmUgc3R5bGVzIGZvciBhbm5vdW5jZW1lbnQgYmFycyBhbmQgQ1RBc1xuZnVuY3Rpb24gZXh0cmFjdENvbG9yQ2FuZGlkYXRlcygkOiBjaGVlcmlvLkNoZWVyaW9BUEksIGJhc2VDc3NUZXh0czogc3RyaW5nW10pOiB7IHNvdXJjZTogc3RyaW5nOyBjb2xvcjogc3RyaW5nIH1bXSB7XG4gIGNvbnN0IGNhbmRpZGF0ZXM6IHsgc291cmNlOiBzdHJpbmc7IGNvbG9yOiBzdHJpbmcgfVtdID0gW107XG4gIGNvbnN0IHB1c2ggPSAoc291cmNlOiBzdHJpbmcsIGNvbG9yPzogc3RyaW5nIHwgbnVsbCkgPT4ge1xuICAgIGNvbnN0IGMgPSBjb2xvciAmJiBub3JtYWxpemVDb2xvcihjb2xvcik7XG4gICAgaWYgKCFjKSByZXR1cm47XG4gICAgY2FuZGlkYXRlcy5wdXNoKHsgc291cmNlLCBjb2xvcjogYyB9KTtcbiAgfTtcbiAgLy8gRnJvbSBpbmxpbmUgc3R5bGVzIG9mIGFubm91bmNlbWVudCBlbGVtZW50c1xuICAkKCdbY2xhc3MqPVwiYW5ub3VuY2VtZW50XCIgaV0sIFtjbGFzcyo9XCJhbm91bmNlbWVudFwiIGldJykuZWFjaCgoXywgZWwpID0+IHtcbiAgICBjb25zdCBzdHlsZSA9ICgkKGVsKS5hdHRyKCdzdHlsZScpIHx8ICcnKS50b1N0cmluZygpO1xuICAgIGNvbnN0IG1CZyA9IHN0eWxlLm1hdGNoKC9iYWNrZ3JvdW5kKD86LWNvbG9yKT9cXHMqOlxccyooW147XSspL2kpO1xuICAgIGlmIChtQmcpIHB1c2goJ2Fubm91bmNlbWVudC1iZycsIG1CZ1sxXSk7XG4gICAgY29uc3QgbUJvcmRlciA9IHN0eWxlLm1hdGNoKC9ib3JkZXIoPzotY29sb3IpP1xccyo6XFxzKihbXjtdKykvaSk7XG4gICAgaWYgKG1Cb3JkZXIpIHB1c2goJ2Fubm91bmNlbWVudC1ib3JkZXInLCBtQm9yZGVyWzFdKTtcbiAgfSk7XG4gIC8vIFV0aWxpdHkgYmFyIGJhY2tncm91bmRzXG4gICQoJy51dGlsaXR5LWJhciwgW2NsYXNzKj1cInV0aWxpdHktYmFyXCIgaV0nKS5lYWNoKChfLCBlbCkgPT4ge1xuICAgIGNvbnN0IHN0eWxlID0gKCQoZWwpLmF0dHIoJ3N0eWxlJykgfHwgJycpLnRvU3RyaW5nKCk7XG4gICAgY29uc3QgbUJnID0gc3R5bGUubWF0Y2goL2JhY2tncm91bmQoPzotY29sb3IpP1xccyo6XFxzKihbXjtdKykvaSk7XG4gICAgaWYgKG1CZykgcHVzaCgndXRpbGl0eS1iYXItYmcnLCBtQmdbMV0pO1xuICB9KTtcbiAgLy8gRnJvbSBpbmxpbmUgc3R5bGVzIG9mIENUQS1saWtlIGVsZW1lbnRzXG4gICQoJ1tjbGFzcyo9XCJjdGFcIiBpXSwgW2NsYXNzKj1cImJ1dHRvblwiIGldLCBbY2xhc3MqPVwiYnRuXCIgaV0sIFtjbGFzcyo9XCJhZGQtdG8tY2FydFwiIGldJykuZWFjaCgoXywgZWwpID0+IHtcbiAgICBjb25zdCBzdHlsZSA9ICgkKGVsKS5hdHRyKCdzdHlsZScpIHx8ICcnKS50b1N0cmluZygpO1xuICAgIGNvbnN0IG1CZyA9IHN0eWxlLm1hdGNoKC9iYWNrZ3JvdW5kKD86LWNvbG9yKT9cXHMqOlxccyooW147XSspL2kpO1xuICAgIGlmIChtQmcpIHB1c2goJ2N0YS1iZycsIG1CZ1sxXSk7XG4gICAgY29uc3QgbUJvcmRlciA9IHN0eWxlLm1hdGNoKC9ib3JkZXIoPzotY29sb3IpP1xccyo6XFxzKihbXjtdKykvaSk7XG4gICAgaWYgKG1Cb3JkZXIpIHB1c2goJ2N0YS1ib3JkZXInLCBtQm9yZGVyWzFdKTtcbiAgfSk7XG4gIC8vIEV4cGxpY2l0IDxidXR0b24+IGVsZW1lbnRzXG4gICQoJ2J1dHRvbicpLmVhY2goKF8sIGVsKSA9PiB7XG4gICAgY29uc3Qgc3R5bGUgPSAoJChlbCkuYXR0cignc3R5bGUnKSB8fCAnJykudG9TdHJpbmcoKTtcbiAgICBjb25zdCBtQmcgPSBzdHlsZS5tYXRjaCgvYmFja2dyb3VuZCg/Oi1jb2xvcik/XFxzKjpcXHMqKFteO10rKS9pKTtcbiAgICBpZiAobUJnKSBwdXNoKCdidXR0b24tYmcnLCBtQmdbMV0pO1xuICAgIGNvbnN0IG1Cb3JkZXIgPSBzdHlsZS5tYXRjaCgvYm9yZGVyKD86LWNvbG9yKT9cXHMqOlxccyooW147XSspL2kpO1xuICAgIGlmIChtQm9yZGVyKSBwdXNoKCdidXR0b24tYm9yZGVyJywgbUJvcmRlclsxXSk7XG4gIH0pO1xuICAvLyBTY2FuIHN0eWxlIHRhZ3MgZm9yIHJ1bGVzIHRhcmdldGluZyBhbm5vdW5jZW1lbnQvY3RhIGNsYXNzZXNcbiAgZm9yIChjb25zdCBjc3Mgb2YgYmFzZUNzc1RleHRzKSB7XG4gICAgLy8gYW5ub3VuY2VtZW50IGJhY2tncm91bmRzXG4gICAgY29uc3QgcmVBbm4gPSAvXFwuKD86W15cXC57XFxzXSo/KGFubm91bmNlbWVudHxhbm91bmNlbWVudClbXlxcc3tdKilbXn1dKlxce1tefV0qPyhiYWNrZ3JvdW5kKD86LWNvbG9yKT8pOlxccyooW147fXtdKyk7L2lnO1xuICAgIGxldCBtOiBSZWdFeHBFeGVjQXJyYXkgfCBudWxsO1xuICAgIHdoaWxlICgobSA9IHJlQW5uLmV4ZWMoY3NzKSkpIHtcbiAgICAgIHB1c2goJ2Fubm91bmNlbWVudC1iZycsIG1bMl0pO1xuICAgIH1cbiAgICAvLyBjdGEgYmFja2dyb3VuZHNcbiAgICBjb25zdCByZUN0YUJnID0gL1xcLig/OlteXFwue1xcc10qPyhjdGF8YnV0dG9ufGJ0bilbXlxcc3tdKilbXn1dKlxce1tefV0qPyhiYWNrZ3JvdW5kKD86LWNvbG9yKT8pOlxccyooW147fXtdKyk7L2lnO1xuICAgIHdoaWxlICgobSA9IHJlQ3RhQmcuZXhlYyhjc3MpKSkge1xuICAgICAgcHVzaCgnY3RhLWJnJywgbVsyXSk7XG4gICAgfVxuICAgIC8vIGN0YSBib3JkZXJzXG4gICAgY29uc3QgcmVDdGFCb3JkZXIgPSAvXFwuKD86W15cXC57XFxzXSo/KGN0YXxidXR0b258YnRuKVteXFxze10qKVtefV0qXFx7W159XSo/KGJvcmRlcig/Oi1jb2xvcik/KTpcXHMqKFteO317XSspOy9pZztcbiAgICB3aGlsZSAoKG0gPSByZUN0YUJvcmRlci5leGVjKGNzcykpKSB7XG4gICAgICBwdXNoKCdjdGEtYm9yZGVyJywgbVsyXSk7XG4gICAgfVxuICAgIC8vIHV0aWxpdHkgYmFyIGJhY2tncm91bmRcbiAgICBjb25zdCByZVV0aWwgPSAvXFwuKD86W15cXC5cXHtcXHNdKj8odXRpbGl0eS1iYXIpW15cXHN7XSopW159XSpcXHtbXn1dKj8oYmFja2dyb3VuZCg/Oi1jb2xvcik/KTpcXHMqKFteO317XSspOy9pZztcbiAgICB3aGlsZSAoKG0gPSByZVV0aWwuZXhlYyhjc3MpKSkge1xuICAgICAgcHVzaCgndXRpbGl0eS1iYXItYmcnLCBtWzJdKTtcbiAgICB9XG4gICAgLy8gYnV0dG9uIHRhZyBzdHlsZXNcbiAgICBjb25zdCByZUJ1dHRvblRhZyA9IC9idXR0b25cXHMqXFx7W159XSo/KGJhY2tncm91bmQoPzotY29sb3IpPyk6XFxzKihbXjt9e10rKTsvaWc7XG4gICAgd2hpbGUgKChtID0gcmVCdXR0b25UYWcuZXhlYyhjc3MpKSkge1xuICAgICAgcHVzaCgnYnV0dG9uLWJnJywgbVsxXSB8fCBtWzJdKTtcbiAgICB9XG4gIH1cbiAgLy8gRGVkdXBlIGJ5IGNvbG9yIHdoaWxlIHByZXNlcnZpbmcgZmlyc3Qgb2NjdXJyZW5jZVxuICBjb25zdCBzZWVuID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gIHJldHVybiBjYW5kaWRhdGVzLmZpbHRlcigoeyBjb2xvciB9KSA9PiAoc2Vlbi5oYXMoY29sb3IpID8gZmFsc2UgOiAoc2Vlbi5hZGQoY29sb3IpLCB0cnVlKSkpO1xufVxuXG4vLyBFeHRyYWN0IC0tYXRsYXMtcHJpbWFyeS1jb2xvcjsgZmFsbCBiYWNrIHRvIG1ldGEgdGhlbWUtY29sb3JcbmZ1bmN0aW9uIGV4dHJhY3RQcmltYXJ5QW5kVGV4dCgkOiBjaGVlcmlvLkNoZWVyaW9BUEkpOiB7IGNhbmRpZGF0ZXM6IHsgc291cmNlOiBzdHJpbmc7IGNvbG9yOiBzdHJpbmcgfVtdOyBwcmltYXJ5Pzogc3RyaW5nOyB0ZXh0PzogJ2JsYWNrJyB8ICd3aGl0ZScgfSB7XG4gIGNvbnN0IHN0eWxlczogc3RyaW5nW10gPSBbXTtcbiAgJCgnc3R5bGUnKS5lYWNoKChfLCBlbCkgPT4ge1xuICAgIHN0eWxlcy5wdXNoKCQoZWwpLmNvbnRlbnRzKCkudGV4dCgpKTtcbiAgfSk7XG4gIGxldCBwcmltYXJ5OiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgZm9yIChjb25zdCB0ZXh0IG9mIHN0eWxlcykge1xuICAgIGNvbnN0IG0gPSB0ZXh0Lm1hdGNoKC8tLWF0bGFzLXByaW1hcnktY29sb3JcXHMqOlxccyooW147XFxuXFxyXSspL2kpO1xuICAgIGlmIChtICYmIG1bMV0pIHtcbiAgICAgIHByaW1hcnkgPSBub3JtYWxpemVDb2xvcihtWzFdKTtcbiAgICAgIGlmIChwcmltYXJ5KSBicmVhaztcbiAgICB9XG4gIH1cbiAgY29uc3QgY2FuZGlkYXRlcyA9IGV4dHJhY3RDb2xvckNhbmRpZGF0ZXMoJCwgc3R5bGVzKTtcbiAgLy8gdGhlbWUtY29sb3IgYXMgYSBsb3ctcHJpb3JpdHkgY2FuZGlkYXRlXG4gIGNvbnN0IHRoZW1lID0gJCgnbWV0YVtuYW1lPVwidGhlbWUtY29sb3JcIl0nKS5hdHRyKCdjb250ZW50Jyk7XG4gIGNvbnN0IHRoZW1lSGV4ID0gdGhlbWUgPyBub3JtYWxpemVDb2xvcih0aGVtZSkgOiBudWxsO1xuICBpZiAodGhlbWVIZXgpIGNhbmRpZGF0ZXMucHVzaCh7IHNvdXJjZTogJ3RoZW1lLWNvbG9yJywgY29sb3I6IHRoZW1lSGV4IH0pO1xuICAvLyBwcmVmZXIgYXRsYXMgdmFyLCBlbHNlIGFubm91bmNlbWVudCBiZywgY3RhIGJnLCBjdGEgYm9yZGVyLCB0aGVuIHRoZW1lXG4gIGNvbnN0IHByZWZlcnJlZCA9IHByaW1hcnkgfHwgKGNhbmRpZGF0ZXNbMF0/LmNvbG9yIHx8IG51bGwpO1xuICAvLyBwaWNrIHRleHQgY29sb3Igc3VnZ2VzdGlvblxuICBsZXQgdGV4dDogJ2JsYWNrJyB8ICd3aGl0ZScgPSAnYmxhY2snO1xuICBjb25zdCBoZXggPSBwcmVmZXJyZWQgfHwgY2FuZGlkYXRlc1swXT8uY29sb3IgfHwgdGhlbWVIZXg7XG4gIGlmIChoZXgpIHtcbiAgICAvLyBZSVEgZm9ybXVsYVxuICAgIGNvbnN0IHIgPSBwYXJzZUludChoZXguc3Vic3RyaW5nKDEsIDMpLCAxNik7XG4gICAgY29uc3QgZyA9IHBhcnNlSW50KGhleC5zdWJzdHJpbmcoMywgNSksIDE2KTtcbiAgICBjb25zdCBiID0gcGFyc2VJbnQoaGV4LnN1YnN0cmluZyg1LCA3KSwgMTYpO1xuICAgIGNvbnN0IHlpcSA9IChyICogMjk5ICsgZyAqIDU4NyArIGIgKiAxMTQpIC8gMTAwMDtcbiAgICB0ZXh0ID0geWlxID49IDEyOCA/ICdibGFjaycgOiAnd2hpdGUnO1xuICB9XG4gIHJldHVybiB7IGNhbmRpZGF0ZXMsIHByaW1hcnk6IHByZWZlcnJlZCB8fCB1bmRlZmluZWQsIHRleHQgfTtcbn1cblxuZnVuY3Rpb24gZXh0cmFjdEZvbnRzKCQ6IGNoZWVyaW8uQ2hlZXJpb0FQSSk6IHN0cmluZ1tdIHtcbiAgY29uc3Qgc2V0ID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICQoJ2xpbmtbcmVsPVwic3R5bGVzaGVldFwiXVtocmVmKj1cImZvbnRzLmdvb2dsZWFwaXMuY29tXCJdJykuZWFjaCgoXywgZWwpID0+IHtcbiAgICBjb25zdCBocmVmID0gJChlbCkuYXR0cignaHJlZicpIHx8ICcnO1xuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoaHJlZiwgJ2h0dHBzOi8vZXhhbXBsZS5jb20nKTtcbiAgICBjb25zdCBmYW0gPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnZmFtaWx5Jyk7XG4gICAgaWYgKGZhbSkge1xuICAgICAgZmFtLnNwbGl0KCd8JykuZm9yRWFjaCgoY2h1bmspID0+IHNldC5hZGQoY2h1bmsuc3BsaXQoJzonKVswXS5yZXBsYWNlKC9cXCsvZywgJyAnKSkpO1xuICAgIH1cbiAgfSk7XG4gICQoJ3N0eWxlJykuZWFjaCgoXywgZWwpID0+IHtcbiAgICBjb25zdCB0ZXh0ID0gJChlbCkuY29udGVudHMoKS50ZXh0KCk7XG4gICAgY29uc3QgbWF0Y2hlcyA9IHRleHQubWF0Y2goL2ZvbnQtZmFtaWx5XFxzKjpcXHMqKFteO1xcfV0rKS9naSkgfHwgW107XG4gICAgbWF0Y2hlcy5mb3JFYWNoKChtKSA9PiB7XG4gICAgICBjb25zdCBmYW0gPSBtLnNwbGl0KCc6JylbMV0/LnRyaW0oKS5yZXBsYWNlKC9bXCInXS9nLCAnJykuc3BsaXQoJywnKVswXT8udHJpbSgpO1xuICAgICAgaWYgKGZhbSkgc2V0LmFkZChmYW0pO1xuICAgIH0pO1xuICB9KTtcbiAgY29uc3QgYmxvY2tlZCA9IG5ldyBTZXQoWydzYW5zLXNlcmlmJywnc2VyaWYnLCdtb25vc3BhY2UnLCdjdXJzaXZlJywnZmFudGFzeScsJ2Vtb2ppJywnbWF0aCcsJ2Zhbmdzb25nJywnc3lzdGVtLXVpJywnaW5oZXJpdCcsJ2luaXRpYWwnLCd1bnNldCddKTtcbiAgY29uc3QgY2xlYW5lZCA9IEFycmF5LmZyb20oc2V0KVxuICAgIC5maWx0ZXIoZiA9PiBmICYmICEvXnZhclxcKC9pLnRlc3QoZikgJiYgIS9eLS0vLnRlc3QoZikgJiYgIWJsb2NrZWQuaGFzKGYudG9Mb3dlckNhc2UoKSkpXG4gICAgLnNsaWNlKDAsIDUpO1xuICByZXR1cm4gY2xlYW5lZDtcbn1cblxuZnVuY3Rpb24gY29sbGVjdEltYWdlcygkOiBjaGVlcmlvLkNoZWVyaW9BUEksIGJhc2U6IHN0cmluZywgdHlwZTogJ2hlcm8nIHwgJ2Jhbm5lcicpOiBzdHJpbmdbXSB7XG4gIGNvbnN0IHJlc3VsdHM6IHN0cmluZ1tdID0gW107XG4gIGNvbnN0IHJlZ2V4ID0gdHlwZSA9PT0gJ2hlcm8nID8gLyhtYWlufHNsaWRlc2hvd3xoZXJvfGhlYWRlcikvaSA6IC8oYmFubmVyKS9pO1xuICAkKCdpbWcnKS5lYWNoKChfLCBlbCkgPT4ge1xuICAgIGNvbnN0ICRlbCA9ICQoZWwpO1xuICAgIGNvbnN0IGNscyA9ICgkZWwuYXR0cignY2xhc3MnKSB8fCAnJykgKyAnICcgKyAoJGVsLnBhcmVudCgpLmF0dHIoJ2NsYXNzJykgfHwgJycpO1xuICAgIGNvbnN0IGlkID0gKCRlbC5hdHRyKCdpZCcpIHx8ICcnKSArICcgJyArICgkZWwucGFyZW50KCkuYXR0cignaWQnKSB8fCAnJyk7XG4gICAgaWYgKCFyZWdleC50ZXN0KGNscyArICcgJyArIGlkKSkgcmV0dXJuO1xuICAgIGxldCBzcmMgPSAkZWwuYXR0cignc3JjJykgfHwgJGVsLmF0dHIoJ2RhdGEtc3JjJykgfHwgJyc7XG4gICAgc3JjID0gYWJzb2x1dGVVcmwoYmFzZSwgc3JjKTtcbiAgICBpZiAoIXNyYykgcmV0dXJuO1xuICAgIC8vIHdpZHRoIGhldXJpc3RpYzogYXR0cmlidXRlIHdpZHRoIG9yIHNyYyBoaW50cyBsaWtlIF82MDB4XG4gICAgY29uc3Qgd0F0dHIgPSBwYXJzZUludCgkZWwuYXR0cignd2lkdGgnKSB8fCAnMCcsIDEwKTtcbiAgICBjb25zdCBva0J5QXR0ciA9ICFpc05hTih3QXR0cikgJiYgd0F0dHIgPj0gNTk5O1xuICAgIGNvbnN0IG9rQnlTcmMgPSAvW18tXSg2XFxkXFxkfFs3LTldXFxkXFxkfFxcZHs0LH0peC9pLnRlc3Qoc3JjKSB8fCAvdyg9fCUzRCkoNlxcZFxcZHxbNy05XVxcZFxcZHxcXGR7NCx9KS9pLnRlc3Qoc3JjKTtcbiAgICBpZiAob2tCeUF0dHIgfHwgb2tCeVNyYykge1xuICAgICAgcmVzdWx0cy5wdXNoKHNyYyk7XG4gICAgfVxuICB9KTtcbiAgLy8gRGVkdXBlIHByZXNlcnZpbmcgb3JkZXJcbiAgcmV0dXJuIEFycmF5LmZyb20obmV3IFNldChyZXN1bHRzKSk7XG59XG5cbmZ1bmN0aW9uIGNvbGxlY3RNb2JpbGVCYW5uZXJJbWFnZXMoJDogY2hlZXJpby5DaGVlcmlvQVBJLCBiYXNlOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gIGNvbnN0IHJlc3VsdHM6IHN0cmluZ1tdID0gW107XG4gIC8vIGRpcmVjdCBjbGFzcyBvbiBpbWdcbiAgJCgnaW1nLm1vYmlsZS1iYW5uZXIsIGltZ1tjbGFzcyo9XCJtb2JpbGUtYmFubmVyXCJdJykuZWFjaCgoXywgZWwpID0+IHtcbiAgICBsZXQgc3JjID0gJChlbCkuYXR0cignc3JjJykgfHwgJChlbCkuYXR0cignZGF0YS1zcmMnKSB8fCAnJztcbiAgICBzcmMgPSBhYnNvbHV0ZVVybChiYXNlLCBzcmMpO1xuICAgIGlmIChzcmMpIHJlc3VsdHMucHVzaChzcmMpO1xuICB9KTtcbiAgLy8gbmVzdGVkIHdpdGhpbiBlbGVtZW50cyB3aXRoIGNsYXNzIG1vYmlsZS1iYW5uZXJcbiAgJCgnLm1vYmlsZS1iYW5uZXIgaW1nLCBbY2xhc3MqPVwibW9iaWxlLWJhbm5lclwiXSBpbWcnKS5lYWNoKChfLCBlbCkgPT4ge1xuICAgIGxldCBzcmMgPSAkKGVsKS5hdHRyKCdzcmMnKSB8fCAkKGVsKS5hdHRyKCdkYXRhLXNyYycpIHx8ICcnO1xuICAgIHNyYyA9IGFic29sdXRlVXJsKGJhc2UsIHNyYyk7XG4gICAgaWYgKHNyYykgcmVzdWx0cy5wdXNoKHNyYyk7XG4gIH0pO1xuICByZXR1cm4gQXJyYXkuZnJvbShuZXcgU2V0KHJlc3VsdHMpKTtcbn1cblxuZnVuY3Rpb24gZXh0cmFjdFN0b3JlTmFtZSgkOiBjaGVlcmlvLkNoZWVyaW9BUEksIGJhc2VVcmw6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IG9nID0gJCgnbWV0YVtwcm9wZXJ0eT1cIm9nOnNpdGVfbmFtZVwiXScpLmF0dHIoJ2NvbnRlbnQnKTtcbiAgaWYgKG9nKSByZXR1cm4gb2c7XG4gIGNvbnN0IHRpdGxlID0gJCgndGl0bGUnKS5maXJzdCgpLnRleHQoKS50cmltKCk7XG4gIGlmICh0aXRsZSkgcmV0dXJuIHRpdGxlO1xuICB0cnkge1xuICAgIGNvbnN0IGhvc3QgPSBuZXcgVVJMKGJhc2VVcmwpLmhvc3RuYW1lLnJlcGxhY2UoL153d3dcXC4vLCAnJyk7XG4gICAgcmV0dXJuIGhvc3Quc3BsaXQoJy4nKVswXTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuICcnO1xuICB9XG59XG5cbmZ1bmN0aW9uIGV4dHJhY3RMb2dvKCQ6IGNoZWVyaW8uQ2hlZXJpb0FQSSwgYmFzZTogc3RyaW5nKTogeyB1cmw/OiBzdHJpbmc7IHN2Zz86IHN0cmluZyB9IHtcbiAgLy8gc2VhcmNoIGFueSBlbGVtZW50IHdob3NlIGNsYXNzIGluY2x1ZGVzICdsb2dvJ1xuICBjb25zdCBsb2dvQ29udGFpbmVycyA9ICQoJ1tjbGFzcyo9XCJsb2dvXCIgaV0nKS50b0FycmF5KCk7XG4gIGZvciAoY29uc3QgZWwgb2YgbG9nb0NvbnRhaW5lcnMpIHtcbiAgICBjb25zdCAkZWwgPSAkKGVsIGFzIGFueSk7XG4gICAgLy8gaW5saW5lIHN2ZyBpbnNpZGVcbiAgICBjb25zdCBzdmcgPSAkZWwuZmluZCgnc3ZnJykuZmlyc3QoKTtcbiAgICBpZiAoc3ZnICYmIHN2Zy5sZW5ndGgpIHtcbiAgICAgIC8vIGdyYWIgb3V0ZXIgSFRNTFxuICAgICAgY29uc3QgaHRtbCA9ICQuaHRtbChzdmcpO1xuICAgICAgaWYgKGh0bWwpIHJldHVybiB7IHN2ZzogaHRtbCB9O1xuICAgIH1cbiAgICAvLyBpbWFnZSB0YWcgaW5zaWRlXG4gICAgY29uc3QgaW1nID0gJGVsLmZpbmQoJ2ltZycpLmZpcnN0KCk7XG4gICAgaWYgKGltZyAmJiBpbWcubGVuZ3RoKSB7XG4gICAgICBsZXQgc3JjID0gaW1nLmF0dHIoJ3NyYycpIHx8IGltZy5hdHRyKCdkYXRhLXNyYycpIHx8ICcnO1xuICAgICAgc3JjID0gYWJzb2x1dGVVcmwoYmFzZSwgc3JjKTtcbiAgICAgIGlmIChzcmMpIHJldHVybiB7IHVybDogc3JjIH07XG4gICAgfVxuICB9XG4gIC8vIGZhbGxiYWNrOiBzaW1wbGUgaW1nIHdpdGggYWx0L2NsYXNzIGNvbnRhaW5pbmcgbG9nb1xuICBjb25zdCBjYW5kID0gJCgnaW1nW2FsdCo9XCJsb2dvXCIgaV0sIGltZ1tjbGFzcyo9XCJsb2dvXCIgaV0nKS5maXJzdCgpO1xuICBjb25zdCBmYWxsYmFjayA9IGNhbmQuYXR0cignc3JjJykgfHwgY2FuZC5hdHRyKCdkYXRhLXNyYycpIHx8ICcnO1xuICBpZiAoZmFsbGJhY2spIHJldHVybiB7IHVybDogYWJzb2x1dGVVcmwoYmFzZSwgZmFsbGJhY2spIH07XG4gIHJldHVybiB7fTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICBjb25zdCB7IHVybCB9ID0gcmVxLnF1ZXJ5O1xuICBpZiAoIXVybCB8fCB0eXBlb2YgdXJsICE9PSAnc3RyaW5nJykge1xuICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdNaXNzaW5nIHVybCBwYXJhbWV0ZXInIH0pO1xuICAgIHJldHVybjtcbiAgfVxuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KHVybCwgeyBtYXhSZWRpcmVjdHM6IDUsIGhlYWRlcnM6IHsgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAnIH0gfSk7XG4gICAgY29uc3QgaHRtbCA9IHJlc3BvbnNlLmRhdGEgYXMgc3RyaW5nO1xuICAgIGNvbnN0ICQgPSBjaGVlcmlvLmxvYWQoaHRtbCk7XG4gICAgY29uc3QgYmFzZSA9IG5ldyBVUkwodXJsKS50b1N0cmluZygpO1xuXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IHBhcnNlUHJvZHVjdCh1cmwpO1xuICAgIGNvbnN0IHN0b3JlTmFtZSA9IGV4dHJhY3RTdG9yZU5hbWUoJCwgdXJsKTtcbiAgICBjb25zdCBsb2dvT2JqID0gZXh0cmFjdExvZ28oJCwgdXJsKTtcbiAgICBjb25zdCBoZXJvSW1hZ2VzID0gY29sbGVjdEltYWdlcygkLCBiYXNlLCAnaGVybycpO1xuICAgIC8vIFByZWZlciBtb2JpbGUtYmFubmVyIGltYWdlcyBvbiBjdXJyZW50IHBhZ2U7IHRoZW4gYWxzbyB0cnkgaG9tZXBhZ2UgYW5kIG1lcmdlL2RlZHVwZVxuICAgIGxldCBiYW5uZXJJbWFnZXMgPSBjb2xsZWN0TW9iaWxlQmFubmVySW1hZ2VzKCQsIGJhc2UpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBvcmlnaW4gPSBuZXcgVVJMKGJhc2UpLm9yaWdpbjtcbiAgICAgIGNvbnN0IGhvbWVSZXMgPSBhd2FpdCBheGlvcy5nZXQob3JpZ2luLCB7IGhlYWRlcnM6IHsgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAnIH0sIG1heFJlZGlyZWN0czogNSB9KTtcbiAgICAgIGNvbnN0ICRob21lID0gY2hlZXJpby5sb2FkKGhvbWVSZXMuZGF0YSBhcyBzdHJpbmcpO1xuICAgICAgY29uc3QgaG9tZUJhbm5lcnMgPSBjb2xsZWN0TW9iaWxlQmFubmVySW1hZ2VzKCRob21lLCBvcmlnaW4gKyAnLycpO1xuICAgICAgYmFubmVySW1hZ2VzID0gQXJyYXkuZnJvbShuZXcgU2V0KFsuLi5iYW5uZXJJbWFnZXMsIC4uLmhvbWVCYW5uZXJzXSkpO1xuICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgIC8vIGlnbm9yZSBob21lcGFnZSBmZXRjaCBlcnJvcnNcbiAgICB9XG4gICAgaWYgKGJhbm5lckltYWdlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGJhbm5lckltYWdlcyA9IGNvbGxlY3RJbWFnZXMoJCwgYmFzZSwgJ2Jhbm5lcicpO1xuICAgIH1cbiAgICBjb25zdCB7IGNhbmRpZGF0ZXM6IGNvbG9yQ2FuZGlkYXRlcywgcHJpbWFyeTogcHJpbWFyeUNvbG9yLCB0ZXh0OiB0ZXh0Q29sb3IgfSA9IGV4dHJhY3RQcmltYXJ5QW5kVGV4dCgkKTtcbiAgICAvLyBFeHRyYWN0IGFubm91bmNlbWVudCBjb3B5IHRleHQgaWYgcHJlc2VudFxuICAgIGxldCBhbm5vdW5jZW1lbnRDb3B5ID0gJyc7XG4gICAgY29uc3QgYW5uID0gJCgnW2NsYXNzKj1cImFubm91bmNlbWVudFwiIGldLCBbY2xhc3MqPVwiYW5vdW5jZW1lbnRcIiBpXScpLmZpcnN0KCk7XG4gICAgaWYgKGFubiAmJiBhbm4ubGVuZ3RoKSB7XG4gICAgICBhbm5vdW5jZW1lbnRDb3B5ID0gKGFubi50ZXh0KCkgfHwgJycpLnJlcGxhY2UoL1xccysvZywnICcpLnRyaW0oKTtcbiAgICB9XG4gICAgY29uc3QgZm9udEZhbWlsaWVzID0gZXh0cmFjdEZvbnRzKCQpO1xuXG4gICAgY29uc3QgcGF5bG9hZDogQW5hbHl6ZVJlc3BvbnNlID0ge1xuICAgICAgc3RvcmVOYW1lLFxuICAgICAgbG9nbzogbG9nb09iai51cmwsXG4gICAgICBsb2dvU3ZnOiBsb2dvT2JqLnN2ZyxcbiAgICAgIGhlcm9JbWFnZXMsXG4gICAgICBiYW5uZXJJbWFnZXMsXG4gICAgICBjb2xvclNjaGVtZTogcHJpbWFyeUNvbG9yID8gW3ByaW1hcnlDb2xvcl0gOiBbXSxcbiAgICAgIHByaW1hcnlDb2xvcixcbiAgICAgIHRleHRDb2xvcixcbiAgICAgIGNvbG9yQ2FuZGlkYXRlczogY29sb3JDYW5kaWRhdGVzLFxuICAgICAgZm9udEZhbWlsaWVzLFxuICAgICAgYW5ub3VuY2VtZW50Q29weSxcbiAgICAgIHByb2R1Y3RcbiAgICB9O1xuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHBheWxvYWQpO1xuICB9IGNhdGNoIChlcnI6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FuYWx5emUgZXJyb3InLCBlcnIubWVzc2FnZSB8fCBlcnIpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdGYWlsZWQgdG8gYW5hbHl6ZSBwYWdlJyB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImF4aW9zIiwiY2hlZXJpbyIsInBhcnNlUHJvZHVjdCIsImFic29sdXRlVXJsIiwiYmFzZSIsInVybCIsInN0YXJ0c1dpdGgiLCJVUkwiLCJvcmlnaW4iLCJ0b1N0cmluZyIsInJnYlRvSGV4IiwiaW5wdXQiLCJtIiwibWF0Y2giLCJyIiwiTWF0aCIsIm1heCIsIm1pbiIsInBhcnNlSW50IiwiZyIsImIiLCJ0b0hleCIsIm4iLCJwYWRTdGFydCIsInRvVXBwZXJDYXNlIiwibm9ybWFsaXplQ29sb3IiLCJ2YWwiLCJjbGVhbmVkIiwidHJpbSIsInJlcGxhY2UiLCJ0ZXN0IiwiaGV4IiwiYXNIZXgiLCJleHRyYWN0Q29sb3JDYW5kaWRhdGVzIiwiJCIsImJhc2VDc3NUZXh0cyIsImNhbmRpZGF0ZXMiLCJwdXNoIiwic291cmNlIiwiY29sb3IiLCJjIiwiZWFjaCIsIl8iLCJlbCIsInN0eWxlIiwiYXR0ciIsIm1CZyIsIm1Cb3JkZXIiLCJjc3MiLCJyZUFubiIsImV4ZWMiLCJyZUN0YUJnIiwicmVDdGFCb3JkZXIiLCJyZVV0aWwiLCJyZUJ1dHRvblRhZyIsInNlZW4iLCJTZXQiLCJmaWx0ZXIiLCJoYXMiLCJhZGQiLCJleHRyYWN0UHJpbWFyeUFuZFRleHQiLCJzdHlsZXMiLCJjb250ZW50cyIsInRleHQiLCJwcmltYXJ5IiwidGhlbWUiLCJ0aGVtZUhleCIsInByZWZlcnJlZCIsInN1YnN0cmluZyIsInlpcSIsInVuZGVmaW5lZCIsImV4dHJhY3RGb250cyIsInNldCIsImhyZWYiLCJmYW0iLCJzZWFyY2hQYXJhbXMiLCJnZXQiLCJzcGxpdCIsImZvckVhY2giLCJjaHVuayIsIm1hdGNoZXMiLCJibG9ja2VkIiwiQXJyYXkiLCJmcm9tIiwiZiIsInRvTG93ZXJDYXNlIiwic2xpY2UiLCJjb2xsZWN0SW1hZ2VzIiwidHlwZSIsInJlc3VsdHMiLCJyZWdleCIsIiRlbCIsImNscyIsInBhcmVudCIsImlkIiwic3JjIiwid0F0dHIiLCJva0J5QXR0ciIsImlzTmFOIiwib2tCeVNyYyIsImNvbGxlY3RNb2JpbGVCYW5uZXJJbWFnZXMiLCJleHRyYWN0U3RvcmVOYW1lIiwiYmFzZVVybCIsIm9nIiwidGl0bGUiLCJmaXJzdCIsImhvc3QiLCJob3N0bmFtZSIsImV4dHJhY3RMb2dvIiwibG9nb0NvbnRhaW5lcnMiLCJ0b0FycmF5Iiwic3ZnIiwiZmluZCIsImxlbmd0aCIsImh0bWwiLCJpbWciLCJjYW5kIiwiZmFsbGJhY2siLCJoYW5kbGVyIiwicmVxIiwicmVzIiwicXVlcnkiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJyZXNwb25zZSIsIm1heFJlZGlyZWN0cyIsImhlYWRlcnMiLCJkYXRhIiwibG9hZCIsInByb2R1Y3QiLCJzdG9yZU5hbWUiLCJsb2dvT2JqIiwiaGVyb0ltYWdlcyIsImJhbm5lckltYWdlcyIsImhvbWVSZXMiLCIkaG9tZSIsImhvbWVCYW5uZXJzIiwiY29sb3JDYW5kaWRhdGVzIiwicHJpbWFyeUNvbG9yIiwidGV4dENvbG9yIiwiYW5ub3VuY2VtZW50Q29weSIsImFubiIsImZvbnRGYW1pbGllcyIsInBheWxvYWQiLCJsb2dvIiwibG9nb1N2ZyIsImNvbG9yU2NoZW1lIiwiZXJyIiwiY29uc29sZSIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/analyze.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fanalyze&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fanalyze.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();