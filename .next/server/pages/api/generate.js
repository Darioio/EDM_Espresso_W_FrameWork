"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/generate";
exports.ids = ["pages/api/generate"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = import("axios");;

/***/ }),

/***/ "cheerio":
/*!**************************!*\
  !*** external "cheerio" ***!
  \**************************/
/***/ ((module) => {

module.exports = import("cheerio");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fgenerate.ts&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fgenerate.ts&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_generate_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/generate.ts */ \"(api)/./pages/api/generate.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_generate_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_generate_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_generate_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_generate_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/generate\",\n        pathname: \"/api/generate\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_generate_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmdlbmVyYXRlJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZnZW5lcmF0ZS50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUNvRDtBQUNwRDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsbURBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLG1EQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL2VkbS1idWlsZGVyLz9iZjExIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvZ2VuZXJhdGUudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9nZW5lcmF0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2dlbmVyYXRlXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fgenerate.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./data/templates.ts":
/*!***************************!*\
  !*** ./data/templates.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   defaultTemplates: () => (/* binding */ defaultTemplates),\n/* harmony export */   renderTemplate: () => (/* binding */ renderTemplate)\n/* harmony export */ });\n/**\n * Module containing default HTML email templates and helper\n * functions for simple variable substitution. Templates are defined\n * with double curly braces, e.g. `{{title}}`, which will be\n * replaced with values from a ProductData object. Template\n * designers can add or remove placeholders as needed.\n */ /**\n * Default templates included with the application. New templates\n * added via the UI can be appended at runtime (stored in\n * localStorage on the client). When adding a new template be sure to\n * assign a unique id.\n */ const defaultTemplates = [\n    {\n        id: \"product-image-left-copy-right\",\n        name: \"Image left / Copy right\",\n        // Updated HTML for the left-image / copy-right module. This version\n        // matches the design provided in the archive: a light grey\n        // background with a white card, no pretitle, a price block that\n        // supports an original (compare-at) price via the {{priceHtml}}\n        // placeholder, and right-aligned colour swatches. The CTA uses\n        // the accent colour defined in globals.css.\n        html: `<!-- === Start: Product Feature Module (Image Left / Copy Right) === -->\n<table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" align=\"center\" style=\"margin:0;padding:0;background:#F7F7F7;\">\n  <tr>\n    <td align=\"center\" style=\"margin:0;padding:0;background:#F7F7F7;\">\n      <!-- Wrapper -->\n      <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"max-width:600px;margin:0 auto;background:#FFFFFF;\">\n        <tr>\n          <td style=\"padding:24px 16px;\">\n            <!-- Two Columns -->\n            <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:100%;margin:0;padding:0;\">\n              <tr>\n                <!-- Left: Image -->\n                <td class=\"stack-cols\" width=\"50%\" valign=\"top\" style=\"padding:0 8px;\">\n                  <a href=\"{{cta}}\" target=\"_blank\" style=\"text-decoration:none;\">\n                    <img src=\"{{image}}\" alt=\"{{title}}\" style=\"display:block;width:100%;height:auto;border:0;outline:0;text-decoration:none;-ms-interpolation-mode:bicubic;\">\n                  </a>\n                </td>\n\n                <!-- Right: Copy -->\n                <td class=\"stack-cols\" width=\"50%\" valign=\"top\" style=\"padding:0 8px;\">\n                  <!-- Title -->\n                  <h2 style=\"margin:0 0 10px 0;font-family:'Montserrat',Arial,Helvetica,sans-serif;font-size:26px;line-height:1.2;color:#111111;font-weight:300;\">\n                    {{title}}\n                  </h2>\n\n                  <!-- Price (supports original price via priceHtml) -->\n                  <p style=\"margin:0 0 10px 0;font-family:'Montserrat',Arial,Helvetica,sans-serif;font-size:16px;line-height:1;color:#111111;font-weight:600;\">\n                    {{priceHtml}}\n                  </p>\n\n                  <!-- Description -->\n                  <p style=\"margin:0 0 16px 0;font-family:'Montserrat',Arial,Helvetica,sans-serif;font-size:14px;line-height:1.6;color:#333333;\">\n                    {{description}}\n                  </p>\n\n                  <!-- CTA + Colours row -->\n                  <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"margin:0;padding:0;\">\n                    <tr>\n                      <!-- CTA (left) -->\n                      <td align=\"left\" valign=\"middle\" style=\"padding:0;\">\n                        <table role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"margin:0;padding:0;\">\n                          <tr>\n                            <td align=\"center\" bgcolor=\"{{ctaBg}}\" style=\"background:{{ctaBg}};\">\n                              <a href=\"{{cta}}\" target=\"_blank\" style=\"display:inline-block;padding:12px 22px;font-family:'Montserrat',Arial,Helvetica,sans-serif;font-size:14px;line-height:14px;color:#ffffff;text-decoration:none;\">\n                                {{ctaLabel}}\n                              </a>\n                            </td>\n                          </tr>\n                        </table>\n                      </td>\n                      <!-- Spacer -->\n                      <td width=\"12\" style=\"font-size:0;line-height:0;\">&nbsp;</td>\n                      <!-- Colours (right aligned) -->\n                      <td align=\"right\" valign=\"middle\" class=\"color-swatches\" style=\"padding:0;\">\n                        {{coloursHtml}}\n                      </td>\n                    </tr>\n                  </table>\n                  <!-- /CTA + Colours row -->\n\n                </td>\n              </tr>\n            </table>\n            <!-- /Two Columns -->\n          </td>\n        </tr>\n      </table>\n      <!-- /Wrapper -->\n    </td>\n  </tr>\n</table>\n<!-- === End: Product Feature Module === -->\n\n<!-- Mobile Stacking -->\n<style>\n@media only screen and (max-width: 600px) {\n  .stack-cols {\n    display:block !important;\n    width:100% !important;\n    padding:0 0 16px 0 !important;\n  }\n  .color-swatches {\n    text-align:right !important;\n  }\n}\n</style>`\n    },\n    {\n        id: \"product-copy-left-image-right\",\n        name: \"Copy left / Image right\",\n        // Swapped layout: copy appears on the left and image on the right. This\n        // variant matches the new design and removes the pretitle. The\n        // placeholder {{priceHtml}} should contain the formatted price with\n        // any original price included.\n        html: `<!-- === Start: Product Feature Module (Copy Left / Image Right) === -->\n<table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" align=\"center\" style=\"margin:0;padding:0;background:#F7F7F7;\">\n  <tr>\n    <td align=\"center\" style=\"margin:0;padding:0;background:#F7F7F7;\">\n      <!-- Wrapper -->\n      <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"max-width:600px;margin:0 auto;background:#FFFFFF;\">\n        <tr>\n          <td style=\"padding:24px 16px;\">\n            <!-- Two Columns -->\n            <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:100%;margin:0;padding:0;\">\n              <tr>\n                <!-- Left: Copy -->\n                <td class=\"stack-cols\" width=\"50%\" valign=\"top\" style=\"padding:0 8px;\">\n                  <!-- Title -->\n                  <h2 style=\"margin:0 0 10px 0;font-family:'Montserrat',Arial,Helvetica,sans-serif;font-size:26px;line-height:1.2;color:#111111;font-weight:300;\">\n                    {{title}}\n                  </h2>\n\n                  <!-- Price -->\n                  <p style=\"margin:0 0 10px 0;font-family:'Montserrat',Arial,Helvetica,sans-serif;font-size:16px;line-height:1;color:#111111;font-weight:600;\">\n                    {{priceHtml}}\n                  </p>\n\n                  <!-- Description -->\n                  <p style=\"margin:0 0 16px 0;font-family:'Montserrat',Arial,Helvetica,sans-serif;font-size:14px;line-height:1.6;color:#333333;\">\n                    {{description}}\n                  </p>\n\n                  <!-- CTA + Colours row -->\n                  <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"margin:0;padding:0;\">\n                    <tr>\n                      <!-- CTA (left) -->\n                      <td align=\"left\" valign=\"middle\" style=\"padding:0;\">\n                        <table role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"margin:0;padding:0;\">\n                          <tr>\n                            <td align=\"center\" bgcolor=\"{{ctaBg}}\" style=\"background:{{ctaBg}};\">\n                              <a href=\"{{cta}}\" target=\"_blank\" style=\"display:inline-block;padding:12px 22px;font-family:'Montserrat',Arial,Helvetica,sans-serif;font-size:14px;line-height:14px;color:#ffffff;text-decoration:none;\">\n                                {{ctaLabel}}\n                              </a>\n                            </td>\n                          </tr>\n                        </table>\n                      </td>\n                      <!-- Spacer -->\n                      <td width=\"12\" style=\"font-size:0;line-height:0;\">&nbsp;</td>\n                      <!-- Colours (right aligned) -->\n                      <td align=\"right\" valign=\"middle\" class=\"color-swatches\" style=\"padding:0;\">\n                        {{coloursHtml}}\n                      </td>\n                    </tr>\n                  </table>\n                  <!-- /CTA + Colours row -->\n\n                </td>\n\n                <!-- Right: Image -->\n                <td class=\"stack-cols\" width=\"50%\" valign=\"top\" style=\"padding:0 8px;\">\n                  <a href=\"{{cta}}\" target=\"_blank\" style=\"text-decoration:none;\">\n                    <img src=\"{{image}}\" alt=\"{{title}}\" style=\"display:block;width:100%;height:auto;border:0;outline:0;text-decoration:none;-ms-interpolation-mode:bicubic;\">\n                  </a>\n                </td>\n              </tr>\n            </table>\n            <!-- /Two Columns -->\n          </td>\n        </tr>\n      </table>\n      <!-- /Wrapper -->\n    </td>\n  </tr>\n</table>\n<!-- === End: Product Feature Module === -->\n\n<!-- Mobile Stacking -->\n<style>\n@media only screen and (max-width: 600px) {\n  .stack-cols {\n    display:block !important;\n    width:100% !important;\n    padding:0 0 16px 0 !important;\n  }\n  .color-swatches {\n    text-align:right !important;\n  }\n}\n</style>`\n    }\n];\n/**\n * Render a template into a concrete HTML string. Takes a template\n * definition and a product data object and substitutes each\n * placeholder. Supports arrays via the simple `{{#each colours}}` syntax.\n *\n * This is a minimal implementation deliberately kept simple. If more\n * powerful templating is required (e.g. conditionals, loops) a\n * dedicated template engine like Handlebars can be introduced. For\n * now only substitution and basic array iteration is supported.\n */ function renderTemplate(template, data) {\n    let result = template.html;\n    // Handle array blocks: {{#each colors}}...{{/each}}\n    const eachRegex = /\\{\\{#each\\s+([a-zA-Z0-9_]+)\\}}([\\s\\S]*?)\\{\\{\\/each\\}}/g;\n    result = result.replace(eachRegex, (_match, key, inner)=>{\n        const arr = Array.isArray(data[key]) ? data[key] : [];\n        return arr.map((item)=>{\n            // Replace {{.}} within the inner block with the item itself.\n            return inner.replace(/\\{\\{\\.\\}\\}/g, String(item));\n        }).join(\"\");\n    });\n    // Replace simple variables: {{title}}\n    result = result.replace(/\\{\\{\\s*([a-zA-Z0-9_]+)\\s*\\}\\}/g, (_m, key)=>{\n        const value = data[key];\n        return value !== undefined && value !== null ? String(value) : \"\";\n    });\n    return result;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9kYXRhL3RlbXBsYXRlcy50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBOzs7Ozs7Q0FNQyxHQVdEOzs7OztDQUtDLEdBQ00sTUFBTUEsbUJBQStCO0lBQzFDO1FBQ0VDLElBQUk7UUFDSkMsTUFBTTtRQUNOLG9FQUFvRTtRQUNwRSwyREFBMkQ7UUFDM0QsZ0VBQWdFO1FBQ2hFLGdFQUFnRTtRQUNoRSwrREFBK0Q7UUFDL0QsNENBQTRDO1FBQzVDQyxNQUFNLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7UUFxRkgsQ0FBQztJQUNQO0lBQ0U7UUFDQUYsSUFBSTtRQUNKQyxNQUFNO1FBQ04sd0VBQXdFO1FBQ3hFLCtEQUErRDtRQUMvRCxvRUFBb0U7UUFDcEUsK0JBQStCO1FBQy9CQyxNQUFNLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7UUFxRkgsQ0FBQztJQUNQO0NBQ0QsQ0FBQztBQUVGOzs7Ozs7Ozs7Q0FTQyxHQUNNLFNBQVNDLGVBQWVDLFFBQWtCLEVBQUVDLElBQXlCO0lBQzFFLElBQUlDLFNBQVNGLFNBQVNGLElBQUk7SUFDMUIsb0RBQW9EO0lBQ3BELE1BQU1LLFlBQVk7SUFDbEJELFNBQVNBLE9BQU9FLE9BQU8sQ0FBQ0QsV0FBVyxDQUFDRSxRQUFRQyxLQUFhQztRQUN2RCxNQUFNQyxNQUFNQyxNQUFNQyxPQUFPLENBQUNULElBQUksQ0FBQ0ssSUFBSSxJQUFLTCxJQUFJLENBQUNLLElBQUksR0FBYSxFQUFFO1FBQ2hFLE9BQU9FLElBQ0pHLEdBQUcsQ0FBQyxDQUFDQztZQUNKLDZEQUE2RDtZQUM3RCxPQUFPTCxNQUFNSCxPQUFPLENBQUMsZUFBZVMsT0FBT0Q7UUFDN0MsR0FDQ0UsSUFBSSxDQUFDO0lBQ1Y7SUFDQSxzQ0FBc0M7SUFDdENaLFNBQVNBLE9BQU9FLE9BQU8sQ0FBQyxrQ0FBa0MsQ0FBQ1csSUFBSVQ7UUFDN0QsTUFBTVUsUUFBUWYsSUFBSSxDQUFDSyxJQUFJO1FBQ3ZCLE9BQU9VLFVBQVVDLGFBQWFELFVBQVUsT0FBT0gsT0FBT0csU0FBUztJQUNqRTtJQUNBLE9BQU9kO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9lZG0tYnVpbGRlci8uL2RhdGEvdGVtcGxhdGVzLnRzP2RjMzQiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBNb2R1bGUgY29udGFpbmluZyBkZWZhdWx0IEhUTUwgZW1haWwgdGVtcGxhdGVzIGFuZCBoZWxwZXJcbiAqIGZ1bmN0aW9ucyBmb3Igc2ltcGxlIHZhcmlhYmxlIHN1YnN0aXR1dGlvbi4gVGVtcGxhdGVzIGFyZSBkZWZpbmVkXG4gKiB3aXRoIGRvdWJsZSBjdXJseSBicmFjZXMsIGUuZy4gYHt7dGl0bGV9fWAsIHdoaWNoIHdpbGwgYmVcbiAqIHJlcGxhY2VkIHdpdGggdmFsdWVzIGZyb20gYSBQcm9kdWN0RGF0YSBvYmplY3QuIFRlbXBsYXRlXG4gKiBkZXNpZ25lcnMgY2FuIGFkZCBvciByZW1vdmUgcGxhY2Vob2xkZXJzIGFzIG5lZWRlZC5cbiAqL1xuXG5leHBvcnQgaW50ZXJmYWNlIFRlbXBsYXRlIHtcbiAgLyoqIFVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgdGVtcGxhdGUgKi9cbiAgaWQ6IHN0cmluZztcbiAgLyoqIEh1bWFu4oCRZnJpZW5kbHkgbmFtZSBzaG93biBpbiB0aGUgVUkgKi9cbiAgbmFtZTogc3RyaW5nO1xuICAvKiogUmF3IEhUTUwgb2YgdGhlIG1vZHVsZS4gVXNlIHBsYWNlaG9sZGVycyBsaWtlIHt7dGl0bGV9fSAqL1xuICBodG1sOiBzdHJpbmc7XG59XG5cbi8qKlxuICogRGVmYXVsdCB0ZW1wbGF0ZXMgaW5jbHVkZWQgd2l0aCB0aGUgYXBwbGljYXRpb24uIE5ldyB0ZW1wbGF0ZXNcbiAqIGFkZGVkIHZpYSB0aGUgVUkgY2FuIGJlIGFwcGVuZGVkIGF0IHJ1bnRpbWUgKHN0b3JlZCBpblxuICogbG9jYWxTdG9yYWdlIG9uIHRoZSBjbGllbnQpLiBXaGVuIGFkZGluZyBhIG5ldyB0ZW1wbGF0ZSBiZSBzdXJlIHRvXG4gKiBhc3NpZ24gYSB1bmlxdWUgaWQuXG4gKi9cbmV4cG9ydCBjb25zdCBkZWZhdWx0VGVtcGxhdGVzOiBUZW1wbGF0ZVtdID0gW1xuICB7XG4gICAgaWQ6ICdwcm9kdWN0LWltYWdlLWxlZnQtY29weS1yaWdodCcsXG4gICAgbmFtZTogJ0ltYWdlIGxlZnQgLyBDb3B5IHJpZ2h0JyxcbiAgICAvLyBVcGRhdGVkIEhUTUwgZm9yIHRoZSBsZWZ0LWltYWdlIC8gY29weS1yaWdodCBtb2R1bGUuIFRoaXMgdmVyc2lvblxuICAgIC8vIG1hdGNoZXMgdGhlIGRlc2lnbiBwcm92aWRlZCBpbiB0aGUgYXJjaGl2ZTogYSBsaWdodCBncmV5XG4gICAgLy8gYmFja2dyb3VuZCB3aXRoIGEgd2hpdGUgY2FyZCwgbm8gcHJldGl0bGUsIGEgcHJpY2UgYmxvY2sgdGhhdFxuICAgIC8vIHN1cHBvcnRzIGFuIG9yaWdpbmFsIChjb21wYXJlLWF0KSBwcmljZSB2aWEgdGhlIHt7cHJpY2VIdG1sfX1cbiAgICAvLyBwbGFjZWhvbGRlciwgYW5kIHJpZ2h0LWFsaWduZWQgY29sb3VyIHN3YXRjaGVzLiBUaGUgQ1RBIHVzZXNcbiAgICAvLyB0aGUgYWNjZW50IGNvbG91ciBkZWZpbmVkIGluIGdsb2JhbHMuY3NzLlxuICAgIGh0bWw6IGA8IS0tID09PSBTdGFydDogUHJvZHVjdCBGZWF0dXJlIE1vZHVsZSAoSW1hZ2UgTGVmdCAvIENvcHkgUmlnaHQpID09PSAtLT5cbjx0YWJsZSByb2xlPVwicHJlc2VudGF0aW9uXCIgd2lkdGg9XCIxMDAlXCIgY2VsbHBhZGRpbmc9XCIwXCIgY2VsbHNwYWNpbmc9XCIwXCIgYm9yZGVyPVwiMFwiIGFsaWduPVwiY2VudGVyXCIgc3R5bGU9XCJtYXJnaW46MDtwYWRkaW5nOjA7YmFja2dyb3VuZDojRjdGN0Y3O1wiPlxuICA8dHI+XG4gICAgPHRkIGFsaWduPVwiY2VudGVyXCIgc3R5bGU9XCJtYXJnaW46MDtwYWRkaW5nOjA7YmFja2dyb3VuZDojRjdGN0Y3O1wiPlxuICAgICAgPCEtLSBXcmFwcGVyIC0tPlxuICAgICAgPHRhYmxlIHJvbGU9XCJwcmVzZW50YXRpb25cIiB3aWR0aD1cIjEwMCVcIiBjZWxscGFkZGluZz1cIjBcIiBjZWxsc3BhY2luZz1cIjBcIiBib3JkZXI9XCIwXCIgc3R5bGU9XCJtYXgtd2lkdGg6NjAwcHg7bWFyZ2luOjAgYXV0bztiYWNrZ3JvdW5kOiNGRkZGRkY7XCI+XG4gICAgICAgIDx0cj5cbiAgICAgICAgICA8dGQgc3R5bGU9XCJwYWRkaW5nOjI0cHggMTZweDtcIj5cbiAgICAgICAgICAgIDwhLS0gVHdvIENvbHVtbnMgLS0+XG4gICAgICAgICAgICA8dGFibGUgcm9sZT1cInByZXNlbnRhdGlvblwiIHdpZHRoPVwiMTAwJVwiIGNlbGxwYWRkaW5nPVwiMFwiIGNlbGxzcGFjaW5nPVwiMFwiIGJvcmRlcj1cIjBcIiBzdHlsZT1cIndpZHRoOjEwMCU7bWFyZ2luOjA7cGFkZGluZzowO1wiPlxuICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgPCEtLSBMZWZ0OiBJbWFnZSAtLT5cbiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XCJzdGFjay1jb2xzXCIgd2lkdGg9XCI1MCVcIiB2YWxpZ249XCJ0b3BcIiBzdHlsZT1cInBhZGRpbmc6MCA4cHg7XCI+XG4gICAgICAgICAgICAgICAgICA8YSBocmVmPVwie3tjdGF9fVwiIHRhcmdldD1cIl9ibGFua1wiIHN0eWxlPVwidGV4dC1kZWNvcmF0aW9uOm5vbmU7XCI+XG4gICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPVwie3tpbWFnZX19XCIgYWx0PVwie3t0aXRsZX19XCIgc3R5bGU9XCJkaXNwbGF5OmJsb2NrO3dpZHRoOjEwMCU7aGVpZ2h0OmF1dG87Ym9yZGVyOjA7b3V0bGluZTowO3RleHQtZGVjb3JhdGlvbjpub25lOy1tcy1pbnRlcnBvbGF0aW9uLW1vZGU6YmljdWJpYztcIj5cbiAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICA8L3RkPlxuXG4gICAgICAgICAgICAgICAgPCEtLSBSaWdodDogQ29weSAtLT5cbiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XCJzdGFjay1jb2xzXCIgd2lkdGg9XCI1MCVcIiB2YWxpZ249XCJ0b3BcIiBzdHlsZT1cInBhZGRpbmc6MCA4cHg7XCI+XG4gICAgICAgICAgICAgICAgICA8IS0tIFRpdGxlIC0tPlxuICAgICAgICAgICAgICAgICAgPGgyIHN0eWxlPVwibWFyZ2luOjAgMCAxMHB4IDA7Zm9udC1mYW1pbHk6J01vbnRzZXJyYXQnLEFyaWFsLEhlbHZldGljYSxzYW5zLXNlcmlmO2ZvbnQtc2l6ZToyNnB4O2xpbmUtaGVpZ2h0OjEuMjtjb2xvcjojMTExMTExO2ZvbnQtd2VpZ2h0OjMwMDtcIj5cbiAgICAgICAgICAgICAgICAgICAge3t0aXRsZX19XG4gICAgICAgICAgICAgICAgICA8L2gyPlxuXG4gICAgICAgICAgICAgICAgICA8IS0tIFByaWNlIChzdXBwb3J0cyBvcmlnaW5hbCBwcmljZSB2aWEgcHJpY2VIdG1sKSAtLT5cbiAgICAgICAgICAgICAgICAgIDxwIHN0eWxlPVwibWFyZ2luOjAgMCAxMHB4IDA7Zm9udC1mYW1pbHk6J01vbnRzZXJyYXQnLEFyaWFsLEhlbHZldGljYSxzYW5zLXNlcmlmO2ZvbnQtc2l6ZToxNnB4O2xpbmUtaGVpZ2h0OjE7Y29sb3I6IzExMTExMTtmb250LXdlaWdodDo2MDA7XCI+XG4gICAgICAgICAgICAgICAgICAgIHt7cHJpY2VIdG1sfX1cbiAgICAgICAgICAgICAgICAgIDwvcD5cblxuICAgICAgICAgICAgICAgICAgPCEtLSBEZXNjcmlwdGlvbiAtLT5cbiAgICAgICAgICAgICAgICAgIDxwIHN0eWxlPVwibWFyZ2luOjAgMCAxNnB4IDA7Zm9udC1mYW1pbHk6J01vbnRzZXJyYXQnLEFyaWFsLEhlbHZldGljYSxzYW5zLXNlcmlmO2ZvbnQtc2l6ZToxNHB4O2xpbmUtaGVpZ2h0OjEuNjtjb2xvcjojMzMzMzMzO1wiPlxuICAgICAgICAgICAgICAgICAgICB7e2Rlc2NyaXB0aW9ufX1cbiAgICAgICAgICAgICAgICAgIDwvcD5cblxuICAgICAgICAgICAgICAgICAgPCEtLSBDVEEgKyBDb2xvdXJzIHJvdyAtLT5cbiAgICAgICAgICAgICAgICAgIDx0YWJsZSByb2xlPVwicHJlc2VudGF0aW9uXCIgd2lkdGg9XCIxMDAlXCIgY2VsbHBhZGRpbmc9XCIwXCIgY2VsbHNwYWNpbmc9XCIwXCIgYm9yZGVyPVwiMFwiIHN0eWxlPVwibWFyZ2luOjA7cGFkZGluZzowO1wiPlxuICAgICAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICAgICAgPCEtLSBDVEEgKGxlZnQpIC0tPlxuICAgICAgICAgICAgICAgICAgICAgIDx0ZCBhbGlnbj1cImxlZnRcIiB2YWxpZ249XCJtaWRkbGVcIiBzdHlsZT1cInBhZGRpbmc6MDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSByb2xlPVwicHJlc2VudGF0aW9uXCIgY2VsbHBhZGRpbmc9XCIwXCIgY2VsbHNwYWNpbmc9XCIwXCIgYm9yZGVyPVwiMFwiIHN0eWxlPVwibWFyZ2luOjA7cGFkZGluZzowO1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGFsaWduPVwiY2VudGVyXCIgYmdjb2xvcj1cInt7Y3RhQmd9fVwiIHN0eWxlPVwiYmFja2dyb3VuZDp7e2N0YUJnfX07XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwie3tjdGF9fVwiIHRhcmdldD1cIl9ibGFua1wiIHN0eWxlPVwiZGlzcGxheTppbmxpbmUtYmxvY2s7cGFkZGluZzoxMnB4IDIycHg7Zm9udC1mYW1pbHk6J01vbnRzZXJyYXQnLEFyaWFsLEhlbHZldGljYSxzYW5zLXNlcmlmO2ZvbnQtc2l6ZToxNHB4O2xpbmUtaGVpZ2h0OjE0cHg7Y29sb3I6I2ZmZmZmZjt0ZXh0LWRlY29yYXRpb246bm9uZTtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3tjdGFMYWJlbH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICAgICAgICA8IS0tIFNwYWNlciAtLT5cbiAgICAgICAgICAgICAgICAgICAgICA8dGQgd2lkdGg9XCIxMlwiIHN0eWxlPVwiZm9udC1zaXplOjA7bGluZS1oZWlnaHQ6MDtcIj4mbmJzcDs8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgIDwhLS0gQ29sb3VycyAocmlnaHQgYWxpZ25lZCkgLS0+XG4gICAgICAgICAgICAgICAgICAgICAgPHRkIGFsaWduPVwicmlnaHRcIiB2YWxpZ249XCJtaWRkbGVcIiBjbGFzcz1cImNvbG9yLXN3YXRjaGVzXCIgc3R5bGU9XCJwYWRkaW5nOjA7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7e2NvbG91cnNIdG1sfX1cbiAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICAgICAgIDwhLS0gL0NUQSArIENvbG91cnMgcm93IC0tPlxuXG4gICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICA8IS0tIC9Ud28gQ29sdW1ucyAtLT5cbiAgICAgICAgICA8L3RkPlxuICAgICAgICA8L3RyPlxuICAgICAgPC90YWJsZT5cbiAgICAgIDwhLS0gL1dyYXBwZXIgLS0+XG4gICAgPC90ZD5cbiAgPC90cj5cbjwvdGFibGU+XG48IS0tID09PSBFbmQ6IFByb2R1Y3QgRmVhdHVyZSBNb2R1bGUgPT09IC0tPlxuXG48IS0tIE1vYmlsZSBTdGFja2luZyAtLT5cbjxzdHlsZT5cbkBtZWRpYSBvbmx5IHNjcmVlbiBhbmQgKG1heC13aWR0aDogNjAwcHgpIHtcbiAgLnN0YWNrLWNvbHMge1xuICAgIGRpc3BsYXk6YmxvY2sgIWltcG9ydGFudDtcbiAgICB3aWR0aDoxMDAlICFpbXBvcnRhbnQ7XG4gICAgcGFkZGluZzowIDAgMTZweCAwICFpbXBvcnRhbnQ7XG4gIH1cbiAgLmNvbG9yLXN3YXRjaGVzIHtcbiAgICB0ZXh0LWFsaWduOnJpZ2h0ICFpbXBvcnRhbnQ7XG4gIH1cbn1cbjwvc3R5bGU+YFxuICB9XG4gICwge1xuICAgIGlkOiAncHJvZHVjdC1jb3B5LWxlZnQtaW1hZ2UtcmlnaHQnLFxuICAgIG5hbWU6ICdDb3B5IGxlZnQgLyBJbWFnZSByaWdodCcsXG4gICAgLy8gU3dhcHBlZCBsYXlvdXQ6IGNvcHkgYXBwZWFycyBvbiB0aGUgbGVmdCBhbmQgaW1hZ2Ugb24gdGhlIHJpZ2h0LiBUaGlzXG4gICAgLy8gdmFyaWFudCBtYXRjaGVzIHRoZSBuZXcgZGVzaWduIGFuZCByZW1vdmVzIHRoZSBwcmV0aXRsZS4gVGhlXG4gICAgLy8gcGxhY2Vob2xkZXIge3twcmljZUh0bWx9fSBzaG91bGQgY29udGFpbiB0aGUgZm9ybWF0dGVkIHByaWNlIHdpdGhcbiAgICAvLyBhbnkgb3JpZ2luYWwgcHJpY2UgaW5jbHVkZWQuXG4gICAgaHRtbDogYDwhLS0gPT09IFN0YXJ0OiBQcm9kdWN0IEZlYXR1cmUgTW9kdWxlIChDb3B5IExlZnQgLyBJbWFnZSBSaWdodCkgPT09IC0tPlxuPHRhYmxlIHJvbGU9XCJwcmVzZW50YXRpb25cIiB3aWR0aD1cIjEwMCVcIiBjZWxscGFkZGluZz1cIjBcIiBjZWxsc3BhY2luZz1cIjBcIiBib3JkZXI9XCIwXCIgYWxpZ249XCJjZW50ZXJcIiBzdHlsZT1cIm1hcmdpbjowO3BhZGRpbmc6MDtiYWNrZ3JvdW5kOiNGN0Y3Rjc7XCI+XG4gIDx0cj5cbiAgICA8dGQgYWxpZ249XCJjZW50ZXJcIiBzdHlsZT1cIm1hcmdpbjowO3BhZGRpbmc6MDtiYWNrZ3JvdW5kOiNGN0Y3Rjc7XCI+XG4gICAgICA8IS0tIFdyYXBwZXIgLS0+XG4gICAgICA8dGFibGUgcm9sZT1cInByZXNlbnRhdGlvblwiIHdpZHRoPVwiMTAwJVwiIGNlbGxwYWRkaW5nPVwiMFwiIGNlbGxzcGFjaW5nPVwiMFwiIGJvcmRlcj1cIjBcIiBzdHlsZT1cIm1heC13aWR0aDo2MDBweDttYXJnaW46MCBhdXRvO2JhY2tncm91bmQ6I0ZGRkZGRjtcIj5cbiAgICAgICAgPHRyPlxuICAgICAgICAgIDx0ZCBzdHlsZT1cInBhZGRpbmc6MjRweCAxNnB4O1wiPlxuICAgICAgICAgICAgPCEtLSBUd28gQ29sdW1ucyAtLT5cbiAgICAgICAgICAgIDx0YWJsZSByb2xlPVwicHJlc2VudGF0aW9uXCIgd2lkdGg9XCIxMDAlXCIgY2VsbHBhZGRpbmc9XCIwXCIgY2VsbHNwYWNpbmc9XCIwXCIgYm9yZGVyPVwiMFwiIHN0eWxlPVwid2lkdGg6MTAwJTttYXJnaW46MDtwYWRkaW5nOjA7XCI+XG4gICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICA8IS0tIExlZnQ6IENvcHkgLS0+XG4gICAgICAgICAgICAgICAgPHRkIGNsYXNzPVwic3RhY2stY29sc1wiIHdpZHRoPVwiNTAlXCIgdmFsaWduPVwidG9wXCIgc3R5bGU9XCJwYWRkaW5nOjAgOHB4O1wiPlxuICAgICAgICAgICAgICAgICAgPCEtLSBUaXRsZSAtLT5cbiAgICAgICAgICAgICAgICAgIDxoMiBzdHlsZT1cIm1hcmdpbjowIDAgMTBweCAwO2ZvbnQtZmFtaWx5OidNb250c2VycmF0JyxBcmlhbCxIZWx2ZXRpY2Esc2Fucy1zZXJpZjtmb250LXNpemU6MjZweDtsaW5lLWhlaWdodDoxLjI7Y29sb3I6IzExMTExMTtmb250LXdlaWdodDozMDA7XCI+XG4gICAgICAgICAgICAgICAgICAgIHt7dGl0bGV9fVxuICAgICAgICAgICAgICAgICAgPC9oMj5cblxuICAgICAgICAgICAgICAgICAgPCEtLSBQcmljZSAtLT5cbiAgICAgICAgICAgICAgICAgIDxwIHN0eWxlPVwibWFyZ2luOjAgMCAxMHB4IDA7Zm9udC1mYW1pbHk6J01vbnRzZXJyYXQnLEFyaWFsLEhlbHZldGljYSxzYW5zLXNlcmlmO2ZvbnQtc2l6ZToxNnB4O2xpbmUtaGVpZ2h0OjE7Y29sb3I6IzExMTExMTtmb250LXdlaWdodDo2MDA7XCI+XG4gICAgICAgICAgICAgICAgICAgIHt7cHJpY2VIdG1sfX1cbiAgICAgICAgICAgICAgICAgIDwvcD5cblxuICAgICAgICAgICAgICAgICAgPCEtLSBEZXNjcmlwdGlvbiAtLT5cbiAgICAgICAgICAgICAgICAgIDxwIHN0eWxlPVwibWFyZ2luOjAgMCAxNnB4IDA7Zm9udC1mYW1pbHk6J01vbnRzZXJyYXQnLEFyaWFsLEhlbHZldGljYSxzYW5zLXNlcmlmO2ZvbnQtc2l6ZToxNHB4O2xpbmUtaGVpZ2h0OjEuNjtjb2xvcjojMzMzMzMzO1wiPlxuICAgICAgICAgICAgICAgICAgICB7e2Rlc2NyaXB0aW9ufX1cbiAgICAgICAgICAgICAgICAgIDwvcD5cblxuICAgICAgICAgICAgICAgICAgPCEtLSBDVEEgKyBDb2xvdXJzIHJvdyAtLT5cbiAgICAgICAgICAgICAgICAgIDx0YWJsZSByb2xlPVwicHJlc2VudGF0aW9uXCIgd2lkdGg9XCIxMDAlXCIgY2VsbHBhZGRpbmc9XCIwXCIgY2VsbHNwYWNpbmc9XCIwXCIgYm9yZGVyPVwiMFwiIHN0eWxlPVwibWFyZ2luOjA7cGFkZGluZzowO1wiPlxuICAgICAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICAgICAgPCEtLSBDVEEgKGxlZnQpIC0tPlxuICAgICAgICAgICAgICAgICAgICAgIDx0ZCBhbGlnbj1cImxlZnRcIiB2YWxpZ249XCJtaWRkbGVcIiBzdHlsZT1cInBhZGRpbmc6MDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSByb2xlPVwicHJlc2VudGF0aW9uXCIgY2VsbHBhZGRpbmc9XCIwXCIgY2VsbHNwYWNpbmc9XCIwXCIgYm9yZGVyPVwiMFwiIHN0eWxlPVwibWFyZ2luOjA7cGFkZGluZzowO1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGFsaWduPVwiY2VudGVyXCIgYmdjb2xvcj1cInt7Y3RhQmd9fVwiIHN0eWxlPVwiYmFja2dyb3VuZDp7e2N0YUJnfX07XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwie3tjdGF9fVwiIHRhcmdldD1cIl9ibGFua1wiIHN0eWxlPVwiZGlzcGxheTppbmxpbmUtYmxvY2s7cGFkZGluZzoxMnB4IDIycHg7Zm9udC1mYW1pbHk6J01vbnRzZXJyYXQnLEFyaWFsLEhlbHZldGljYSxzYW5zLXNlcmlmO2ZvbnQtc2l6ZToxNHB4O2xpbmUtaGVpZ2h0OjE0cHg7Y29sb3I6I2ZmZmZmZjt0ZXh0LWRlY29yYXRpb246bm9uZTtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3tjdGFMYWJlbH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICAgICAgICA8IS0tIFNwYWNlciAtLT5cbiAgICAgICAgICAgICAgICAgICAgICA8dGQgd2lkdGg9XCIxMlwiIHN0eWxlPVwiZm9udC1zaXplOjA7bGluZS1oZWlnaHQ6MDtcIj4mbmJzcDs8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgIDwhLS0gQ29sb3VycyAocmlnaHQgYWxpZ25lZCkgLS0+XG4gICAgICAgICAgICAgICAgICAgICAgPHRkIGFsaWduPVwicmlnaHRcIiB2YWxpZ249XCJtaWRkbGVcIiBjbGFzcz1cImNvbG9yLXN3YXRjaGVzXCIgc3R5bGU9XCJwYWRkaW5nOjA7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7e2NvbG91cnNIdG1sfX1cbiAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICAgICAgIDwhLS0gL0NUQSArIENvbG91cnMgcm93IC0tPlxuXG4gICAgICAgICAgICAgICAgPC90ZD5cblxuICAgICAgICAgICAgICAgIDwhLS0gUmlnaHQ6IEltYWdlIC0tPlxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cInN0YWNrLWNvbHNcIiB3aWR0aD1cIjUwJVwiIHZhbGlnbj1cInRvcFwiIHN0eWxlPVwicGFkZGluZzowIDhweDtcIj5cbiAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJ7e2N0YX19XCIgdGFyZ2V0PVwiX2JsYW5rXCIgc3R5bGU9XCJ0ZXh0LWRlY29yYXRpb246bm9uZTtcIj5cbiAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9XCJ7e2ltYWdlfX1cIiBhbHQ9XCJ7e3RpdGxlfX1cIiBzdHlsZT1cImRpc3BsYXk6YmxvY2s7d2lkdGg6MTAwJTtoZWlnaHQ6YXV0bztib3JkZXI6MDtvdXRsaW5lOjA7dGV4dC1kZWNvcmF0aW9uOm5vbmU7LW1zLWludGVycG9sYXRpb24tbW9kZTpiaWN1YmljO1wiPlxuICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICA8L3RhYmxlPlxuICAgICAgICAgICAgPCEtLSAvVHdvIENvbHVtbnMgLS0+XG4gICAgICAgICAgPC90ZD5cbiAgICAgICAgPC90cj5cbiAgICAgIDwvdGFibGU+XG4gICAgICA8IS0tIC9XcmFwcGVyIC0tPlxuICAgIDwvdGQ+XG4gIDwvdHI+XG48L3RhYmxlPlxuPCEtLSA9PT0gRW5kOiBQcm9kdWN0IEZlYXR1cmUgTW9kdWxlID09PSAtLT5cblxuPCEtLSBNb2JpbGUgU3RhY2tpbmcgLS0+XG48c3R5bGU+XG5AbWVkaWEgb25seSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDYwMHB4KSB7XG4gIC5zdGFjay1jb2xzIHtcbiAgICBkaXNwbGF5OmJsb2NrICFpbXBvcnRhbnQ7XG4gICAgd2lkdGg6MTAwJSAhaW1wb3J0YW50O1xuICAgIHBhZGRpbmc6MCAwIDE2cHggMCAhaW1wb3J0YW50O1xuICB9XG4gIC5jb2xvci1zd2F0Y2hlcyB7XG4gICAgdGV4dC1hbGlnbjpyaWdodCAhaW1wb3J0YW50O1xuICB9XG59XG48L3N0eWxlPmBcbiAgfVxuXTtcblxuLyoqXG4gKiBSZW5kZXIgYSB0ZW1wbGF0ZSBpbnRvIGEgY29uY3JldGUgSFRNTCBzdHJpbmcuIFRha2VzIGEgdGVtcGxhdGVcbiAqIGRlZmluaXRpb24gYW5kIGEgcHJvZHVjdCBkYXRhIG9iamVjdCBhbmQgc3Vic3RpdHV0ZXMgZWFjaFxuICogcGxhY2Vob2xkZXIuIFN1cHBvcnRzIGFycmF5cyB2aWEgdGhlIHNpbXBsZSBge3sjZWFjaCBjb2xvdXJzfX1gIHN5bnRheC5cbiAqXG4gKiBUaGlzIGlzIGEgbWluaW1hbCBpbXBsZW1lbnRhdGlvbiBkZWxpYmVyYXRlbHkga2VwdCBzaW1wbGUuIElmIG1vcmVcbiAqIHBvd2VyZnVsIHRlbXBsYXRpbmcgaXMgcmVxdWlyZWQgKGUuZy4gY29uZGl0aW9uYWxzLCBsb29wcykgYVxuICogZGVkaWNhdGVkIHRlbXBsYXRlIGVuZ2luZSBsaWtlIEhhbmRsZWJhcnMgY2FuIGJlIGludHJvZHVjZWQuIEZvclxuICogbm93IG9ubHkgc3Vic3RpdHV0aW9uIGFuZCBiYXNpYyBhcnJheSBpdGVyYXRpb24gaXMgc3VwcG9ydGVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyVGVtcGxhdGUodGVtcGxhdGU6IFRlbXBsYXRlLCBkYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogc3RyaW5nIHtcbiAgbGV0IHJlc3VsdCA9IHRlbXBsYXRlLmh0bWw7XG4gIC8vIEhhbmRsZSBhcnJheSBibG9ja3M6IHt7I2VhY2ggY29sb3JzfX0uLi57ey9lYWNofX1cbiAgY29uc3QgZWFjaFJlZ2V4ID0gL1xce1xceyNlYWNoXFxzKyhbYS16QS1aMC05X10rKVxcfX0oW1xcc1xcU10qPylcXHtcXHtcXC9lYWNoXFx9fS9nO1xuICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShlYWNoUmVnZXgsIChfbWF0Y2gsIGtleTogc3RyaW5nLCBpbm5lcjogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgYXJyID0gQXJyYXkuaXNBcnJheShkYXRhW2tleV0pID8gKGRhdGFba2V5XSBhcyBhbnlbXSkgOiBbXTtcbiAgICByZXR1cm4gYXJyXG4gICAgICAubWFwKChpdGVtKSA9PiB7XG4gICAgICAgIC8vIFJlcGxhY2Uge3sufX0gd2l0aGluIHRoZSBpbm5lciBibG9jayB3aXRoIHRoZSBpdGVtIGl0c2VsZi5cbiAgICAgICAgcmV0dXJuIGlubmVyLnJlcGxhY2UoL1xce1xce1xcLlxcfVxcfS9nLCBTdHJpbmcoaXRlbSkpO1xuICAgICAgfSlcbiAgICAgIC5qb2luKCcnKTtcbiAgfSk7XG4gIC8vIFJlcGxhY2Ugc2ltcGxlIHZhcmlhYmxlczoge3t0aXRsZX19XG4gIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKC9cXHtcXHtcXHMqKFthLXpBLVowLTlfXSspXFxzKlxcfVxcfS9nLCAoX20sIGtleTogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgdmFsdWUgPSBkYXRhW2tleV07XG4gICAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwgPyBTdHJpbmcodmFsdWUpIDogJyc7XG4gIH0pO1xuICByZXR1cm4gcmVzdWx0O1xufSJdLCJuYW1lcyI6WyJkZWZhdWx0VGVtcGxhdGVzIiwiaWQiLCJuYW1lIiwiaHRtbCIsInJlbmRlclRlbXBsYXRlIiwidGVtcGxhdGUiLCJkYXRhIiwicmVzdWx0IiwiZWFjaFJlZ2V4IiwicmVwbGFjZSIsIl9tYXRjaCIsImtleSIsImlubmVyIiwiYXJyIiwiQXJyYXkiLCJpc0FycmF5IiwibWFwIiwiaXRlbSIsIlN0cmluZyIsImpvaW4iLCJfbSIsInZhbHVlIiwidW5kZWZpbmVkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./data/templates.ts\n");

/***/ }),

/***/ "(api)/./lib/parser.ts":
/*!***********************!*\
  !*** ./lib/parser.ts ***!
  \***********************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseProduct: () => (/* binding */ parseProduct)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var cheerio__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! cheerio */ \"cheerio\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([axios__WEBPACK_IMPORTED_MODULE_0__, cheerio__WEBPACK_IMPORTED_MODULE_1__]);\n([axios__WEBPACK_IMPORTED_MODULE_0__, cheerio__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n/**\n * Attempt to parse structured JSON-LD data from the page. Many\n * e‑commerce platforms embed an object with the schema.org\n * Product type. This helper extracts it if present.\n */ function parseLdJson($) {\n    const scripts = $('script[type=\"application/ld+json\"]').toArray();\n    for (const el of scripts){\n        const contents = $(el).contents().text();\n        if (!contents) continue;\n        try {\n            const json = JSON.parse(contents.trim());\n            // Sometimes multiple objects are wrapped in an array.\n            const candidates = Array.isArray(json) ? json : [\n                json\n            ];\n            for (const obj of candidates){\n                if (obj[\"@type\"] === \"Product\") {\n                    return obj;\n                }\n            }\n        } catch (_) {\n        // ignore JSON parse errors and continue.\n        }\n    }\n    return null;\n}\n/**\n * Generic helper to extract a meta tag value. It first tries to\n * match the given property on the `meta[property]` attribute (as used\n * by Open Graph), then falls back to `meta[name]`.\n */ function getMeta($, prop) {\n    return $(`meta[property='${prop}']`).attr(\"content\") || $(`meta[name='${prop}']`).attr(\"content\") || null;\n}\n/**\n * Fetch a product page and extract basic fields using heuristics. This\n * function does not attempt to deeply crawl the DOM; instead it relies\n * on Open Graph tags, JSON‑LD and common microdata attributes. If a\n * field cannot be resolved it will be returned as an empty string.\n *\n * If the request fails for whatever reason the resulting object will\n * contain empty strings for all properties except url and cta.\n *\n * @param url Product page URL\n */ async function parseProduct(url) {\n    const clean = (value)=>(value || \"\").toString().trim();\n    let html = \"\";\n    try {\n        const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(url, {\n            headers: {\n                // Set a user agent so that some sites don’t block our request.\n                \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0 Safari/537.36\"\n            },\n            // Follow redirects automatically.\n            maxRedirects: 3\n        });\n        html = response.data;\n    } catch (error) {\n        console.error(`Failed to fetch ${url}:`, error instanceof Error ? error.message : error);\n        return {\n            url,\n            pretitle: \"\",\n            title: \"\",\n            price: \"\",\n            description: \"\",\n            image: \"\",\n            colors: [],\n            cta: url\n        };\n    }\n    const $ = cheerio__WEBPACK_IMPORTED_MODULE_1__.load(html);\n    // Attempt to parse JSON‑LD structured data first because it typically\n    // provides the richest information. We fall back to meta tags if\n    // structured data is not present or incomplete.\n    const ld = parseLdJson($) || {};\n    const product = {\n        url,\n        pretitle: \"\",\n        title: \"\",\n        price: \"\",\n        originalPrice: undefined,\n        description: \"\",\n        image: \"\",\n        colors: [],\n        images: undefined,\n        cta: url,\n        // Default call-to-action label. Users can override this in the\n        // preview by editing the CTA text. If not provided, templates\n        // will fall back to this value.\n        ctaLabel: \"SHOP NOW\"\n    };\n    // Title\n    product.title = clean(ld.name) || clean(getMeta($, \"og:title\")) || clean(getMeta($, \"twitter:title\")) || clean($(\"title\").first().text());\n    // Description\n    product.description = clean(ld.description) || clean(getMeta($, \"og:description\")) || clean(getMeta($, \"twitter:description\")) || clean(getMeta($, \"description\"));\n    // Image\n    const ldImage = Array.isArray(ld.image) ? ld.image[0] : typeof ld.image === \"string\" ? ld.image : undefined;\n    product.image = clean(ldImage) || clean(getMeta($, \"og:image\")) || clean(getMeta($, \"twitter:image\")) || clean($(\"img\").first().attr(\"src\"));\n    // Price\n    const ldOffers = ld.offers;\n    let ldPrice;\n    if (ldOffers) {\n        if (Array.isArray(ldOffers)) {\n            ldPrice = ldOffers[0]?.price;\n        } else if (typeof ldOffers === \"object\") {\n            ldPrice = ldOffers.price;\n        }\n    }\n    product.price = clean(ldPrice) || clean(getMeta($, \"product:price:amount\")) || clean(getMeta($, \"og:price:amount\")) || // Try to match microdata on sites like Shopify: [itemprop=\"price\"]\n    clean($('[itemprop=\"price\"]').first().text());\n    // Original price: attempt to find a compare‑at or strike‑through price. This\n    // can appear in JSON‑LD as an \"priceSpecification\" with\n    // \"priceCurrency\" and \"value\", or in the DOM as <del> or a span with\n    // class containing \"compare\" or \"strike\". We attempt several heuristics\n    // and take the first numeric value we find. The value returned does\n    // not include the currency symbol.\n    let original;\n    // Check JSON‑LD offers.comparePrice if present\n    if (ldOffers) {\n        // Some schemas nest compareAtPrice or originalPrice\n        const getCompare = (obj)=>{\n            if (!obj) return undefined;\n            return obj.compareAtPrice || obj.originalPrice || obj.priceSpecification?.price;\n        };\n        if (Array.isArray(ldOffers)) {\n            for (const off of ldOffers){\n                const val = getCompare(off);\n                if (val) {\n                    original = clean(val);\n                    break;\n                }\n            }\n        } else if (typeof ldOffers === \"object\") {\n            const val = getCompare(ldOffers);\n            if (val) {\n                original = clean(val);\n            }\n        }\n    }\n    if (!original) {\n        // Look for elements containing a price with a line‑through style or a\n        // class indicating \"compare\" or \"original\". We extract numeric\n        // values (digits and decimal separators).\n        const priceRegex = /([\\d,.]+)\\s*(?:[A-Z]{3})?/;\n        // helper to parse text\n        const parsePriceText = (text)=>{\n            const match = priceRegex.exec(text);\n            return match ? match[1] : undefined;\n        };\n        // Check <del> elements\n        $(\"del, strike\").each((_, el)=>{\n            const text = $(el).text();\n            const val = parsePriceText(text);\n            if (val) {\n                original = clean(val);\n                return false; // break the loop\n            }\n        });\n        // Check elements with class containing compare or original\n        if (!original) {\n            $('[class*=\"compare\"],[class*=\"original\"],[class*=\"strike\"]').each((_, el)=>{\n                const text = $(el).text();\n                const val = parsePriceText(text);\n                if (val) {\n                    original = clean(val);\n                    return false;\n                }\n            });\n        }\n    }\n    // Assign originalPrice if found and different from sale price\n    if (original && original !== product.price) {\n        product.originalPrice = original;\n    }\n    // Pretitle: not widely available. As a heuristic, if the title\n    // contains a hyphen, split the first part as pretitle and the rest\n    // as the actual title.\n    if (product.title && product.title.includes(\" – \")) {\n        const parts = product.title.split(/\\s+–\\s+/);\n        if (parts.length > 1) {\n            product.pretitle = parts[0];\n            product.title = parts.slice(1).join(\" – \");\n        }\n    }\n    // Colours: attempt to find colour swatch elements. Many ecommerce\n    // platforms use inline styles or background colours to define swatch\n    // elements. We look for any elements with a background colour style\n    // and extract the hex code. The colours are collected in the order\n    // they appear in the DOM and deduplicated while preserving that order.\n    const coloursFound = [];\n    $(\"[style]\").each((_, el)=>{\n        const style = $(el).attr(\"style\");\n        if (!style) return;\n        const match = /background(?:-color)?\\s*:\\s*([^;]+);?/i.exec(style);\n        if (!match) return;\n        const colour = match[1].trim();\n        // Only accept simple hex codes (3 or 6 hex digits). Ignore other\n        // formats such as rgb() so the preview displays consistent swatches.\n        if (/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})/.test(colour)) {\n            // Skip very light colours (white/off-white backgrounds) as these\n            // are commonly used for container backgrounds rather than swatches.\n            if (/^(#?fff(?:fff)?|#?f7f7f7)$/i.test(colour)) return;\n            if (!coloursFound.includes(colour)) {\n                coloursFound.push(colour);\n            }\n        }\n    });\n    product.colors = coloursFound;\n    // Images: collect additional image URLs beyond the primary image. We\n    // start with the primary image if it exists. Then search for image\n    // elements that are likely part of the product gallery. Heuristics\n    // include class names containing \"product\", \"gallery\", \"thumb\", or\n    // \"image\". We also accept JSON‑LD image arrays. Only absolute\n    // URLs (http or https) are kept and duplicates removed.\n    const imageSet = new Set();\n    if (product.image) {\n        imageSet.add(product.image);\n    }\n    // Add any additional images from JSON‑LD\n    if (Array.isArray(ld.image)) {\n        for (const img of ld.image){\n            if (typeof img === \"string\" && /^https?:\\/\\//i.test(img)) {\n                imageSet.add(img);\n            }\n        }\n    }\n    // DOM extraction: find images with relevant class hints\n    $(\"img\").each((_, el)=>{\n        const src = clean($(el).attr(\"src\"));\n        if (!src) return;\n        // Only accept absolute URLs\n        if (!/^https?:\\/\\//i.test(src)) return;\n        // Accept images if they contain certain keywords in their class or id\n        const classes = ($(el).attr(\"class\") || \"\") + \" \" + ($(el).parent().attr(\"class\") || \"\");\n        const ids = ($(el).attr(\"id\") || \"\") + \" \" + ($(el).parent().attr(\"id\") || \"\");\n        const hay = classes + \" \" + ids;\n        if (/product|gallery|thumb|image|slider|carousel/i.test(hay)) {\n            imageSet.add(src);\n        }\n    });\n    // Additional extraction: attempt to fetch the Shopify .js endpoint for\n    // richer product data. Many Shopify stores expose a JSON file at\n    // <product-url>.js which contains an array of image URLs and the\n    // featured image. If the request fails or the response is not JSON,\n    // we silently ignore it. We prefix protocol-relative URLs with\n    // https: to ensure absolute paths. Any images found here are added\n    // to imageSet. This logic mirrors the working implementation from\n    // the provided reference package. It avoids slicing the JSON by\n    // braces and instead lets JSON.parse handle the string.\n    try {\n        const jsUrl = url.endsWith(\".js\") ? url : `${url}.js`;\n        const jsResp = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(jsUrl, {\n            headers: {\n                \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0 Safari/537.36\"\n            },\n            maxRedirects: 3\n        });\n        const jsData = jsResp.data;\n        // If response is a string, attempt to parse JSON; if it's already\n        // an object we can process it directly. Some platforms escape\n        // unicode sequences, but JSON.parse will handle them.\n        const parsedData = typeof jsData === \"string\" ? JSON.parse(jsData) : typeof jsData === \"object\" ? jsData : null;\n        if (parsedData && typeof parsedData === \"object\") {\n            // Extract images array\n            const imgs = parsedData.images;\n            if (Array.isArray(imgs)) {\n                for (const p of imgs){\n                    if (typeof p === \"string\" && p) {\n                        const imgUrl = p.startsWith(\"//\") ? `https:${p}` : p;\n                        if (/^https?:\\/\\//i.test(imgUrl)) {\n                            imageSet.add(imgUrl);\n                        }\n                    }\n                }\n            }\n            // Extract featured image\n            const feat = parsedData.featured_image;\n            if (typeof feat === \"string\" && feat) {\n                const full = feat.startsWith(\"//\") ? `https:${feat}` : feat;\n                if (/^https?:\\/\\//i.test(full)) {\n                    imageSet.add(full);\n                }\n            }\n        }\n    } catch (err) {\n    // Silently ignore errors; the JSON endpoint may not exist or may not\n    // return valid JSON. In such cases we simply rely on images\n    // extracted from the HTML and JSON-LD.\n    }\n    // Assign images array if more than one image is found\n    const imagesArr = Array.from(imageSet);\n    if (imagesArr.length > 0) {\n        // Assign the images directly from imageSet. The imageSet itself\n        // already deduplicates exact URLs while preserving insertion order.\n        // We no longer deduplicate by base path (query parameters) because\n        // some stores use the same base for different images. Instead we\n        // preserve all unique URLs. We still move the primary image to\n        // the front of the array if it exists and is not already first.\n        let deduped = imagesArr;\n        if (product.image) {\n            const index = deduped.findIndex((i)=>i === product.image);\n            if (index > 0) {\n                const [img] = deduped.splice(index, 1);\n                deduped.unshift(img);\n            } else if (index === -1) {\n                deduped.unshift(product.image);\n            }\n        }\n        product.images = deduped;\n    }\n    return product;\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNGO0lBQ0YsRUFBRSxPQUFPQyxLQUFLO0lBQ1oscUVBQXFFO0lBQ3JFLDREQUE0RDtJQUM1RCx1Q0FBdUM7SUFDekM7SUFDQSxzREFBc0Q7SUFDdEQsTUFBTUMsWUFBWXRGLE1BQU11RixJQUFJLENBQUN2QjtJQUM3QixJQUFJc0IsVUFBVTlCLE1BQU0sR0FBRyxHQUFHO1FBQ3hCLGdFQUFnRTtRQUNoRSxvRUFBb0U7UUFDcEUsbUVBQW1FO1FBQ25FLGlFQUFpRTtRQUNqRSwrREFBK0Q7UUFDL0QsZ0VBQWdFO1FBQ2hFLElBQUlnQyxVQUFvQkY7UUFDeEIsSUFBSXZELFFBQVFMLEtBQUssRUFBRTtZQUNqQixNQUFNK0QsUUFBUUQsUUFBUUUsU0FBUyxDQUFDLENBQUNDLElBQU1BLE1BQU01RCxRQUFRTCxLQUFLO1lBQzFELElBQUkrRCxRQUFRLEdBQUc7Z0JBQ2IsTUFBTSxDQUFDdEIsSUFBSSxHQUFHcUIsUUFBUUksTUFBTSxDQUFDSCxPQUFPO2dCQUNwQ0QsUUFBUUssT0FBTyxDQUFDMUI7WUFDbEIsT0FBTyxJQUFJc0IsVUFBVSxDQUFDLEdBQUc7Z0JBQ3ZCRCxRQUFRSyxPQUFPLENBQUM5RCxRQUFRTCxLQUFLO1lBQy9CO1FBQ0Y7UUFDQUssUUFBUUcsTUFBTSxHQUFHc0Q7SUFDbkI7SUFFQSxPQUFPekQ7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL2VkbS1idWlsZGVyLy4vbGliL3BhcnNlci50cz80YTYxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XG5pbXBvcnQgKiBhcyBjaGVlcmlvIGZyb20gJ2NoZWVyaW8nO1xuXG4vKipcbiAqIFNoYXBlIG9mIHRoZSBpbmZvcm1hdGlvbiB3ZSBjYXJlIGFib3V0IGZyb20gYSBwcm9kdWN0IHBhZ2UuXG4gKlxuICogVGhlc2UgZmllbGRzIG1pcnJvciB0aGUgcGxhY2Vob2xkZXJzIHVzZWQgaW4gdGVtcGxhdGVzLiBTb21lXG4gKiBmaWVsZHMgYXJlIG9wdGlvbmFsIGJlY2F1c2Ugbm90IGV2ZXJ5IHBhZ2Ugd2lsbCBleHBvc2UgdGhlbS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQcm9kdWN0RGF0YSB7XG4gIC8qKlxuICAgKiBPcmlnaW5hbCBVUkwgb2YgdGhlIHByb2R1Y3QuIFdoZW4gdGhlIG1vZHVsZSBpcyByZW5kZXJlZCB0aGlzXG4gICAqIHNob3VsZCBiZSB1c2VkIGZvciB0aGUgQ1RBIGxpbmsuXG4gICAqL1xuICB1cmw6IHN0cmluZztcbiAgLyoqXG4gICAqIE9wdGlvbmFsIHNob3J0IHByZWZpeCBvciBjb2xsZWN0aW9uIG5hbWUgZm9yIGEgcHJvZHVjdC4gU29tZVxuICAgKiBzaXRlcyBzdXJmYWNlIHRoaXMgYWJvdmUgdGhlIG1haW4gcHJvZHVjdCBuYW1lLiBJZiBtaXNzaW5nIHRoZVxuICAgKiB2YWx1ZSB3aWxsIGJlIGFuIGVtcHR5IHN0cmluZy5cbiAgICovXG4gIHByZXRpdGxlOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBNYWluIHByb2R1Y3QgbmFtZS5cbiAgICovXG4gIHRpdGxlOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBQcmljZSBzdHJpbmcsIGZvciBleGFtcGxlIOKAnCQxOTkuOTUgQVVE4oCdLiBFbXB0eSB3aGVuIG5vdCBmb3VuZC5cbiAgICovXG4gIHByaWNlOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIE9yaWdpbmFsIChjb21wYXJl4oCRYXQpIHByaWNlIGJlZm9yZSBhbnkgZGlzY291bnQuIE9wdGlvbmFsIGJlY2F1c2VcbiAgICogbWFueSBwYWdlcyBkbyBub3Qgc2hvdyBhIHN0cmlrZeKAkXRocm91Z2ggcHJpY2UuIFdoZW4gcHJlc2VudCB0aGVcbiAgICogcHJpY2VIdG1sIGhlbHBlciBpbiB0aGUgZnJvbnQgZW5kIHdpbGwgcmVuZGVyIHRoaXMgdmFsdWUgZmlyc3RcbiAgICogZm9sbG93ZWQgYnkgdGhlIHNhbGUgcHJpY2UuIFRoZSB2YWx1ZSBzaG91bGQgbm90IGluY2x1ZGUgYVxuICAgKiBjdXJyZW5jeSBzeW1ib2wuXG4gICAqL1xuICBvcmlnaW5hbFByaWNlPzogc3RyaW5nO1xuICAvKipcbiAgICogU2hvcnQgZGVzY3JpcHRpb24gb2YgdGhlIHByb2R1Y3QuXG4gICAqL1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAvKipcbiAgICogUHJpbWFyeSBpbWFnZSBmb3IgdGhlIHByb2R1Y3QuIFNob3VsZCBiZSBhIGZ1bGx5IHF1YWxpZmllZCBVUkwuXG4gICAqL1xuICBpbWFnZTogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBMaXN0IG9mIGFsbCBpbWFnZSBVUkxzIGZvdW5kIGZvciB0aGUgcHJvZHVjdC4gVGhlIGZpcnN0IGVudHJ5XG4gICAqIHNob3VsZCBtYXRjaCB0aGUgcHJpbWFyeSBpbWFnZS4gVGhpcyBpcyB1c2VkIHRvIGFsbG93IHVzZXJzIHRvXG4gICAqIHN3YXAgaW1hZ2VzIGluIHRoZSBwcmV2aWV3LiBTb21lIHBhZ2VzIHByb3ZpZGUgbXVsdGlwbGUgYW5nbGVzXG4gICAqIG9yIGNvbG91ciB2YXJpYW50cy4gT25seSBhYnNvbHV0ZSBVUkxzIGFyZSBpbmNsdWRlZC5cbiAgICovXG4gIGltYWdlcz86IHN0cmluZ1tdO1xuICAvKipcbiAgICogT3B0aW9uYWwgYXJyYXkgb2YgY29sb3VyIHN3YXRjaCBoZXggY29kZXMuIExlZnQgZW1wdHkgd2hlbiBub25lXG4gICAqIGNvdWxkIGJlIGRldGVjdGVkLlxuICAgKi9cbiAgY29sb3JzOiBzdHJpbmdbXTtcbiAgLyoqXG4gICAqIENUQSBVUkw7IHR5cGljYWxseSBpZGVudGljYWwgdG8gdGhlIHByb2R1Y3QgVVJMIGJ1dCBtYXkgYmVcbiAgICogb3ZlcnJpZGRlbiBieSB0aGUgY2FsbGluZyBjb2RlIGlmIG5lZWRlZC5cbiAgICovXG4gIGN0YTogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBMYWJlbCBmb3IgdGhlIGNhbGzigJF0b+KAkWFjdGlvbiBidXR0b24uIERlZmF1bHRzIHRvIFwiU0hPUCBOT1dcIiBpZlxuICAgKiBub3QgcHJvdmlkZWQuIEFsbG93cyB1c2VycyB0byBjdXN0b21pc2UgdGhlIGJ1dHRvbiB3b3JkaW5nIGluXG4gICAqIHRoZSBwcmV2aWV3IGFuZCBoYXZlIHRob3NlIGNoYW5nZXMgcmVmbGVjdGVkIGluIHRoZSBnZW5lcmF0ZWRcbiAgICogSFRNTC4gT3B0aW9uYWwgYmVjYXVzZSBzb21lIHBhcnNpbmcgc2NlbmFyaW9zIG1heSBub3Qgc2V0IGl0LlxuICAgKi9cbiAgY3RhTGFiZWw/OiBzdHJpbmc7XG59XG5cbi8qKlxuICogQXR0ZW1wdCB0byBwYXJzZSBzdHJ1Y3R1cmVkIEpTT04tTEQgZGF0YSBmcm9tIHRoZSBwYWdlLiBNYW55XG4gKiBl4oCRY29tbWVyY2UgcGxhdGZvcm1zIGVtYmVkIGFuIG9iamVjdCB3aXRoIHRoZSBzY2hlbWEub3JnXG4gKiBQcm9kdWN0IHR5cGUuIFRoaXMgaGVscGVyIGV4dHJhY3RzIGl0IGlmIHByZXNlbnQuXG4gKi9cbmZ1bmN0aW9uIHBhcnNlTGRKc29uKCQ6IGNoZWVyaW8uQ2hlZXJpb0FQSSk6IFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsIHtcbiAgY29uc3Qgc2NyaXB0cyA9ICQoJ3NjcmlwdFt0eXBlPVwiYXBwbGljYXRpb24vbGQranNvblwiXScpLnRvQXJyYXkoKTtcbiAgZm9yIChjb25zdCBlbCBvZiBzY3JpcHRzKSB7XG4gICAgY29uc3QgY29udGVudHMgPSAkKGVsKS5jb250ZW50cygpLnRleHQoKTtcbiAgICBpZiAoIWNvbnRlbnRzKSBjb250aW51ZTtcbiAgICB0cnkge1xuICAgICAgY29uc3QganNvbiA9IEpTT04ucGFyc2UoY29udGVudHMudHJpbSgpKTtcbiAgICAgIC8vIFNvbWV0aW1lcyBtdWx0aXBsZSBvYmplY3RzIGFyZSB3cmFwcGVkIGluIGFuIGFycmF5LlxuICAgICAgY29uc3QgY2FuZGlkYXRlcyA9IEFycmF5LmlzQXJyYXkoanNvbikgPyBqc29uIDogW2pzb25dO1xuICAgICAgZm9yIChjb25zdCBvYmogb2YgY2FuZGlkYXRlcykge1xuICAgICAgICBpZiAob2JqWydAdHlwZSddID09PSAnUHJvZHVjdCcpIHtcbiAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoXykge1xuICAgICAgLy8gaWdub3JlIEpTT04gcGFyc2UgZXJyb3JzIGFuZCBjb250aW51ZS5cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogR2VuZXJpYyBoZWxwZXIgdG8gZXh0cmFjdCBhIG1ldGEgdGFnIHZhbHVlLiBJdCBmaXJzdCB0cmllcyB0b1xuICogbWF0Y2ggdGhlIGdpdmVuIHByb3BlcnR5IG9uIHRoZSBgbWV0YVtwcm9wZXJ0eV1gIGF0dHJpYnV0ZSAoYXMgdXNlZFxuICogYnkgT3BlbiBHcmFwaCksIHRoZW4gZmFsbHMgYmFjayB0byBgbWV0YVtuYW1lXWAuXG4gKi9cbmZ1bmN0aW9uIGdldE1ldGEoJDogY2hlZXJpby5DaGVlcmlvQVBJLCBwcm9wOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgcmV0dXJuIChcbiAgICAkKGBtZXRhW3Byb3BlcnR5PScke3Byb3B9J11gKS5hdHRyKCdjb250ZW50JykgfHxcbiAgICAkKGBtZXRhW25hbWU9JyR7cHJvcH0nXWApLmF0dHIoJ2NvbnRlbnQnKSB8fFxuICAgIG51bGxcbiAgKTtcbn1cblxuLyoqXG4gKiBGZXRjaCBhIHByb2R1Y3QgcGFnZSBhbmQgZXh0cmFjdCBiYXNpYyBmaWVsZHMgdXNpbmcgaGV1cmlzdGljcy4gVGhpc1xuICogZnVuY3Rpb24gZG9lcyBub3QgYXR0ZW1wdCB0byBkZWVwbHkgY3Jhd2wgdGhlIERPTTsgaW5zdGVhZCBpdCByZWxpZXNcbiAqIG9uIE9wZW4gR3JhcGggdGFncywgSlNPTuKAkUxEIGFuZCBjb21tb24gbWljcm9kYXRhIGF0dHJpYnV0ZXMuIElmIGFcbiAqIGZpZWxkIGNhbm5vdCBiZSByZXNvbHZlZCBpdCB3aWxsIGJlIHJldHVybmVkIGFzIGFuIGVtcHR5IHN0cmluZy5cbiAqXG4gKiBJZiB0aGUgcmVxdWVzdCBmYWlscyBmb3Igd2hhdGV2ZXIgcmVhc29uIHRoZSByZXN1bHRpbmcgb2JqZWN0IHdpbGxcbiAqIGNvbnRhaW4gZW1wdHkgc3RyaW5ncyBmb3IgYWxsIHByb3BlcnRpZXMgZXhjZXB0IHVybCBhbmQgY3RhLlxuICpcbiAqIEBwYXJhbSB1cmwgUHJvZHVjdCBwYWdlIFVSTFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcGFyc2VQcm9kdWN0KHVybDogc3RyaW5nKTogUHJvbWlzZTxQcm9kdWN0RGF0YT4ge1xuICBjb25zdCBjbGVhbiA9ICh2YWx1ZTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCk6IHN0cmluZyA9PlxuICAgICh2YWx1ZSB8fCAnJykudG9TdHJpbmcoKS50cmltKCk7XG5cbiAgbGV0IGh0bWwgPSAnJztcbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldCh1cmwsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgLy8gU2V0IGEgdXNlciBhZ2VudCBzbyB0aGF0IHNvbWUgc2l0ZXMgZG9u4oCZdCBibG9jayBvdXIgcmVxdWVzdC5cbiAgICAgICAgJ1VzZXItQWdlbnQnOlxuICAgICAgICAgICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTE2LjAgU2FmYXJpLzUzNy4zNidcbiAgICAgIH0sXG4gICAgICAvLyBGb2xsb3cgcmVkaXJlY3RzIGF1dG9tYXRpY2FsbHkuXG4gICAgICBtYXhSZWRpcmVjdHM6IDNcbiAgICB9KTtcbiAgICBodG1sID0gcmVzcG9uc2UuZGF0YTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggJHt1cmx9OmAsIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogZXJyb3IpO1xuICAgIHJldHVybiB7XG4gICAgICB1cmwsXG4gICAgICBwcmV0aXRsZTogJycsXG4gICAgICB0aXRsZTogJycsXG4gICAgICBwcmljZTogJycsXG4gICAgICBkZXNjcmlwdGlvbjogJycsXG4gICAgICBpbWFnZTogJycsXG4gICAgICBjb2xvcnM6IFtdLFxuICAgICAgY3RhOiB1cmxcbiAgICB9O1xuICB9XG5cbiAgY29uc3QgJCA9IGNoZWVyaW8ubG9hZChodG1sKTtcblxuICAvLyBBdHRlbXB0IHRvIHBhcnNlIEpTT07igJFMRCBzdHJ1Y3R1cmVkIGRhdGEgZmlyc3QgYmVjYXVzZSBpdCB0eXBpY2FsbHlcbiAgLy8gcHJvdmlkZXMgdGhlIHJpY2hlc3QgaW5mb3JtYXRpb24uIFdlIGZhbGwgYmFjayB0byBtZXRhIHRhZ3MgaWZcbiAgLy8gc3RydWN0dXJlZCBkYXRhIGlzIG5vdCBwcmVzZW50IG9yIGluY29tcGxldGUuXG4gIGNvbnN0IGxkID0gcGFyc2VMZEpzb24oJCkgfHwge307XG4gIGNvbnN0IHByb2R1Y3Q6IFByb2R1Y3REYXRhID0ge1xuICAgIHVybCxcbiAgICBwcmV0aXRsZTogJycsXG4gICAgdGl0bGU6ICcnLFxuICAgIHByaWNlOiAnJyxcbiAgICBvcmlnaW5hbFByaWNlOiB1bmRlZmluZWQsXG4gICAgZGVzY3JpcHRpb246ICcnLFxuICAgIGltYWdlOiAnJyxcbiAgICBjb2xvcnM6IFtdLFxuICAgIGltYWdlczogdW5kZWZpbmVkLFxuICAgIGN0YTogdXJsXG4gICAgLFxuICAgIC8vIERlZmF1bHQgY2FsbC10by1hY3Rpb24gbGFiZWwuIFVzZXJzIGNhbiBvdmVycmlkZSB0aGlzIGluIHRoZVxuICAgIC8vIHByZXZpZXcgYnkgZWRpdGluZyB0aGUgQ1RBIHRleHQuIElmIG5vdCBwcm92aWRlZCwgdGVtcGxhdGVzXG4gICAgLy8gd2lsbCBmYWxsIGJhY2sgdG8gdGhpcyB2YWx1ZS5cbiAgICBjdGFMYWJlbDogJ1NIT1AgTk9XJ1xuICB9O1xuXG4gIC8vIFRpdGxlXG4gIHByb2R1Y3QudGl0bGUgPVxuICAgIGNsZWFuKGxkLm5hbWUpIHx8XG4gICAgY2xlYW4oZ2V0TWV0YSgkLCAnb2c6dGl0bGUnKSkgfHxcbiAgICBjbGVhbihnZXRNZXRhKCQsICd0d2l0dGVyOnRpdGxlJykpIHx8XG4gICAgY2xlYW4oJCgndGl0bGUnKS5maXJzdCgpLnRleHQoKSk7XG5cbiAgLy8gRGVzY3JpcHRpb25cbiAgcHJvZHVjdC5kZXNjcmlwdGlvbiA9XG4gICAgY2xlYW4obGQuZGVzY3JpcHRpb24pIHx8XG4gICAgY2xlYW4oZ2V0TWV0YSgkLCAnb2c6ZGVzY3JpcHRpb24nKSkgfHxcbiAgICBjbGVhbihnZXRNZXRhKCQsICd0d2l0dGVyOmRlc2NyaXB0aW9uJykpIHx8XG4gICAgY2xlYW4oZ2V0TWV0YSgkLCAnZGVzY3JpcHRpb24nKSk7XG5cbiAgLy8gSW1hZ2VcbiAgY29uc3QgbGRJbWFnZTogc3RyaW5nIHwgdW5kZWZpbmVkID0gQXJyYXkuaXNBcnJheShsZC5pbWFnZSlcbiAgICA/IGxkLmltYWdlWzBdXG4gICAgOiB0eXBlb2YgbGQuaW1hZ2UgPT09ICdzdHJpbmcnXG4gICAgPyBsZC5pbWFnZVxuICAgIDogdW5kZWZpbmVkO1xuICBwcm9kdWN0LmltYWdlID1cbiAgICBjbGVhbihsZEltYWdlKSB8fFxuICAgIGNsZWFuKGdldE1ldGEoJCwgJ29nOmltYWdlJykpIHx8XG4gICAgY2xlYW4oZ2V0TWV0YSgkLCAndHdpdHRlcjppbWFnZScpKSB8fFxuICAgIGNsZWFuKCQoJ2ltZycpLmZpcnN0KCkuYXR0cignc3JjJykpO1xuXG4gIC8vIFByaWNlXG4gIGNvbnN0IGxkT2ZmZXJzID0gbGQub2ZmZXJzO1xuICBsZXQgbGRQcmljZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICBpZiAobGRPZmZlcnMpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShsZE9mZmVycykpIHtcbiAgICAgIGxkUHJpY2UgPSBsZE9mZmVyc1swXT8ucHJpY2U7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgbGRPZmZlcnMgPT09ICdvYmplY3QnKSB7XG4gICAgICBsZFByaWNlID0gbGRPZmZlcnMucHJpY2U7XG4gICAgfVxuICB9XG4gIHByb2R1Y3QucHJpY2UgPVxuICAgIGNsZWFuKGxkUHJpY2UpIHx8XG4gICAgY2xlYW4oZ2V0TWV0YSgkLCAncHJvZHVjdDpwcmljZTphbW91bnQnKSkgfHxcbiAgICBjbGVhbihnZXRNZXRhKCQsICdvZzpwcmljZTphbW91bnQnKSkgfHxcbiAgICAvLyBUcnkgdG8gbWF0Y2ggbWljcm9kYXRhIG9uIHNpdGVzIGxpa2UgU2hvcGlmeTogW2l0ZW1wcm9wPVwicHJpY2VcIl1cbiAgICBjbGVhbigkKCdbaXRlbXByb3A9XCJwcmljZVwiXScpLmZpcnN0KCkudGV4dCgpKTtcblxuICAvLyBPcmlnaW5hbCBwcmljZTogYXR0ZW1wdCB0byBmaW5kIGEgY29tcGFyZeKAkWF0IG9yIHN0cmlrZeKAkXRocm91Z2ggcHJpY2UuIFRoaXNcbiAgLy8gY2FuIGFwcGVhciBpbiBKU09O4oCRTEQgYXMgYW4gXCJwcmljZVNwZWNpZmljYXRpb25cIiB3aXRoXG4gIC8vIFwicHJpY2VDdXJyZW5jeVwiIGFuZCBcInZhbHVlXCIsIG9yIGluIHRoZSBET00gYXMgPGRlbD4gb3IgYSBzcGFuIHdpdGhcbiAgLy8gY2xhc3MgY29udGFpbmluZyBcImNvbXBhcmVcIiBvciBcInN0cmlrZVwiLiBXZSBhdHRlbXB0IHNldmVyYWwgaGV1cmlzdGljc1xuICAvLyBhbmQgdGFrZSB0aGUgZmlyc3QgbnVtZXJpYyB2YWx1ZSB3ZSBmaW5kLiBUaGUgdmFsdWUgcmV0dXJuZWQgZG9lc1xuICAvLyBub3QgaW5jbHVkZSB0aGUgY3VycmVuY3kgc3ltYm9sLlxuICBsZXQgb3JpZ2luYWw6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgLy8gQ2hlY2sgSlNPTuKAkUxEIG9mZmVycy5jb21wYXJlUHJpY2UgaWYgcHJlc2VudFxuICBpZiAobGRPZmZlcnMpIHtcbiAgICAvLyBTb21lIHNjaGVtYXMgbmVzdCBjb21wYXJlQXRQcmljZSBvciBvcmlnaW5hbFByaWNlXG4gICAgY29uc3QgZ2V0Q29tcGFyZSA9IChvYmo6IGFueSk6IHN0cmluZyB8IHVuZGVmaW5lZCA9PiB7XG4gICAgICBpZiAoIW9iaikgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIHJldHVybiBvYmouY29tcGFyZUF0UHJpY2UgfHwgb2JqLm9yaWdpbmFsUHJpY2UgfHwgb2JqLnByaWNlU3BlY2lmaWNhdGlvbj8ucHJpY2U7XG4gICAgfTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShsZE9mZmVycykpIHtcbiAgICAgIGZvciAoY29uc3Qgb2ZmIG9mIGxkT2ZmZXJzKSB7XG4gICAgICAgIGNvbnN0IHZhbCA9IGdldENvbXBhcmUob2ZmKTtcbiAgICAgICAgaWYgKHZhbCkge1xuICAgICAgICAgIG9yaWdpbmFsID0gY2xlYW4odmFsKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIGxkT2ZmZXJzID09PSAnb2JqZWN0Jykge1xuICAgICAgY29uc3QgdmFsID0gZ2V0Q29tcGFyZShsZE9mZmVycyk7XG4gICAgICBpZiAodmFsKSB7XG4gICAgICAgIG9yaWdpbmFsID0gY2xlYW4odmFsKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYgKCFvcmlnaW5hbCkge1xuICAgIC8vIExvb2sgZm9yIGVsZW1lbnRzIGNvbnRhaW5pbmcgYSBwcmljZSB3aXRoIGEgbGluZeKAkXRocm91Z2ggc3R5bGUgb3IgYVxuICAgIC8vIGNsYXNzIGluZGljYXRpbmcgXCJjb21wYXJlXCIgb3IgXCJvcmlnaW5hbFwiLiBXZSBleHRyYWN0IG51bWVyaWNcbiAgICAvLyB2YWx1ZXMgKGRpZ2l0cyBhbmQgZGVjaW1hbCBzZXBhcmF0b3JzKS5cbiAgICBjb25zdCBwcmljZVJlZ2V4ID0gLyhbXFxkLC5dKylcXHMqKD86W0EtWl17M30pPy87XG4gICAgLy8gaGVscGVyIHRvIHBhcnNlIHRleHRcbiAgICBjb25zdCBwYXJzZVByaWNlVGV4dCA9ICh0ZXh0OiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IG1hdGNoID0gcHJpY2VSZWdleC5leGVjKHRleHQpO1xuICAgICAgcmV0dXJuIG1hdGNoID8gbWF0Y2hbMV0gOiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICAvLyBDaGVjayA8ZGVsPiBlbGVtZW50c1xuICAgICQoJ2RlbCwgc3RyaWtlJykuZWFjaCgoXywgZWwpID0+IHtcbiAgICAgIGNvbnN0IHRleHQgPSAkKGVsKS50ZXh0KCk7XG4gICAgICBjb25zdCB2YWwgPSBwYXJzZVByaWNlVGV4dCh0ZXh0KTtcbiAgICAgIGlmICh2YWwpIHtcbiAgICAgICAgb3JpZ2luYWwgPSBjbGVhbih2YWwpO1xuICAgICAgICByZXR1cm4gZmFsc2U7IC8vIGJyZWFrIHRoZSBsb29wXG4gICAgICB9XG4gICAgfSk7XG4gICAgLy8gQ2hlY2sgZWxlbWVudHMgd2l0aCBjbGFzcyBjb250YWluaW5nIGNvbXBhcmUgb3Igb3JpZ2luYWxcbiAgICBpZiAoIW9yaWdpbmFsKSB7XG4gICAgICAkKCdbY2xhc3MqPVwiY29tcGFyZVwiXSxbY2xhc3MqPVwib3JpZ2luYWxcIl0sW2NsYXNzKj1cInN0cmlrZVwiXScpLmVhY2goKF8sIGVsKSA9PiB7XG4gICAgICAgIGNvbnN0IHRleHQgPSAkKGVsKS50ZXh0KCk7XG4gICAgICAgIGNvbnN0IHZhbCA9IHBhcnNlUHJpY2VUZXh0KHRleHQpO1xuICAgICAgICBpZiAodmFsKSB7XG4gICAgICAgICAgb3JpZ2luYWwgPSBjbGVhbih2YWwpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIC8vIEFzc2lnbiBvcmlnaW5hbFByaWNlIGlmIGZvdW5kIGFuZCBkaWZmZXJlbnQgZnJvbSBzYWxlIHByaWNlXG4gIGlmIChvcmlnaW5hbCAmJiBvcmlnaW5hbCAhPT0gcHJvZHVjdC5wcmljZSkge1xuICAgIHByb2R1Y3Qub3JpZ2luYWxQcmljZSA9IG9yaWdpbmFsO1xuICB9XG5cbiAgLy8gUHJldGl0bGU6IG5vdCB3aWRlbHkgYXZhaWxhYmxlLiBBcyBhIGhldXJpc3RpYywgaWYgdGhlIHRpdGxlXG4gIC8vIGNvbnRhaW5zIGEgaHlwaGVuLCBzcGxpdCB0aGUgZmlyc3QgcGFydCBhcyBwcmV0aXRsZSBhbmQgdGhlIHJlc3RcbiAgLy8gYXMgdGhlIGFjdHVhbCB0aXRsZS5cbiAgaWYgKHByb2R1Y3QudGl0bGUgJiYgcHJvZHVjdC50aXRsZS5pbmNsdWRlcygnIOKAkyAnKSkge1xuICAgIGNvbnN0IHBhcnRzID0gcHJvZHVjdC50aXRsZS5zcGxpdCgvXFxzK+KAk1xccysvKTtcbiAgICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xuICAgICAgcHJvZHVjdC5wcmV0aXRsZSA9IHBhcnRzWzBdO1xuICAgICAgcHJvZHVjdC50aXRsZSA9IHBhcnRzLnNsaWNlKDEpLmpvaW4oJyDigJMgJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gQ29sb3VyczogYXR0ZW1wdCB0byBmaW5kIGNvbG91ciBzd2F0Y2ggZWxlbWVudHMuIE1hbnkgZWNvbW1lcmNlXG4gIC8vIHBsYXRmb3JtcyB1c2UgaW5saW5lIHN0eWxlcyBvciBiYWNrZ3JvdW5kIGNvbG91cnMgdG8gZGVmaW5lIHN3YXRjaFxuICAvLyBlbGVtZW50cy4gV2UgbG9vayBmb3IgYW55IGVsZW1lbnRzIHdpdGggYSBiYWNrZ3JvdW5kIGNvbG91ciBzdHlsZVxuICAvLyBhbmQgZXh0cmFjdCB0aGUgaGV4IGNvZGUuIFRoZSBjb2xvdXJzIGFyZSBjb2xsZWN0ZWQgaW4gdGhlIG9yZGVyXG4gIC8vIHRoZXkgYXBwZWFyIGluIHRoZSBET00gYW5kIGRlZHVwbGljYXRlZCB3aGlsZSBwcmVzZXJ2aW5nIHRoYXQgb3JkZXIuXG4gIGNvbnN0IGNvbG91cnNGb3VuZDogc3RyaW5nW10gPSBbXTtcbiAgJCgnW3N0eWxlXScpLmVhY2goKF8sIGVsKSA9PiB7XG4gICAgY29uc3Qgc3R5bGUgPSAkKGVsKS5hdHRyKCdzdHlsZScpO1xuICAgIGlmICghc3R5bGUpIHJldHVybjtcbiAgICBjb25zdCBtYXRjaCA9IC9iYWNrZ3JvdW5kKD86LWNvbG9yKT9cXHMqOlxccyooW147XSspOz8vaS5leGVjKHN0eWxlKTtcbiAgICBpZiAoIW1hdGNoKSByZXR1cm47XG4gICAgY29uc3QgY29sb3VyID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgIC8vIE9ubHkgYWNjZXB0IHNpbXBsZSBoZXggY29kZXMgKDMgb3IgNiBoZXggZGlnaXRzKS4gSWdub3JlIG90aGVyXG4gICAgLy8gZm9ybWF0cyBzdWNoIGFzIHJnYigpIHNvIHRoZSBwcmV2aWV3IGRpc3BsYXlzIGNvbnNpc3RlbnQgc3dhdGNoZXMuXG4gICAgaWYgKC9eIyhbMC05YS1mQS1GXXszfXxbMC05YS1mQS1GXXs2fSkvLnRlc3QoY29sb3VyKSkge1xuICAgICAgLy8gU2tpcCB2ZXJ5IGxpZ2h0IGNvbG91cnMgKHdoaXRlL29mZi13aGl0ZSBiYWNrZ3JvdW5kcykgYXMgdGhlc2VcbiAgICAgIC8vIGFyZSBjb21tb25seSB1c2VkIGZvciBjb250YWluZXIgYmFja2dyb3VuZHMgcmF0aGVyIHRoYW4gc3dhdGNoZXMuXG4gICAgICBpZiAoL14oIz9mZmYoPzpmZmYpP3wjP2Y3ZjdmNykkL2kudGVzdChjb2xvdXIpKSByZXR1cm47XG4gICAgICBpZiAoIWNvbG91cnNGb3VuZC5pbmNsdWRlcyhjb2xvdXIpKSB7XG4gICAgICAgIGNvbG91cnNGb3VuZC5wdXNoKGNvbG91cik7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgcHJvZHVjdC5jb2xvcnMgPSBjb2xvdXJzRm91bmQ7XG5cbiAgLy8gSW1hZ2VzOiBjb2xsZWN0IGFkZGl0aW9uYWwgaW1hZ2UgVVJMcyBiZXlvbmQgdGhlIHByaW1hcnkgaW1hZ2UuIFdlXG4gIC8vIHN0YXJ0IHdpdGggdGhlIHByaW1hcnkgaW1hZ2UgaWYgaXQgZXhpc3RzLiBUaGVuIHNlYXJjaCBmb3IgaW1hZ2VcbiAgLy8gZWxlbWVudHMgdGhhdCBhcmUgbGlrZWx5IHBhcnQgb2YgdGhlIHByb2R1Y3QgZ2FsbGVyeS4gSGV1cmlzdGljc1xuICAvLyBpbmNsdWRlIGNsYXNzIG5hbWVzIGNvbnRhaW5pbmcgXCJwcm9kdWN0XCIsIFwiZ2FsbGVyeVwiLCBcInRodW1iXCIsIG9yXG4gIC8vIFwiaW1hZ2VcIi4gV2UgYWxzbyBhY2NlcHQgSlNPTuKAkUxEIGltYWdlIGFycmF5cy4gT25seSBhYnNvbHV0ZVxuICAvLyBVUkxzIChodHRwIG9yIGh0dHBzKSBhcmUga2VwdCBhbmQgZHVwbGljYXRlcyByZW1vdmVkLlxuICBjb25zdCBpbWFnZVNldCA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICBpZiAocHJvZHVjdC5pbWFnZSkge1xuICAgIGltYWdlU2V0LmFkZChwcm9kdWN0LmltYWdlKTtcbiAgfVxuICAvLyBBZGQgYW55IGFkZGl0aW9uYWwgaW1hZ2VzIGZyb20gSlNPTuKAkUxEXG4gIGlmIChBcnJheS5pc0FycmF5KGxkLmltYWdlKSkge1xuICAgIGZvciAoY29uc3QgaW1nIG9mIGxkLmltYWdlKSB7XG4gICAgICBpZiAodHlwZW9mIGltZyA9PT0gJ3N0cmluZycgJiYgL15odHRwcz86XFwvXFwvL2kudGVzdChpbWcpKSB7XG4gICAgICAgIGltYWdlU2V0LmFkZChpbWcpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAvLyBET00gZXh0cmFjdGlvbjogZmluZCBpbWFnZXMgd2l0aCByZWxldmFudCBjbGFzcyBoaW50c1xuICAkKCdpbWcnKS5lYWNoKChfLCBlbCkgPT4ge1xuICAgIGNvbnN0IHNyYyA9IGNsZWFuKCQoZWwpLmF0dHIoJ3NyYycpKTtcbiAgICBpZiAoIXNyYykgcmV0dXJuO1xuICAgIC8vIE9ubHkgYWNjZXB0IGFic29sdXRlIFVSTHNcbiAgICBpZiAoIS9eaHR0cHM/OlxcL1xcLy9pLnRlc3Qoc3JjKSkgcmV0dXJuO1xuICAgIC8vIEFjY2VwdCBpbWFnZXMgaWYgdGhleSBjb250YWluIGNlcnRhaW4ga2V5d29yZHMgaW4gdGhlaXIgY2xhc3Mgb3IgaWRcbiAgICBjb25zdCBjbGFzc2VzID0gKCQoZWwpLmF0dHIoJ2NsYXNzJykgfHwgJycpICsgJyAnICsgKCQoZWwpLnBhcmVudCgpLmF0dHIoJ2NsYXNzJykgfHwgJycpO1xuICAgIGNvbnN0IGlkcyA9ICgkKGVsKS5hdHRyKCdpZCcpIHx8ICcnKSArICcgJyArICgkKGVsKS5wYXJlbnQoKS5hdHRyKCdpZCcpIHx8ICcnKTtcbiAgICBjb25zdCBoYXkgPSBjbGFzc2VzICsgJyAnICsgaWRzO1xuICAgIGlmICgvcHJvZHVjdHxnYWxsZXJ5fHRodW1ifGltYWdlfHNsaWRlcnxjYXJvdXNlbC9pLnRlc3QoaGF5KSkge1xuICAgICAgaW1hZ2VTZXQuYWRkKHNyYyk7XG4gICAgfVxuICB9KTtcblxuICAvLyBBZGRpdGlvbmFsIGV4dHJhY3Rpb246IGF0dGVtcHQgdG8gZmV0Y2ggdGhlIFNob3BpZnkgLmpzIGVuZHBvaW50IGZvclxuICAvLyByaWNoZXIgcHJvZHVjdCBkYXRhLiBNYW55IFNob3BpZnkgc3RvcmVzIGV4cG9zZSBhIEpTT04gZmlsZSBhdFxuICAvLyA8cHJvZHVjdC11cmw+LmpzIHdoaWNoIGNvbnRhaW5zIGFuIGFycmF5IG9mIGltYWdlIFVSTHMgYW5kIHRoZVxuICAvLyBmZWF0dXJlZCBpbWFnZS4gSWYgdGhlIHJlcXVlc3QgZmFpbHMgb3IgdGhlIHJlc3BvbnNlIGlzIG5vdCBKU09OLFxuICAvLyB3ZSBzaWxlbnRseSBpZ25vcmUgaXQuIFdlIHByZWZpeCBwcm90b2NvbC1yZWxhdGl2ZSBVUkxzIHdpdGhcbiAgLy8gaHR0cHM6IHRvIGVuc3VyZSBhYnNvbHV0ZSBwYXRocy4gQW55IGltYWdlcyBmb3VuZCBoZXJlIGFyZSBhZGRlZFxuICAvLyB0byBpbWFnZVNldC4gVGhpcyBsb2dpYyBtaXJyb3JzIHRoZSB3b3JraW5nIGltcGxlbWVudGF0aW9uIGZyb21cbiAgLy8gdGhlIHByb3ZpZGVkIHJlZmVyZW5jZSBwYWNrYWdlLiBJdCBhdm9pZHMgc2xpY2luZyB0aGUgSlNPTiBieVxuICAvLyBicmFjZXMgYW5kIGluc3RlYWQgbGV0cyBKU09OLnBhcnNlIGhhbmRsZSB0aGUgc3RyaW5nLlxuICB0cnkge1xuICAgIGNvbnN0IGpzVXJsID0gdXJsLmVuZHNXaXRoKCcuanMnKSA/IHVybCA6IGAke3VybH0uanNgO1xuICAgIGNvbnN0IGpzUmVzcCA9IGF3YWl0IGF4aW9zLmdldChqc1VybCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnVXNlci1BZ2VudCc6XG4gICAgICAgICAgJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMTYuMCBTYWZhcmkvNTM3LjM2J1xuICAgICAgfSxcbiAgICAgIG1heFJlZGlyZWN0czogM1xuICAgIH0pO1xuICAgIGNvbnN0IGpzRGF0YSA9IGpzUmVzcC5kYXRhO1xuICAgIC8vIElmIHJlc3BvbnNlIGlzIGEgc3RyaW5nLCBhdHRlbXB0IHRvIHBhcnNlIEpTT047IGlmIGl0J3MgYWxyZWFkeVxuICAgIC8vIGFuIG9iamVjdCB3ZSBjYW4gcHJvY2VzcyBpdCBkaXJlY3RseS4gU29tZSBwbGF0Zm9ybXMgZXNjYXBlXG4gICAgLy8gdW5pY29kZSBzZXF1ZW5jZXMsIGJ1dCBKU09OLnBhcnNlIHdpbGwgaGFuZGxlIHRoZW0uXG4gICAgY29uc3QgcGFyc2VkRGF0YSA9XG4gICAgICB0eXBlb2YganNEYXRhID09PSAnc3RyaW5nJ1xuICAgICAgICA/IEpTT04ucGFyc2UoanNEYXRhKVxuICAgICAgICA6IHR5cGVvZiBqc0RhdGEgPT09ICdvYmplY3QnXG4gICAgICAgID8ganNEYXRhXG4gICAgICAgIDogbnVsbDtcbiAgICBpZiAocGFyc2VkRGF0YSAmJiB0eXBlb2YgcGFyc2VkRGF0YSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIC8vIEV4dHJhY3QgaW1hZ2VzIGFycmF5XG4gICAgICBjb25zdCBpbWdzOiB1bmtub3duID0gKHBhcnNlZERhdGEgYXMgYW55KS5pbWFnZXM7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShpbWdzKSkge1xuICAgICAgICBmb3IgKGNvbnN0IHAgb2YgaW1ncykge1xuICAgICAgICAgIGlmICh0eXBlb2YgcCA9PT0gJ3N0cmluZycgJiYgcCkge1xuICAgICAgICAgICAgY29uc3QgaW1nVXJsID0gcC5zdGFydHNXaXRoKCcvLycpID8gYGh0dHBzOiR7cH1gIDogcDtcbiAgICAgICAgICAgIGlmICgvXmh0dHBzPzpcXC9cXC8vaS50ZXN0KGltZ1VybCkpIHtcbiAgICAgICAgICAgICAgaW1hZ2VTZXQuYWRkKGltZ1VybCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBFeHRyYWN0IGZlYXR1cmVkIGltYWdlXG4gICAgICBjb25zdCBmZWF0OiB1bmtub3duID0gKHBhcnNlZERhdGEgYXMgYW55KS5mZWF0dXJlZF9pbWFnZTtcbiAgICAgIGlmICh0eXBlb2YgZmVhdCA9PT0gJ3N0cmluZycgJiYgZmVhdCkge1xuICAgICAgICBjb25zdCBmdWxsID0gZmVhdC5zdGFydHNXaXRoKCcvLycpID8gYGh0dHBzOiR7ZmVhdH1gIDogZmVhdDtcbiAgICAgICAgaWYgKC9eaHR0cHM/OlxcL1xcLy9pLnRlc3QoZnVsbCkpIHtcbiAgICAgICAgICBpbWFnZVNldC5hZGQoZnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIC8vIFNpbGVudGx5IGlnbm9yZSBlcnJvcnM7IHRoZSBKU09OIGVuZHBvaW50IG1heSBub3QgZXhpc3Qgb3IgbWF5IG5vdFxuICAgIC8vIHJldHVybiB2YWxpZCBKU09OLiBJbiBzdWNoIGNhc2VzIHdlIHNpbXBseSByZWx5IG9uIGltYWdlc1xuICAgIC8vIGV4dHJhY3RlZCBmcm9tIHRoZSBIVE1MIGFuZCBKU09OLUxELlxuICB9XG4gIC8vIEFzc2lnbiBpbWFnZXMgYXJyYXkgaWYgbW9yZSB0aGFuIG9uZSBpbWFnZSBpcyBmb3VuZFxuICBjb25zdCBpbWFnZXNBcnIgPSBBcnJheS5mcm9tKGltYWdlU2V0KTtcbiAgaWYgKGltYWdlc0Fyci5sZW5ndGggPiAwKSB7XG4gICAgLy8gQXNzaWduIHRoZSBpbWFnZXMgZGlyZWN0bHkgZnJvbSBpbWFnZVNldC4gVGhlIGltYWdlU2V0IGl0c2VsZlxuICAgIC8vIGFscmVhZHkgZGVkdXBsaWNhdGVzIGV4YWN0IFVSTHMgd2hpbGUgcHJlc2VydmluZyBpbnNlcnRpb24gb3JkZXIuXG4gICAgLy8gV2Ugbm8gbG9uZ2VyIGRlZHVwbGljYXRlIGJ5IGJhc2UgcGF0aCAocXVlcnkgcGFyYW1ldGVycykgYmVjYXVzZVxuICAgIC8vIHNvbWUgc3RvcmVzIHVzZSB0aGUgc2FtZSBiYXNlIGZvciBkaWZmZXJlbnQgaW1hZ2VzLiBJbnN0ZWFkIHdlXG4gICAgLy8gcHJlc2VydmUgYWxsIHVuaXF1ZSBVUkxzLiBXZSBzdGlsbCBtb3ZlIHRoZSBwcmltYXJ5IGltYWdlIHRvXG4gICAgLy8gdGhlIGZyb250IG9mIHRoZSBhcnJheSBpZiBpdCBleGlzdHMgYW5kIGlzIG5vdCBhbHJlYWR5IGZpcnN0LlxuICAgIGxldCBkZWR1cGVkOiBzdHJpbmdbXSA9IGltYWdlc0FycjtcbiAgICBpZiAocHJvZHVjdC5pbWFnZSkge1xuICAgICAgY29uc3QgaW5kZXggPSBkZWR1cGVkLmZpbmRJbmRleCgoaSkgPT4gaSA9PT0gcHJvZHVjdC5pbWFnZSk7XG4gICAgICBpZiAoaW5kZXggPiAwKSB7XG4gICAgICAgIGNvbnN0IFtpbWddID0gZGVkdXBlZC5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICBkZWR1cGVkLnVuc2hpZnQoaW1nKTtcbiAgICAgIH0gZWxzZSBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgIGRlZHVwZWQudW5zaGlmdChwcm9kdWN0LmltYWdlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcHJvZHVjdC5pbWFnZXMgPSBkZWR1cGVkO1xuICB9XG5cbiAgcmV0dXJuIHByb2R1Y3Q7XG59Il0sIm5hbWVzIjpbImF4aW9zIiwiY2hlZXJpbyIsInBhcnNlTGRKc29uIiwiJCIsInNjcmlwdHMiLCJ0b0FycmF5IiwiZWwiLCJjb250ZW50cyIsInRleHQiLCJqc29uIiwiSlNPTiIsInBhcnNlIiwidHJpbSIsImNhbmRpZGF0ZXMiLCJBcnJheSIsImlzQXJyYXkiLCJvYmoiLCJfIiwiZ2V0TWV0YSIsInByb3AiLCJhdHRyIiwicGFyc2VQcm9kdWN0IiwidXJsIiwiY2xlYW4iLCJ2YWx1ZSIsInRvU3RyaW5nIiwiaHRtbCIsInJlc3BvbnNlIiwiZ2V0IiwiaGVhZGVycyIsIm1heFJlZGlyZWN0cyIsImRhdGEiLCJlcnJvciIsImNvbnNvbGUiLCJFcnJvciIsIm1lc3NhZ2UiLCJwcmV0aXRsZSIsInRpdGxlIiwicHJpY2UiLCJkZXNjcmlwdGlvbiIsImltYWdlIiwiY29sb3JzIiwiY3RhIiwibG9hZCIsImxkIiwicHJvZHVjdCIsIm9yaWdpbmFsUHJpY2UiLCJ1bmRlZmluZWQiLCJpbWFnZXMiLCJjdGFMYWJlbCIsIm5hbWUiLCJmaXJzdCIsImxkSW1hZ2UiLCJsZE9mZmVycyIsIm9mZmVycyIsImxkUHJpY2UiLCJvcmlnaW5hbCIsImdldENvbXBhcmUiLCJjb21wYXJlQXRQcmljZSIsInByaWNlU3BlY2lmaWNhdGlvbiIsIm9mZiIsInZhbCIsInByaWNlUmVnZXgiLCJwYXJzZVByaWNlVGV4dCIsIm1hdGNoIiwiZXhlYyIsImVhY2giLCJpbmNsdWRlcyIsInBhcnRzIiwic3BsaXQiLCJsZW5ndGgiLCJzbGljZSIsImpvaW4iLCJjb2xvdXJzRm91bmQiLCJzdHlsZSIsImNvbG91ciIsInRlc3QiLCJwdXNoIiwiaW1hZ2VTZXQiLCJTZXQiLCJhZGQiLCJpbWciLCJzcmMiLCJjbGFzc2VzIiwicGFyZW50IiwiaWRzIiwiaGF5IiwianNVcmwiLCJlbmRzV2l0aCIsImpzUmVzcCIsImpzRGF0YSIsInBhcnNlZERhdGEiLCJpbWdzIiwicCIsImltZ1VybCIsInN0YXJ0c1dpdGgiLCJmZWF0IiwiZmVhdHVyZWRfaW1hZ2UiLCJmdWxsIiwiZXJyIiwiaW1hZ2VzQXJyIiwiZnJvbSIsImRlZHVwZWQiLCJpbmRleCIsImZpbmRJbmRleCIsImkiLCJzcGxpY2UiLCJ1bnNoaWZ0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/parser.ts\n");

/***/ }),

/***/ "(api)/./pages/api/generate.ts":
/*!*******************************!*\
  !*** ./pages/api/generate.ts ***!
  \*******************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_parser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/parser */ \"(api)/./lib/parser.ts\");\n/* harmony import */ var _data_templates__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../data/templates */ \"(api)/./data/templates.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_parser__WEBPACK_IMPORTED_MODULE_0__]);\n_lib_parser__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        res.setHeader(\"Allow\", [\n            \"POST\"\n        ]);\n        res.status(405).end(`Method ${req.method} Not Allowed`);\n        return;\n    }\n    let body;\n    try {\n        body = typeof req.body === \"string\" ? JSON.parse(req.body) : req.body;\n    } catch (error) {\n        res.status(400).json({\n            error: \"Invalid JSON body\"\n        });\n        return;\n    }\n    const urls = Array.isArray(body.urls) ? body.urls : [];\n    if (urls.length === 0) {\n        res.status(400).json({\n            error: \"No URLs provided\"\n        });\n        return;\n    }\n    const template = _data_templates__WEBPACK_IMPORTED_MODULE_1__.defaultTemplates.find((t)=>t.id === body.templateId) || _data_templates__WEBPACK_IMPORTED_MODULE_1__.defaultTemplates[0];\n    const products = [];\n    const htmlFragments = [];\n    for (const url of urls){\n        try {\n            const data = await (0,_lib_parser__WEBPACK_IMPORTED_MODULE_0__.parseProduct)(url);\n            // Skip URLs that return no meaningful product information to avoid\n            // rendering placeholder values like \"Product title\" or \"Price\".\n            // Only consider fields that represent real product information.\n            // Exclude generic fields like url or cta which are always present\n            // even when parsing fails.\n            const meaningfulKeys = [\n                \"pretitle\",\n                \"title\",\n                \"price\",\n                \"description\",\n                \"image\",\n                \"originalPrice\",\n                \"colors\",\n                \"images\"\n            ];\n            const hasInfo = meaningfulKeys.some((key)=>{\n                const value = data[key];\n                return Array.isArray(value) ? value.length > 0 : Boolean(value);\n            });\n            if (!hasInfo) {\n                console.warn(\"Skipping URL with no product data:\", url);\n                continue;\n            }\n            products.push(data);\n            const fragment = (0,_data_templates__WEBPACK_IMPORTED_MODULE_1__.renderTemplate)(template, data);\n            htmlFragments.push(fragment);\n        } catch (err) {\n            console.error(\"Error generating module for url\", url, err);\n        // If a URL fails outright, skip it and continue with the next one.\n        }\n    }\n    const html = htmlFragments.join(\"\\n\\n\");\n    res.status(200).json({\n        html,\n        products\n    });\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvZ2VuZXJhdGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQ2dEO0FBQ3dCO0FBZXpELGVBQWVHLFFBQzVCQyxHQUFtQixFQUNuQkMsR0FBb0I7SUFFcEIsSUFBSUQsSUFBSUUsTUFBTSxLQUFLLFFBQVE7UUFDekJELElBQUlFLFNBQVMsQ0FBQyxTQUFTO1lBQUM7U0FBTztRQUMvQkYsSUFBSUcsTUFBTSxDQUFDLEtBQUtDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sRUFBRUwsSUFBSUUsTUFBTSxDQUFDLFlBQVksQ0FBQztRQUN0RDtJQUNGO0lBRUEsSUFBSUk7SUFDSixJQUFJO1FBQ0ZBLE9BQU8sT0FBT04sSUFBSU0sSUFBSSxLQUFLLFdBQVdDLEtBQUtDLEtBQUssQ0FBQ1IsSUFBSU0sSUFBSSxJQUFJTixJQUFJTSxJQUFJO0lBQ3ZFLEVBQUUsT0FBT0csT0FBTztRQUNkUixJQUFJRyxNQUFNLENBQUMsS0FBS00sSUFBSSxDQUFDO1lBQUVELE9BQU87UUFBb0I7UUFDbEQ7SUFDRjtJQUVBLE1BQU1FLE9BQU9DLE1BQU1DLE9BQU8sQ0FBQ1AsS0FBS0ssSUFBSSxJQUFJTCxLQUFLSyxJQUFJLEdBQUcsRUFBRTtJQUN0RCxJQUFJQSxLQUFLRyxNQUFNLEtBQUssR0FBRztRQUNyQmIsSUFBSUcsTUFBTSxDQUFDLEtBQUtNLElBQUksQ0FBQztZQUFFRCxPQUFPO1FBQW1CO1FBQ2pEO0lBQ0Y7SUFDQSxNQUFNTSxXQUNKbEIsNkRBQWdCQSxDQUFDbUIsSUFBSSxDQUFDLENBQUNDLElBQU1BLEVBQUVDLEVBQUUsS0FBS1osS0FBS2EsVUFBVSxLQUFLdEIsNkRBQWdCLENBQUMsRUFBRTtJQUUvRSxNQUFNdUIsV0FBVyxFQUFFO0lBQ25CLE1BQU1DLGdCQUFnQixFQUFFO0lBQ3hCLEtBQUssTUFBTUMsT0FBT1gsS0FBTTtRQUN0QixJQUFJO1lBQ0YsTUFBTVksT0FBTyxNQUFNM0IseURBQVlBLENBQUMwQjtZQUNoQyxtRUFBbUU7WUFDbkUsZ0VBQWdFO1lBQ2hFLGdFQUFnRTtZQUNoRSxrRUFBa0U7WUFDbEUsMkJBQTJCO1lBQzNCLE1BQU1FLGlCQUFpQjtnQkFDckI7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7YUFDRDtZQUNELE1BQU1DLFVBQVVELGVBQWVFLElBQUksQ0FBQyxDQUFDQztnQkFDbkMsTUFBTUMsUUFBUSxJQUFhLENBQUNELElBQUk7Z0JBQ2hDLE9BQU9mLE1BQU1DLE9BQU8sQ0FBQ2UsU0FBU0EsTUFBTWQsTUFBTSxHQUFHLElBQUllLFFBQVFEO1lBQzNEO1lBRUEsSUFBSSxDQUFDSCxTQUFTO2dCQUNaSyxRQUFRQyxJQUFJLENBQUMsc0NBQXNDVDtnQkFDbkQ7WUFDRjtZQUNBRixTQUFTWSxJQUFJLENBQUNUO1lBQ2QsTUFBTVUsV0FBV25DLCtEQUFjQSxDQUFDaUIsVUFBVVE7WUFDMUNGLGNBQWNXLElBQUksQ0FBQ0M7UUFDckIsRUFBRSxPQUFPQyxLQUFLO1lBQ1pKLFFBQVFyQixLQUFLLENBQUMsbUNBQW1DYSxLQUFLWTtRQUN0RCxtRUFBbUU7UUFDckU7SUFDRjtJQUNBLE1BQU1DLE9BQU9kLGNBQWNlLElBQUksQ0FBQztJQUNoQ25DLElBQUlHLE1BQU0sQ0FBQyxLQUFLTSxJQUFJLENBQUM7UUFBRXlCO1FBQU1mO0lBQVM7QUFDeEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9lZG0tYnVpbGRlci8uL3BhZ2VzL2FwaS9nZW5lcmF0ZS50cz8yNjVlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IHsgcGFyc2VQcm9kdWN0IH0gZnJvbSAnLi4vLi4vbGliL3BhcnNlcic7XG5pbXBvcnQgeyBkZWZhdWx0VGVtcGxhdGVzLCByZW5kZXJUZW1wbGF0ZSB9IGZyb20gJy4uLy4uL2RhdGEvdGVtcGxhdGVzJztcblxuaW50ZXJmYWNlIEdlbmVyYXRlUmVxdWVzdEJvZHkge1xuICAvKipcbiAgICogTGlzdCBvZiBwcm9kdWN0IHBhZ2UgVVJMcyBzdXBwbGllZCBieSB0aGUgY2xpZW50LiBFYWNoIFVSTFxuICAgKiBzaG91bGQgYmUgYSBmdWxseSBxdWFsaWZpZWQgYWJzb2x1dGUgVVJMLlxuICAgKi9cbiAgdXJsczogc3RyaW5nW107XG4gIC8qKlxuICAgKiBPcHRpb25hbCBpZCBvZiB0aGUgdGVtcGxhdGUgdG8gdXNlLiBJZiBub3QgcHJvdmlkZWQgb3Igbm90XG4gICAqIHJlY29nbmlzZWQgdGhlIGZpcnN0IHRlbXBsYXRlIGluIGRlZmF1bHRUZW1wbGF0ZXMgd2lsbCBiZSB1c2VkLlxuICAgKi9cbiAgdGVtcGxhdGVJZD86IHN0cmluZztcbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihcbiAgcmVxOiBOZXh0QXBpUmVxdWVzdCxcbiAgcmVzOiBOZXh0QXBpUmVzcG9uc2Vcbik6IFByb21pc2U8dm9pZD4ge1xuICBpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XG4gICAgcmVzLnNldEhlYWRlcignQWxsb3cnLCBbJ1BPU1QnXSk7XG4gICAgcmVzLnN0YXR1cyg0MDUpLmVuZChgTWV0aG9kICR7cmVxLm1ldGhvZH0gTm90IEFsbG93ZWRgKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgYm9keTogR2VuZXJhdGVSZXF1ZXN0Qm9keTtcbiAgdHJ5IHtcbiAgICBib2R5ID0gdHlwZW9mIHJlcS5ib2R5ID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UocmVxLmJvZHkpIDogcmVxLmJvZHk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgSlNPTiBib2R5JyB9KTtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCB1cmxzID0gQXJyYXkuaXNBcnJheShib2R5LnVybHMpID8gYm9keS51cmxzIDogW107XG4gIGlmICh1cmxzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdObyBVUkxzIHByb3ZpZGVkJyB9KTtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgdGVtcGxhdGUgPVxuICAgIGRlZmF1bHRUZW1wbGF0ZXMuZmluZCgodCkgPT4gdC5pZCA9PT0gYm9keS50ZW1wbGF0ZUlkKSB8fCBkZWZhdWx0VGVtcGxhdGVzWzBdO1xuXG4gIGNvbnN0IHByb2R1Y3RzID0gW10gYXMgYW55W107XG4gIGNvbnN0IGh0bWxGcmFnbWVudHMgPSBbXSBhcyBzdHJpbmdbXTtcbiAgZm9yIChjb25zdCB1cmwgb2YgdXJscykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcGFyc2VQcm9kdWN0KHVybCk7XG4gICAgICAvLyBTa2lwIFVSTHMgdGhhdCByZXR1cm4gbm8gbWVhbmluZ2Z1bCBwcm9kdWN0IGluZm9ybWF0aW9uIHRvIGF2b2lkXG4gICAgICAvLyByZW5kZXJpbmcgcGxhY2Vob2xkZXIgdmFsdWVzIGxpa2UgXCJQcm9kdWN0IHRpdGxlXCIgb3IgXCJQcmljZVwiLlxuICAgICAgLy8gT25seSBjb25zaWRlciBmaWVsZHMgdGhhdCByZXByZXNlbnQgcmVhbCBwcm9kdWN0IGluZm9ybWF0aW9uLlxuICAgICAgLy8gRXhjbHVkZSBnZW5lcmljIGZpZWxkcyBsaWtlIHVybCBvciBjdGEgd2hpY2ggYXJlIGFsd2F5cyBwcmVzZW50XG4gICAgICAvLyBldmVuIHdoZW4gcGFyc2luZyBmYWlscy5cbiAgICAgIGNvbnN0IG1lYW5pbmdmdWxLZXlzID0gW1xuICAgICAgICAncHJldGl0bGUnLFxuICAgICAgICAndGl0bGUnLFxuICAgICAgICAncHJpY2UnLFxuICAgICAgICAnZGVzY3JpcHRpb24nLFxuICAgICAgICAnaW1hZ2UnLFxuICAgICAgICAnb3JpZ2luYWxQcmljZScsXG4gICAgICAgICdjb2xvcnMnLFxuICAgICAgICAnaW1hZ2VzJ1xuICAgICAgXTtcbiAgICAgIGNvbnN0IGhhc0luZm8gPSBtZWFuaW5nZnVsS2V5cy5zb21lKChrZXkpID0+IHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSAoZGF0YSBhcyBhbnkpW2tleV07XG4gICAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlLmxlbmd0aCA+IDAgOiBCb29sZWFuKHZhbHVlKTtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIWhhc0luZm8pIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdTa2lwcGluZyBVUkwgd2l0aCBubyBwcm9kdWN0IGRhdGE6JywgdXJsKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBwcm9kdWN0cy5wdXNoKGRhdGEpO1xuICAgICAgY29uc3QgZnJhZ21lbnQgPSByZW5kZXJUZW1wbGF0ZSh0ZW1wbGF0ZSwgZGF0YSk7XG4gICAgICBodG1sRnJhZ21lbnRzLnB1c2goZnJhZ21lbnQpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2VuZXJhdGluZyBtb2R1bGUgZm9yIHVybCcsIHVybCwgZXJyKTtcbiAgICAgIC8vIElmIGEgVVJMIGZhaWxzIG91dHJpZ2h0LCBza2lwIGl0IGFuZCBjb250aW51ZSB3aXRoIHRoZSBuZXh0IG9uZS5cbiAgICB9XG4gIH1cbiAgY29uc3QgaHRtbCA9IGh0bWxGcmFnbWVudHMuam9pbignXFxuXFxuJyk7XG4gIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgaHRtbCwgcHJvZHVjdHMgfSk7XG59Il0sIm5hbWVzIjpbInBhcnNlUHJvZHVjdCIsImRlZmF1bHRUZW1wbGF0ZXMiLCJyZW5kZXJUZW1wbGF0ZSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzZXRIZWFkZXIiLCJzdGF0dXMiLCJlbmQiLCJib2R5IiwiSlNPTiIsInBhcnNlIiwiZXJyb3IiLCJqc29uIiwidXJscyIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsInRlbXBsYXRlIiwiZmluZCIsInQiLCJpZCIsInRlbXBsYXRlSWQiLCJwcm9kdWN0cyIsImh0bWxGcmFnbWVudHMiLCJ1cmwiLCJkYXRhIiwibWVhbmluZ2Z1bEtleXMiLCJoYXNJbmZvIiwic29tZSIsImtleSIsInZhbHVlIiwiQm9vbGVhbiIsImNvbnNvbGUiLCJ3YXJuIiwicHVzaCIsImZyYWdtZW50IiwiZXJyIiwiaHRtbCIsImpvaW4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/generate.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fgenerate.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();